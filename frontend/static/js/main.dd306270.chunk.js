(this["webpackJsonp@ping-board/frontend"]=this["webpackJsonp@ping-board/frontend"]||[]).push([[0],{108:function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(109),t),r(n(110),t),r(n(111),t),r(n(112),t),r(n(113),t),r(n(114),t),r(n(115),t)},109:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},110:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},111:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},112:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},113:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isScheduledPing=void 0,t.isScheduledPing=function(e){return"string"===typeof e.scheduledFor&&"string"===typeof e.scheduledTitle}},114:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},115:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},116:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},117:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserRoles=void 0,function(e){e.EVENTS_READ="events.read",e.EVENTS_ADD="events.add",e.EVENTS_EDIT="events.edit",e.PING="ping",e.PING_TEMPLATES_WRITE="ping.templates.write"}(t.UserRoles||(t.UserRoles={}))},123:function(e,t,n){},124:function(e,t,n){},125:function(e,t,n){},126:function(e,t,n){},127:function(e,t,n){},128:function(e,t,n){},129:function(e,t,n){},130:function(e,t,n){},131:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},136:function(e,t,n){},137:function(e,t,n){},138:function(e,t,n){},140:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(23),c=n.n(i),l=n(37),s=n(10),o=n(5),u=n(89),d=n(4),j=n(81),b=["neucoreGroup"],h=Object(j.createApi)({reducerPath:"loginApi",baseQuery:Object(j.fetchBaseQuery)({baseUrl:"/",credentials:"same-origin"}),tagTypes:["User","Event","Ping","PingTemplate","PingChannel","NeucoreGroup","PingViewPermission"],endpoints:function(e){return{getUser:e.query({query:function(){return"api/me"},providesTags:["User"]}),logOut:e.mutation({query:function(){return{url:"auth/logout",method:"POST"}},invalidatesTags:["User","Event"]}),getEvents:e.query({query:function(e){return{url:"api/events",params:e}},providesTags:function(e){return e&&e.events.length>0?e.events.map((function(e){return{type:"Event",id:e.id}})):["Event"]}}),addEvent:e.mutation({query:function(e){return{url:"api/events",method:"POST",body:e}},invalidatesTags:["Event"]}),updateEvent:e.mutation({query:function(e){var t=e.id,n=e.event;return{url:"api/events/".concat(t),method:"PUT",body:n}},invalidatesTags:["Event"]}),deleteEvent:e.mutation({query:function(e){return{url:"api/events/".concat(e),method:"DELETE"}},invalidatesTags:function(e,t,n){return e?[{type:"Event",id:n}]:["Event"]}}),getSolarSystems:e.query({query:function(){return"api/events/solarSystems"}}),getPings:e.query({query:function(e){return{url:"api/pings",params:e||void 0}},providesTags:function(e){return e&&e.pings.length>0?e.pings.map((function(e){return{type:"Ping",id:e.id}})):["Ping"]}}),addPing:e.mutation({query:function(e){return{url:"api/pings",method:"POST",body:e}},invalidatesTags:function(e){return e?[{type:"Ping",id:e.id}]:["Ping"]}}),getPingChannels:e.query({query:function(){return{url:"api/pings/channels"}},providesTags:function(e){return e&&e.channels.length>0?e.channels.map((function(e){return{type:"PingChannel",id:e.id}})):["PingChannel"]}}),getAvailableNeucoreGroups:e.query({query:function(){return{url:"api/pings/neucore-groups"}},providesTags:function(e){return e&&e.neucoreGroups.length>0?e.neucoreGroups.map((function(e){return{type:"NeucoreGroup",id:e.id}})):["NeucoreGroup"]}}),getPingTemplates:e.query({query:function(){return{url:"api/pings/templates"}},providesTags:function(e){return e&&e.templates.length>0?e.templates.map((function(e){return{type:"PingTemplate",id:e.id}})):["PingTemplate"]}}),addPingTemplate:e.mutation({query:function(e){return{url:"api/pings/templates",method:"POST",body:e}},invalidatesTags:["PingTemplate"]}),updatePingTemplate:e.mutation({query:function(e){var t=e.id,n=e.template;return{url:"api/pings/templates/".concat(t),method:"PUT",body:n}},invalidatesTags:function(e){return e?[{type:"PingTemplate",id:e.id}]:["PingTemplate"]}}),deletePingTemplate:e.mutation({query:function(e){return{url:"api/pings/templates/".concat(e),method:"DELETE"}},invalidatesTags:function(e,t,n){return e?[{type:"PingTemplate",id:n}]:["PingTemplate"]}}),getPingViewPermissions:e.query({query:function(){return{url:"api/pings/view-permissions"}},providesTags:["PingViewPermission"]}),updatePingViewPermissionsByNeucoreGroup:e.mutation({query:function(e){var t=e.neucoreGroup,n=Object(d.a)(e,b);return{url:"api/pings/view-permissions/groups/".concat(t),method:"PUT",body:n}},invalidatesTags:["PingViewPermission","Ping"]})}}}),m=h.useGetUserQuery,O=h.useLogOutMutation,f=(h.useGetEventsQuery,h.useAddEventMutation),p=h.useUpdateEventMutation,v=h.useDeleteEventMutation,x=h.useGetSolarSystemsQuery,g=(h.useGetPingsQuery,h.useAddPingMutation),y=h.useGetPingChannelsQuery,w=h.useGetAvailableNeucoreGroupsQuery,N=h.useGetPingTemplatesQuery,C=h.useAddPingTemplateMutation,S=h.useUpdatePingTemplateMutation,T=h.useDeletePingTemplateMutation,k=h.useGetPingViewPermissionsQuery,E=h.useUpdatePingViewPermissionsByNeucoreGroupMutation,P=n(21),M=n.n(P),L=n(8),A=n(3),I=n(38),G=n(17),R=n(45),D=n(12),F=n.n(D),B=n(83),U=n.n(B),Y=n(84),q=n.n(Y),V=n(85),z=n.n(V),H=n(86),J=n.n(H),Q=n(87),_=n.n(Q),K=n(88),W=n.n(K);F.a.extend(U.a),F.a.extend(q.a),F.a.extend(z.a),F.a.extend(J.a),F.a.extend(_.a),F.a.extend(W.a);var X={af:function(){return n.e(3).then(n.t.bind(null,163,7))},am:function(){return n.e(4).then(n.t.bind(null,164,7))},"ar-dz":function(){return n.e(5).then(n.t.bind(null,165,7))},"ar-kw":function(){return n.e(6).then(n.t.bind(null,166,7))},"ar-ly":function(){return n.e(7).then(n.t.bind(null,167,7))},"ar-ma":function(){return n.e(8).then(n.t.bind(null,168,7))},"ar-sa":function(){return n.e(9).then(n.t.bind(null,169,7))},"ar-tn":function(){return n.e(10).then(n.t.bind(null,170,7))},ar:function(){return n.e(11).then(n.t.bind(null,171,7))},az:function(){return n.e(12).then(n.t.bind(null,172,7))},be:function(){return n.e(13).then(n.t.bind(null,173,7))},bg:function(){return n.e(14).then(n.t.bind(null,174,7))},bi:function(){return n.e(15).then(n.t.bind(null,175,7))},bm:function(){return n.e(16).then(n.t.bind(null,176,7))},bn:function(){return n.e(17).then(n.t.bind(null,177,7))},bo:function(){return n.e(18).then(n.t.bind(null,178,7))},br:function(){return n.e(19).then(n.t.bind(null,179,7))},bs:function(){return n.e(20).then(n.t.bind(null,180,7))},ca:function(){return n.e(21).then(n.t.bind(null,181,7))},cs:function(){return n.e(22).then(n.t.bind(null,182,7))},cv:function(){return n.e(23).then(n.t.bind(null,183,7))},cy:function(){return n.e(24).then(n.t.bind(null,184,7))},da:function(){return n.e(25).then(n.t.bind(null,185,7))},"de-at":function(){return n.e(26).then(n.t.bind(null,186,7))},"de-ch":function(){return n.e(27).then(n.t.bind(null,187,7))},de:function(){return n.e(28).then(n.t.bind(null,188,7))},dv:function(){return n.e(29).then(n.t.bind(null,189,7))},el:function(){return n.e(30).then(n.t.bind(null,190,7))},"en-au":function(){return n.e(31).then(n.t.bind(null,191,7))},"en-ca":function(){return n.e(32).then(n.t.bind(null,192,7))},"en-gb":function(){return n.e(33).then(n.t.bind(null,193,7))},"en-ie":function(){return n.e(34).then(n.t.bind(null,194,7))},"en-il":function(){return n.e(35).then(n.t.bind(null,195,7))},"en-in":function(){return n.e(36).then(n.t.bind(null,196,7))},"en-nz":function(){return n.e(37).then(n.t.bind(null,197,7))},"en-sg":function(){return n.e(38).then(n.t.bind(null,198,7))},"en-tt":function(){return n.e(39).then(n.t.bind(null,199,7))},en:function(){return n.e(40).then(n.t.bind(null,200,7))},eo:function(){return n.e(41).then(n.t.bind(null,201,7))},"es-do":function(){return n.e(42).then(n.t.bind(null,202,7))},"es-pr":function(){return n.e(43).then(n.t.bind(null,203,7))},"es-us":function(){return n.e(44).then(n.t.bind(null,204,7))},es:function(){return n.e(45).then(n.t.bind(null,205,7))},et:function(){return n.e(46).then(n.t.bind(null,206,7))},eu:function(){return n.e(47).then(n.t.bind(null,207,7))},fa:function(){return n.e(48).then(n.t.bind(null,208,7))},fi:function(){return n.e(49).then(n.t.bind(null,209,7))},fo:function(){return n.e(50).then(n.t.bind(null,210,7))},"fr-ca":function(){return n.e(51).then(n.t.bind(null,211,7))},"fr-ch":function(){return n.e(52).then(n.t.bind(null,212,7))},fr:function(){return n.e(53).then(n.t.bind(null,213,7))},fy:function(){return n.e(54).then(n.t.bind(null,214,7))},ga:function(){return n.e(55).then(n.t.bind(null,215,7))},gd:function(){return n.e(56).then(n.t.bind(null,216,7))},gl:function(){return n.e(57).then(n.t.bind(null,217,7))},"gom-latn":function(){return n.e(58).then(n.t.bind(null,218,7))},gu:function(){return n.e(59).then(n.t.bind(null,219,7))},he:function(){return n.e(60).then(n.t.bind(null,220,7))},hi:function(){return n.e(61).then(n.t.bind(null,221,7))},hr:function(){return n.e(62).then(n.t.bind(null,222,7))},ht:function(){return n.e(63).then(n.t.bind(null,223,7))},hu:function(){return n.e(64).then(n.t.bind(null,224,7))},"hy-am":function(){return n.e(65).then(n.t.bind(null,225,7))},id:function(){return n.e(66).then(n.t.bind(null,226,7))},is:function(){return n.e(67).then(n.t.bind(null,227,7))},"it-ch":function(){return n.e(68).then(n.t.bind(null,228,7))},it:function(){return n.e(69).then(n.t.bind(null,229,7))},ja:function(){return n.e(70).then(n.t.bind(null,230,7))},jv:function(){return n.e(71).then(n.t.bind(null,231,7))},ka:function(){return n.e(72).then(n.t.bind(null,232,7))},kk:function(){return n.e(73).then(n.t.bind(null,233,7))},km:function(){return n.e(74).then(n.t.bind(null,234,7))},kn:function(){return n.e(75).then(n.t.bind(null,235,7))},ko:function(){return n.e(76).then(n.t.bind(null,236,7))},ku:function(){return n.e(77).then(n.t.bind(null,237,7))},ky:function(){return n.e(78).then(n.t.bind(null,238,7))},lb:function(){return n.e(79).then(n.t.bind(null,239,7))},lo:function(){return n.e(80).then(n.t.bind(null,240,7))},lt:function(){return n.e(81).then(n.t.bind(null,241,7))},lv:function(){return n.e(82).then(n.t.bind(null,242,7))},me:function(){return n.e(83).then(n.t.bind(null,243,7))},mi:function(){return n.e(84).then(n.t.bind(null,244,7))},mk:function(){return n.e(85).then(n.t.bind(null,245,7))},ml:function(){return n.e(86).then(n.t.bind(null,246,7))},mn:function(){return n.e(87).then(n.t.bind(null,247,7))},mr:function(){return n.e(88).then(n.t.bind(null,248,7))},"ms-my":function(){return n.e(89).then(n.t.bind(null,249,7))},ms:function(){return n.e(90).then(n.t.bind(null,250,7))},mt:function(){return n.e(91).then(n.t.bind(null,251,7))},my:function(){return n.e(92).then(n.t.bind(null,252,7))},nb:function(){return n.e(93).then(n.t.bind(null,253,7))},ne:function(){return n.e(94).then(n.t.bind(null,254,7))},"nl-be":function(){return n.e(95).then(n.t.bind(null,255,7))},nl:function(){return n.e(96).then(n.t.bind(null,256,7))},nn:function(){return n.e(97).then(n.t.bind(null,257,7))},"oc-lnc":function(){return n.e(98).then(n.t.bind(null,258,7))},"pa-in":function(){return n.e(99).then(n.t.bind(null,259,7))},pl:function(){return n.e(100).then(n.t.bind(null,260,7))},"pt-br":function(){return n.e(101).then(n.t.bind(null,261,7))},pt:function(){return n.e(102).then(n.t.bind(null,262,7))},ro:function(){return n.e(103).then(n.t.bind(null,263,7))},ru:function(){return n.e(104).then(n.t.bind(null,264,7))},rw:function(){return n.e(105).then(n.t.bind(null,265,7))},sd:function(){return n.e(106).then(n.t.bind(null,266,7))},se:function(){return n.e(107).then(n.t.bind(null,267,7))},si:function(){return n.e(108).then(n.t.bind(null,268,7))},sk:function(){return n.e(109).then(n.t.bind(null,269,7))},sl:function(){return n.e(110).then(n.t.bind(null,270,7))},sq:function(){return n.e(111).then(n.t.bind(null,271,7))},"sr-cyrl":function(){return n.e(112).then(n.t.bind(null,272,7))},sr:function(){return n.e(113).then(n.t.bind(null,273,7))},ss:function(){return n.e(114).then(n.t.bind(null,274,7))},"sv-fi":function(){return n.e(115).then(n.t.bind(null,275,7))},sv:function(){return n.e(116).then(n.t.bind(null,276,7))},sw:function(){return n.e(117).then(n.t.bind(null,277,7))},ta:function(){return n.e(118).then(n.t.bind(null,278,7))},te:function(){return n.e(119).then(n.t.bind(null,279,7))},tet:function(){return n.e(120).then(n.t.bind(null,280,7))},tg:function(){return n.e(121).then(n.t.bind(null,281,7))},th:function(){return n.e(122).then(n.t.bind(null,282,7))},tk:function(){return n.e(123).then(n.t.bind(null,283,7))},"tl-ph":function(){return n.e(124).then(n.t.bind(null,284,7))},tlh:function(){return n.e(125).then(n.t.bind(null,285,7))},tr:function(){return n.e(126).then(n.t.bind(null,286,7))},tzl:function(){return n.e(127).then(n.t.bind(null,287,7))},"tzm-latn":function(){return n.e(128).then(n.t.bind(null,288,7))},tzm:function(){return n.e(129).then(n.t.bind(null,289,7))},"ug-cn":function(){return n.e(130).then(n.t.bind(null,290,7))},uk:function(){return n.e(131).then(n.t.bind(null,291,7))},ur:function(){return n.e(132).then(n.t.bind(null,292,7))},"uz-latn":function(){return n.e(133).then(n.t.bind(null,293,7))},uz:function(){return n.e(134).then(n.t.bind(null,294,7))},vi:function(){return n.e(135).then(n.t.bind(null,295,7))},"x-pseudo":function(){return n.e(136).then(n.t.bind(null,296,7))},yo:function(){return n.e(137).then(n.t.bind(null,297,7))},"zh-cn":function(){return n.e(138).then(n.t.bind(null,298,7))},"zh-hk":function(){return n.e(139).then(n.t.bind(null,299,7))},"zh-tw":function(){return n.e(140).then(n.t.bind(null,300,7))},zh:function(){return n.e(141).then(n.t.bind(null,301,7))}},Z=new Set;function $(){return($=Object(I.a)(M.a.mark((function e(){var t,n,a,r,i;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,a=Object(R.a)(null!==(t=navigator.languages)&&void 0!==t?t:[]),e.prev=2,i=M.a.mark((function e(){var t,a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.value,a=t.toLowerCase(),console.log("checking locale",a),!(a in X)){e.next=16;break}return e.prev=4,e.next=7,X[a]();case 7:return F.a.locale(a),console.log("loaded dayjs locale",a),n=!0,Z.forEach((function(e){return e(a)})),e.abrupt("return","break");case 14:e.prev=14,e.t0=e.catch(4);case 16:case"end":return e.stop()}}),e,null,[[4,14]])})),a.s();case 5:if((r=a.n()).done){e.next=12;break}return e.delegateYield(i(),"t0",7);case 7:if("break"!==e.t0){e.next=10;break}return e.abrupt("break",12);case 10:e.next=5;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(2),a.e(e.t1);case 17:return e.prev=17,a.f(),e.finish(17);case 20:n||console.warn("failed to load dayjs locale, falling back to en");case 21:case"end":return e.stop()}}),e,null,[[2,14,17,20]])})))).apply(this,arguments)}(function(){return $.apply(this,arguments)})().then();var ee={loadingMonths:[],loadedMonths:[],events:[]},te=function(e){return F.a.utc("".concat(e.year,"-").concat(e.month+1,"-01"))},ne=function(e){return te(e).format("YYYY-MM")};function ae(e){var t,n=te(e),a=((n.day()-F.a.localeData().firstDayOfWeek())%(t=7)+t)%t,r=n.subtract(F.a.duration({days:a})),i=Math.ceil((r.daysInMonth()+a)/7),c=r.add(F.a.duration({weeks:i}));return{from:r,to:c,displayedWeeks:i}}var re=Object(o.createAsyncThunk)("calendar/loadMonth",function(){var e=Object(I.a)(M.a.mark((function e(t){var n,a,r,i,c,l,s,o,u;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=function(){return(c=Object(I.a)(M.a.mark((function e(t,n,i){var c,l,s,o,u,d,j;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=[],l=!0;case 2:if(!l){e.next=19;break}return o=new URLSearchParams({after:null!==(s=n(c))&&void 0!==s?s:a.toISOString(),before:r.toISOString()}),e.next=6,fetch("".concat(t,"?").concat(o.toString()),{credentials:"same-origin"});case 6:if(401!==(u=e.sent).status){e.next=11;break}l=!1,e.next=17;break;case 11:return e.next=13,u.json();case 13:d=e.sent,j=i(d),c=[].concat(Object(L.a)(c),Object(L.a)(j.values)),l=j.hasMore;case 17:e.next=2;break;case 19:return e.abrupt("return",c);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)},i=function(e,t,n){return c.apply(this,arguments)},n=ae(t),a=n.from,r=n.to,e.next=5,Promise.all([i("/api/events",(function(e){return e.length>0?e[e.length-1].time:null}),(function(e){return{values:e.events,hasMore:e.remaining>0}})),i("/api/pings/scheduled",(function(e){return e.length>0?e[e.length-1].scheduledFor:null}),(function(e){return{values:e.pings,hasMore:e.remaining>0}}))]);case 5:return l=e.sent,s=Object(A.a)(l,2),o=s[0],u=s[1],e.abrupt("return",{cached:!1,events:o,pings:u});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{condition:function(e,t){var n=t.getState,a=ne(e),r=n().calendar,i=r.loadingMonths,c=r.loadedMonths;return!i.includes(a)&&!c.includes(a)}}),ie=Object(o.createSlice)({name:"calendar",initialState:ee,reducers:{clearCalendarEntries:function(e){e.events=[],e.loadedMonths=[]}},extraReducers:function(e){return e.addCase(re.pending,(function(e,t){e.loadingMonths.push(ne(t.meta.arg))})).addCase(re.rejected,(function(e,t){var n=ne(t.meta.arg);e.loadingMonths=e.loadingMonths.filter((function(e){return e!==n}))})).addCase(re.fulfilled,(function(e,t){var n=ne(t.meta.arg);if(e.loadingMonths=e.loadingMonths.filter((function(e){return e!==n})),t.payload){var a=new Map([].concat(Object(L.a)(e.events.map((function(e){return"event"===e.baseEntry.type?["event-".concat(e.baseEntry.event.id),e]:["ping-".concat(e.baseEntry.ping.id),e]}))),Object(L.a)(t.payload.events.map((function(e){return["event-".concat(e.id),ce(e)]}))),Object(L.a)(t.payload.pings.map((function(e){return["ping-".concat(e.id),le(e)]})))));e.events=Object(L.a)(a.values())}})).addMatcher(h.endpoints.logOut.matchFulfilled,(function(){return ee})).addMatcher(h.endpoints.addEvent.matchFulfilled,(function(e,t){e.events=[].concat(Object(L.a)(e.events),[ce(t.payload)])})).addMatcher(h.endpoints.updateEvent.matchFulfilled,(function(e,t){var n=t.payload;e.events=e.events.map((function(e){return"event"===e.baseEntry.type&&e.baseEntry.event.id===n.id?ce(n):e}))})).addMatcher(h.endpoints.deleteEvent.matchFulfilled,(function(e,t){var n=t.meta.arg.originalArgs;e.events=e.events.filter((function(e){return"event"!==e.baseEntry.type||e.baseEntry.event.id!==n}))})).addMatcher(h.endpoints.addPing.matchFulfilled,(function(e,t){Object(G.isScheduledPing)(t.payload)&&(e.events=[].concat(Object(L.a)(e.events),[le(t.payload)]))}))}});function ce(e){var t;switch(e.priority.toLowerCase()){case"low":t="gray";break;case"medium":t="yellow";break;case"high":t="orange";break;case"critical":t="red"}var n=[e.standing.charAt(0).toUpperCase(),e.standing.substr(1)," ","other"===e.structure.toLowerCase()?"":e.structure+" ","other"===e.type.toLowerCase()?"":e.type.toLowerCase()+" ","timer in ",e.system].join("");return{dateTime:e.time,title:n,color:t,baseEntry:{type:"event",event:e}}}function le(e){return{dateTime:e.scheduledFor,title:e.scheduledTitle,baseEntry:{type:"ping",ping:e}}}var se=function(e){return e.calendar.events},oe=ie.actions.clearCalendarEntries,ue=n(2),de={loading:!1,events:[],hasMoreEvents:!0},je=Object(o.createAsyncThunk)("eventsList/reloadEvents",(function(e,t){var n=t.dispatch;n(xe()),n(be())})),be=Object(o.createAsyncThunk)("eventsList/loadMore",function(){var e=Object(I.a)(M.a.mark((function e(t,n){var a,r,i,c;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getState,r=Oe(a()),i=new URLSearchParams(Object(ue.a)(Object(ue.a)({},r.length>0?{before:r[r.length-1].time}:{}),{},{count:"40"})),c=fetch("/api/events?".concat(i.toString()),{credentials:"same-origin"}),e.next=6,c.then((function(e){return e.json()}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),{condition:function(e,t){return!(0,t.getState)().eventsList.loading}});function he(e){return Object(L.a)(e).sort((function(e,t){return Date.parse(t.time)-Date.parse(e.time)}))}var me=Object(o.createSlice)({name:"eventsList",initialState:de,reducers:{clearEvents:function(e){e.loading=!1,e.events=[],e.hasMoreEvents=!0},eventsReceived:function(e,t){e.loading=!1,e.events=[].concat(Object(L.a)(e.events),Object(L.a)(t.payload.events)),e.hasMoreEvents=t.payload.remaining>0}},extraReducers:function(e){return e.addCase(be.pending,(function(e){e.loading=!0})).addCase(be.fulfilled,(function(e,t){e.loading=!1,e.events=he([].concat(Object(L.a)(e.events),Object(L.a)(t.payload.events))),e.hasMoreEvents=t.payload.remaining>0})).addCase(be.rejected,(function(e){e.loading=!1})).addMatcher(h.endpoints.logOut.matchFulfilled,(function(){return de})).addMatcher(h.endpoints.addEvent.matchFulfilled,(function(e,t){e.events=he([].concat(Object(L.a)(e.events),[t.payload]))})).addMatcher(h.endpoints.updateEvent.matchFulfilled,(function(e,t){var n=t.payload;e.events=he(e.events.map((function(e){return e.id===n.id?n:e})))})).addMatcher(h.endpoints.deleteEvent.matchFulfilled,(function(e,t){var n=t.meta.arg.originalArgs;e.events=e.events.filter((function(e){return e.id!==n}))}))}}),Oe=function(e){return e.eventsList.events},fe=function(e){return e.eventsList.hasMoreEvents},pe=function(e){return e.eventsList.loading},ve=me.actions,xe=ve.clearEvents,ge=(ve.eventsReceived,{loading:!1,pings:[],hasMore:!0}),ye=Object(o.createAsyncThunk)("pingsList/reloadPings",(function(e,t){var n=t.dispatch;n(Me()),n(we())})),we=Object(o.createAsyncThunk)("pingsList/loadMore",function(){var e=Object(I.a)(M.a.mark((function e(t,n){var a,r,i,c;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getState,r=Te(a()),i=new URLSearchParams(r.length>0?{before:r[r.length-1].sentAt}:{}),c=fetch("/api/pings?".concat(i.toString()),{credentials:"same-origin"}),e.next=6,c.then((function(e){return e.json()}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),{condition:function(e,t){return!(0,t.getState)().pingsList.loading}});function Ne(e){return Object(L.a)(e).sort((function(e,t){return Date.parse(t.sentAt)-Date.parse(e.sentAt)}))}var Ce,Se=Object(o.createSlice)({name:"pingsList",initialState:ge,reducers:{clearPings:function(e){e.loading=!1,e.pings=[],e.hasMore=!0},pingsReceived:function(e,t){e.loading=!1,e.pings=[].concat(Object(L.a)(e.pings),Object(L.a)(t.payload.pings)),e.hasMore=t.payload.remaining>0}},extraReducers:function(e){return e.addCase(we.pending,(function(e){e.loading=!0})).addCase(we.fulfilled,(function(e,t){e.loading=!1,e.pings=Ne([].concat(Object(L.a)(e.pings),Object(L.a)(t.payload.pings))),e.hasMore=t.payload.remaining>0})).addCase(we.rejected,(function(e){e.loading=!1})).addMatcher(h.endpoints.logOut.matchFulfilled,(function(){return ge})).addMatcher(h.endpoints.addPing.matchFulfilled,(function(e,t){e.pings=Ne([].concat(Object(L.a)(e.pings),[t.payload]))}))}}),Te=function(e){return e.pingsList.pings},ke=function(e){return e.pingsList.hasMore},Ee=function(e){return e.pingsList.loading},Pe=Se.actions,Me=Pe.clearPings,Le=(Pe.pingsReceived,Object(o.configureStore)({reducer:(Ce={},Object(s.a)(Ce,h.reducerPath,h.reducer),Object(s.a)(Ce,ie.name,ie.reducer),Object(s.a)(Ce,me.name,me.reducer),Object(s.a)(Ce,Se.name,Se.reducer),Ce),middleware:function(e){return e().concat(h.middleware)}}));Object(u.setupListeners)(Le.dispatch);var Ae=n(9),Ie=n(13),Ge=n(160),Re=n(149),De=n(161),Fe=n(150),Be=n(0);function Ue(e){var t,n=m(void 0,{pollingInterval:6e4}),a=O(),r=Object(A.a)(a,2),i=r[0],c=r[1].isLoading,l=n.isFetching||c;return Object(Be.jsx)(Ge.a,{variant:"dark",bg:"primary",expand:"md",children:Object(Be.jsxs)(Re.a,{fluid:!0,children:[Object(Be.jsx)(Ge.a.Brand,{href:"/",children:"Brave Collective Pingboard"}),Object(Be.jsx)(Ge.a.Toggle,{"aria-controls":"navbar-nav"}),Object(Be.jsxs)(Ge.a.Collapse,{id:"navbar-nav",className:"justify-content-end",children:[Object(Be.jsx)(De.a,{variant:"pills",className:"me-auto",children:e.pages.map((function(e){return Object(Be.jsx)(De.a.Link,{as:Ie.c,to:e.href,children:e.title},e.title)}))}),l?Object(Be.jsx)(Ge.a.Text,{children:"Loading\u2026"}):(null===(t=n.data)||void 0===t?void 0:t.isLoggedIn)?Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsx)(Ge.a.Text,{children:n.data.character.name}),Object(Be.jsx)(Fe.a,{onClick:function(){return i()},children:"Log Out"})]}):Object(Be.jsx)(Ie.b,{className:"btn btn-primary",type:"button",to:"/login",children:"Log In"})]})]})})}n(123);function Ye(){return Object(Be.jsx)(Ge.a,{variant:"dark",bg:"primary",expand:"lg",children:Object(Be.jsx)(Re.a,{children:Object(Be.jsx)("div",{className:"footer",children:"Brave Collective Services. For support write to support@bravecollective.freshdesk.com or ask in the ingame channel 'Brave IT Team'."})})})}var qe=function(){return Object(l.useDispatch)()},Ve=l.useSelector,ze=n(14);function He(e){var t=e.time,n=e.format,a=void 0===n?"llll":n,r=e.asLink,i=void 0!==r&&r,c=e.className,l=F()(t);if(i){var s="https://time.nakamura-labs.com/#".concat(l.unix());return Object(Be.jsx)("a",{className:c,href:s,target:"_blank",rel:"noreferrer",onClick:function(e){return e.stopPropagation()},children:l.format(a)})}return Object(Be.jsx)("span",{className:c,children:l.format(a)})}var Je=n(158),Qe=n(151),_e=n(91);function Ke(e){var t="https://evemaps.dotlan.net/map/".concat(e.region,"/").concat(e.constellation);return Object(Be.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:e.constellation})}function We(e){var t=e.time,n=Object(a.useState)(F()(t).fromNow()),r=Object(A.a)(n,2),i=r[0],c=r[1];return Object(a.useEffect)((function(){var e=setInterval((function(){c(F()(t).fromNow())}),1e3);return function(){return clearInterval(e)}}),[t]),Object(Be.jsx)("span",{children:i})}var Xe=[{regex:/\n/g,onMatch:function(e){return Object(Be.jsx)("br",{})}},{regex:/\[([^\]]+\]\([^)]+)\)>/g,onMatch:function(e){var t=e.indexOf("]("),n=e.substring(0,t),a=e.substring(t+2);return Object(Be.jsx)("a",{href:n,target:"_blank",rel:"noreferrer",children:a})}},{regex:/<([^|]+\|[^>]+)>/g,onMatch:function(e){var t=e.indexOf("|"),n=e.substring(0,t),a=e.substring(t+1);return Object(Be.jsx)("a",{href:n,target:"_blank",rel:"noreferrer",children:a})}},{regex:/\*([^*]+)\*/g,onMatch:function(e){return Object(Be.jsx)("b",{children:e})}},{regex:/_([^*]+)_/g,onMatch:function(e){return Object(Be.jsx)("i",{children:e})}},{regex:/~([^~]+)~/g,onMatch:function(e){return Object(Be.jsx)("s",{children:e})}}];function Ze(e){var t=e.text,n=Xe.reduce((function(e,t){var n=t.regex,a=t.onMatch;return e.flatMap((function(e){if("string"!==typeof e)return[e];var t=[];return e.replace(n,(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n.length>3?n.slice(1,n.length-2):[];return t.push(a.apply(void 0,Object(L.a)(i))),"\0"})).split("\0").flatMap((function(e,n){return[e].concat(Object(L.a)(t[n]?[t[n]]:[]))}))}))}),[t]);return Object(Be.jsx)(Be.Fragment,{children:n.map((function(e,t){return Object(Be.jsx)(r.a.Fragment,{children:e},t)}))})}function $e(e){var t=e.ping;return Object(Be.jsxs)(Qe.a,{className:"mt-n2",children:[t.scheduledFor&&Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsx)(_e.a,{xs:3,children:"EVE Time"}),Object(Be.jsx)(_e.a,{xs:9,children:Object(Be.jsx)(He,{time:F.a.utc(t.scheduledFor),asLink:!0,format:"YYYY-MM-DD HH:mm"})}),Object(Be.jsx)(_e.a,{xs:3,children:"Local Time"}),Object(Be.jsxs)(_e.a,{xs:9,children:[Object(Be.jsx)(He,{time:t.scheduledFor})," (",Object(Be.jsx)(We,{time:t.scheduledFor}),")"]})]}),Object(Be.jsx)(_e.a,{xs:3,children:"Channel"}),Object(Be.jsx)(_e.a,{xs:9,children:t.slackChannelName}),Object(Be.jsx)(_e.a,{xs:3,children:"Sent By"}),Object(Be.jsx)(_e.a,{xs:9,children:t.author}),Object(Be.jsx)("hr",{className:"my-1"}),Object(Be.jsx)(_e.a,{xs:3,children:"Ping Text"}),Object(Be.jsx)(_e.a,{xs:9,children:Object(Be.jsx)(Ze,{text:t.text})})]})}function et(e){var t="https://evemaps.dotlan.net/map/".concat(e.region.replaceAll(" ","_"))+(e.system?"/".concat(e.system.replaceAll(" ","_")):"");return Object(Be.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:e.region})}function tt(e){var t="https://evemaps.dotlan.net/system/".concat(e.system.replaceAll(" ","_"));return Object(Be.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:e.system})}var nt=["entry"];function at(e){var t,n,a=e.entry,r=Object(d.a)(e,nt);return Object(Be.jsxs)(Je.a,Object(ue.a)(Object(ue.a)({},r),{},{children:[Object(Be.jsx)(Je.a.Header,{closeButton:!0,children:Object(Be.jsxs)(Je.a.Title,{children:[Object(Be.jsx)("i",{className:{event:"bi-stopwatch",ping:"bi-broadcast-pin"}[null!==(t=null===a||void 0===a?void 0:a.baseEntry.type)&&void 0!==t?t:"event"]})," ",null===a||void 0===a?void 0:a.title,Object(Be.jsx)("h6",{className:"m-0",children:{event:"Timerboard Event",ping:"Ping"}[null!==(n=null===a||void 0===a?void 0:a.baseEntry.type)&&void 0!==n?n:"event"]})]})}),Object(Be.jsxs)(Je.a.Body,{children:["event"===(null===a||void 0===a?void 0:a.baseEntry.type)&&Object(Be.jsx)(rt,{event:a.baseEntry.event}),"ping"===(null===a||void 0===a?void 0:a.baseEntry.type)&&Object(Be.jsx)($e,{ping:a.baseEntry.ping})]})]}))}function rt(e){var t=e.event;return Object(Be.jsxs)(Qe.a,{className:"mt-n2",children:[Object(Be.jsx)(_e.a,{xs:3,children:"EVE Time"}),Object(Be.jsx)(_e.a,{xs:9,children:Object(Be.jsx)(He,{time:F.a.utc(t.time),asLink:!0,format:"YYYY-MM-DD HH:mm"})}),Object(Be.jsx)(_e.a,{xs:3,children:"Local Time"}),Object(Be.jsxs)(_e.a,{xs:9,children:[Object(Be.jsx)(He,{time:t.time})," (",Object(Be.jsx)(We,{time:t.time}),")"]}),Object(Be.jsx)(_e.a,{xs:3,children:"Priority"}),Object(Be.jsx)(_e.a,{xs:9,children:t.priority}),Object(Be.jsx)("hr",{className:"my-1"}),Object(Be.jsx)(_e.a,{xs:3,children:"System"}),Object(Be.jsx)(_e.a,{xs:9,children:Object(Be.jsx)(tt,{system:t.system})}),Object(Be.jsx)(_e.a,{xs:3,children:"Constellation"}),Object(Be.jsx)(_e.a,{xs:9,children:Object(Be.jsx)(Ke,{constellation:t.constellation,region:t.region})}),Object(Be.jsx)(_e.a,{xs:3,children:"Region"}),Object(Be.jsx)(_e.a,{xs:9,children:Object(Be.jsx)(et,{region:t.region,system:t.system})}),Object(Be.jsx)("hr",{className:"my-1"}),t.result&&Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsx)(_e.a,{xs:3,children:"Result"}),Object(Be.jsx)(_e.a,{xs:9,children:t.result})]}),Object(Be.jsx)(_e.a,{xs:3,children:"Standing"}),Object(Be.jsx)(_e.a,{xs:9,children:t.standing}),Object(Be.jsx)(_e.a,{xs:3,children:"Type"}),Object(Be.jsx)(_e.a,{xs:9,children:t.type}),Object(Be.jsx)(_e.a,{xs:3,children:"Structure"}),Object(Be.jsx)(_e.a,{xs:9,children:t.structure}),t.notes&&Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsx)(_e.a,{xs:3,children:"Notes"}),Object(Be.jsx)(_e.a,{xs:9,children:t.notes.split("\n").map((function(e){return Object(Be.jsxs)(Be.Fragment,{children:[e,Object(Be.jsx)("br",{})]})}))})]})]})}n(124);function it(e){var t=e.year,n=e.month,r=e.events,i=e.className,c=ae({year:t,month:n}),l=c.from,s=c.displayedWeeks,o=Object(a.useState)(!1),u=Object(A.a)(o,2),d=u[0],j=u[1],b=Object(a.useState)(null),h=Object(A.a)(b,2),m=h[0],O=h[1],f=Object(L.a)(new Array(s)).map((function(e,t){return{week:l.add(7*t,"days").week(),days:Object(L.a)(new Array(7)).map((function(e,n){var a=l.add(7*t+n,"days"),i=a.valueOf(),c=a.add(1,"days").valueOf(),s=a.format("YYYY-MM-DD")===F.a.utc().format("YYYY-MM-DD");return{date:a,isToday:s,events:r.filter((function(e){var t=F.a.utc(e.dateTime).valueOf();return t>=i&&t<c})).sort((function(e,t){return F.a.utc(e.dateTime).valueOf()-F.a.utc(t.dateTime).valueOf()}))}}))}}));return function(){var e=Object(a.useState)(F.a.locale()),t=Object(A.a)(e,2),n=t[0],r=t[1];Z.add(r),Object(a.useEffect)((function(){return function(){Z.delete(r)}}),[])}(),Object(Be.jsxs)("div",{className:Object(ze.a)("d-flex","flex-column","bg-dark",i),children:[f.map((function(e,t){return Object(Be.jsxs)("div",{className:Object(ze.a)("flex-fill position-relative d-flex flex-grow-1",t>0&&"border-top"),children:[Object(Be.jsx)("div",{className:"py-1 mx-1",style:{width:28},children:Object(Be.jsx)("div",{className:"h-100 rounded-1 px-1 text-center",style:{background:"var(--bs-gray-700)"},children:e.days[0].date.week()})}),e.days.map((function(e,a){return Object(Be.jsxs)("div",{"aria-hidden":!0,className:Object(ze.a)("calendar-day","flex-grow-1","overflow-hidden",a>0&&"border-start",e.date.month()!==n&&"text-muted"),style:{flexBasis:0},children:[0===t&&Object(Be.jsx)("div",{className:"px-1 text-center text-white",children:e.date.format("dddd")}),Object(Be.jsx)("div",{className:Object(ze.a)("day",e.isToday&&"today"),children:Object(Be.jsx)("span",{children:e.date.date()})}),e.events.map((function(e,t){var n;return Object(Be.jsxs)("div",{className:Object(ze.a)("calendar-event",null!==(n=e.color)&&void 0!==n?n:"cyan"),onClick:function(){return t=e,j(!0),void O(t);var t},children:[Object(Be.jsx)(He,{time:F.a.utc(e.dateTime),asLink:!0,format:"HH:mm",className:"me-1"}),Object(Be.jsxs)("span",{children:[Object(Be.jsx)("i",{className:{event:"bi-stopwatch",ping:"bi-broadcast-pin"}[e.baseEntry.type]})," ",e.title]})]},t)}))]},e.date.date())}))]},t)})),Object(Be.jsx)(at,{entry:m,show:d,onHide:function(){j(!1)},fullscreen:"sm-down"})]})}function ct(){var e,t=qe(),n=m(),r=(null===(e=n.data)||void 0===e?void 0:e.isLoggedIn)&&(n.data.character.roles.includes(G.UserRoles.EVENTS_READ)||n.data.character.roles.includes(G.UserRoles.PING)),i=Ve(se),c=Object(a.useState)(F.a.utc()),l=Object(A.a)(c,2),s=l[0],o=l[1],u=s.month(),d=s.year();Object(a.useEffect)((function(){t(re({month:u,year:d}))}),[t,u,d]);var j=Object(Ae.h)("");if(!n.isFetching){var b;if(!(null===(b=n.data)||void 0===b?void 0:b.isLoggedIn))return Object(Be.jsx)(Ae.a,{to:"/login?postLoginRedirect=".concat(null===j||void 0===j?void 0:j.pathname)});if(!r)return Object(Be.jsx)(Re.a,{fluid:!0,children:Object(Be.jsx)("h6",{children:"Sorry, you don't have permission to view this page."})})}return Object(Be.jsxs)(Re.a,{fluid:!0,className:"h-100 d-flex flex-column",children:[Object(Be.jsx)("h3",{className:"mt-n1 pt-3",children:"Calendar"}),Object(Be.jsxs)("div",{className:"d-flex mb-2",children:[Object(Be.jsx)(Fe.a,{size:"sm",variant:"outline-light",className:"me-2",onClick:function(){return o(F.a.utc())},children:"Today"}),Object(Be.jsx)(Fe.a,{size:"sm",variant:"outline-light",className:"me-2",onClick:function(){return o((function(e){return e.subtract(F.a.duration({months:1}))}))},children:Object(Be.jsx)("i",{className:"bi-chevron-left"})}),Object(Be.jsx)(Fe.a,{size:"sm",variant:"outline-light",className:"me-2",onClick:function(){return o((function(e){return e.add(F.a.duration({months:1}))}))},children:Object(Be.jsx)("i",{className:"bi-chevron-right"})}),Object(Be.jsx)("h4",{className:"h-100 mb-0 me-2 align-middle",children:s.format("MMMM YYYY")}),Object(Be.jsxs)(Fe.a,{size:"sm",variant:"outline-light",onClick:function(){t(oe()),t(re({month:u,year:d}))},children:[Object(Be.jsx)("i",{className:"bi-arrow-clockwise"})," Reload"]})]}),Object(Be.jsx)(it,{className:"flex-fill mb-2",year:s.year(),month:s.month(),events:i})]})}var lt=n(159),st=["allowPast","value","onChange"];function ot(e){var t=e.allowPast,n=void 0===t||t,r=e.value,i=e.onChange,c=Object(d.a)(e,st),l="YYYY-MM-DD",s="HH:mm",o="1970-01-01",u=Object(a.useState)(""),j=Object(A.a)(u,2),b=j[0],h=j[1],m=Object(a.useState)(""),O=Object(A.a)(m,2),f=O[0],p=O[1];Object(a.useEffect)((function(){var e=F.a.utc(r),t=F.a.utc("".concat(b,"T").concat(f));e.isSame(t)||(h(e.format(l)),p(e.format(s)))}),[r]);var v=function(e,t){var n=F.a.utc(e),a=F.a.duration(F.a.utc("".concat(o,"T").concat(t)).diff(F.a.utc(o)));return n.add(a)},x=function(){var e=v(b,f);e.isValid()||(e=F()(r)),!n&&e.isBefore(F()())&&(e=F()(),i(e)),h(e.format(l)),p(e.format(s))};return Object(Be.jsxs)(Qe.a,Object(ue.a)(Object(ue.a)({},c),{},{children:[Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"date",xs:6,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{className:"text-nowrap",children:"Date"}),Object(Be.jsx)(lt.a.Control,{type:"date",value:b,pattern:"^[0-9]{4}-[0-9]{2}-[0-9]{2}$",min:n?void 0:F()().toISOString().split("T",1)[0],onChange:function(e){var t=e.target.value;if(h(t),F.a.utc(t).isValid()){var n=v(t,f);n.isValid()&&i(n)}},onBlur:x})]}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"time",xs:6,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{className:"text-nowrap",children:"Time"}),Object(Be.jsx)(lt.a.Control,{type:"text",maxLength:5,pattern:"^[0-9]{2}:[0-9]{2}$",value:f,onChange:function(e){var t=e.target.value;if(p(t),F.a.utc("".concat(o,"T").concat(t)).isValid()){var a=v(b,t);console.log({dateTime:a,allowPast:n,isBeforeNow:a.isBefore(F()())}),!a.isValid()||!n&&a.isBefore(F()())||i(a)}},onBlur:x})]})]}))}var ut=["allowNegative","value","onChange","durationComponents"],dt=[{label:"Days",unit:"days",format:function(e){return 0|e.asDays()}},{label:"Hours",unit:"hours",format:"HH"},{label:"Minutes",unit:"minutes",format:"mm"}];function jt(e){var t=e.allowNegative,n=void 0===t||t,r=e.value,i=e.onChange,c=e.durationComponents,l=void 0===c?dt:c,s=Object(d.a)(e,ut),o=function(e){var t=F.a.duration(Object.fromEntries(l.map((function(t,n){var a=t.unit,r=parseInt(e[n],10);return[a,isFinite(r)?r:0]})))).asMilliseconds();return!n&&t<0?F.a.duration(0):F.a.duration(t,"ms")},u=function(e){return l.map((function(t){var n=t.format;return"function"===typeof n?"".concat(n(e)):F.a.duration(e.asMilliseconds(),"milliseconds").format(n)}))},j=Object(a.useState)(u(r)),b=Object(A.a)(j,2),h=b[0],m=b[1];Object(a.useEffect)((function(){var e=u(o(h)),t=u(r);e.some((function(e,n){return e!==t[n]}))&&m(u(r))}),[r]);var O=function(e,t){var n=h.map((function(n,a){return a===e?t:n}));m(n),i(o(n))},f=function(){m(u(r))};return Object(Be.jsx)(Qe.a,Object(ue.a)(Object(ue.a)({},s),{},{children:l.map((function(e,t){var n=e.label;return Object(Be.jsxs)(lt.a.Group,{as:_e.a,xs:12/l.length,children:[Object(Be.jsx)(lt.a.Label,{children:n}),Object(Be.jsx)(lt.a.Control,{type:"number",pattern:"^-?[0-9]*$",value:h[t],onChange:function(e){return O(t,e.target.value)},onBlur:f})]},n)}))}))}function bt(e){var t=e.allowPast,n=void 0===t||t,r=e.time,i=e.onChange,c="absolute"in r?"absolute":"relative",l=Object(a.useState)(Ot(r)),s=Object(A.a)(l,2),o=s[0],u=s[1];return Object(a.useEffect)((function(){var e=function(){return u(Ot(r))},t=setInterval(e,1e3);return e(),function(){return clearInterval(t)}}),[r]),Object(ue.a)({handleChangeInputMode:function(e){"absolute"===e&&"relative"in r?i({absolute:F()().add(r.relative).utc()}):"relative"===e&&"absolute"in r&&i({relative:F.a.duration(r.absolute.diff(F()()))})},handleAbsoluteDateChange:function(e){return i({absolute:!n&&e.isBefore(F()())?F()():e})},handleRelativeDateChange:function(e){return i({relative:!n&&e.asMilliseconds()<0?F.a.duration(0):e})},inputMode:c},o)}function ht(e){return"absolute"in e?e.absolute:F()().add(e.relative).utc()}function mt(e){return"relative"in e?e.relative:F.a.duration(e.absolute.diff(F()()))}function Ot(e){return{absoluteTime:ht(e),relativeTime:mt(e)}}var ft=n(92),pt=n(162),vt=n(157),xt=["options","resultLimit","optionName","loadingText","searchKeys","value","onChange","renderOption"];function gt(e){var t=e.options,n=e.resultLimit,r=e.optionName,i=e.loadingText,c=e.searchKeys,l=e.value,s=e.onChange,o=e.renderOption,u=void 0===o?r:o,j=Object(d.a)(e,xt),b=Object(a.useState)(""),h=Object(A.a)(b,2),m=h[0],O=h[1],f=Object(a.useState)([]),p=Object(A.a)(f,2),v=p[0],x=p[1],g=Object(a.useState)(0),y=Object(A.a)(g,2),w=y[0],N=y[1],C=Object(a.useState)(!1),S=Object(A.a)(C,2),T=S[0],k=S[1],E=Object(a.useMemo)((function(){return new ft.a(t,{keys:c,distance:10,threshold:.3})}),[t,c]),P=Object(a.useCallback)((function(e){var t=E.search(e);return x("number"===typeof n?t.slice(0,n):t),t}),[E,n]);Object(a.useEffect)((function(){if(!l)return O(""),x([]),void N(0);var e=P(l),t=e.findIndex((function(e){return r(e.item)===l}));t>=0?(O(r(e[t].item)),N(t)):(O(""),N(0))}),[l,E,r,P]);var M=function(e){var t=r(e);O(t);var n=P(t).findIndex((function(e){return r(e.item)===t}));N(Math.max(n,0)),s(e),k(!1)},L=Object(a.useRef)(null),I=Object(a.useRef)(null),G=Object(a.useState)(null),R=Object(A.a)(G,2),D=R[0],F=R[1],B=Object(vt.a)(L.current,I.current,{placement:"bottom",modifiers:[{name:"flip"}]});return Object(Be.jsxs)("div",{className:"position-relative",children:[Object(Be.jsx)(lt.a.Control,Object(ue.a)({ref:L,type:"text",value:m,onChange:function(e){O(e.target.value),P(e.target.value)},onFocus:function(){k(!0)},onBlur:function(){if(v.length>0){if(w>=0&&w<v.length){var e=v[w].item;M(e)}}else O(""),s(null);k(!1)},onKeyDown:function(e){if("ArrowDown"===e.key||"ArrowUp"===e.key){var t="ArrowDown"===e.key?1:-1,n=Math.max(0,Math.min(v.length-1,w+t));N(n),v.length>0&&O(r(v[n].item)),e.preventDefault()}else if("Enter"===e.key){if(w>=0&&w<v.length){var a=v[w].item;M(a)}}else k(!0)}},j)),Object(Be.jsx)(pt.a,Object(ue.a)(Object(ue.a)({ref:I,className:Object(ze.a)("shadow","w-100",!T&&"invisible"),style:Object(ue.a)(Object(ue.a)({},B.styles.popper),{},{maxHeight:"50vh",overflow:"hidden auto",zIndex:1e3})},B.attributes.popper),{},{children:i?Object(Be.jsx)(pt.a.Item,{children:i}):v.map((function(e,t){return Object(Be.jsx)(pt.a.Item,{action:!0,tabIndex:-1,onMouseDown:function(e){return e.preventDefault()},onClick:(a=e.item,function(e){e.preventDefault();var t=v.findIndex((function(e){return e.item===a})),n=Math.max(0,Math.min(v.length-1,t));N(n),v.length>0&&(O(r(a)),M(a))}),ref:(n=t===w,n?function(e){e&&D!==e&&(F(e),e.scrollIntoView({block:"nearest"}))}:function(){}),active:t===w,children:u(e.item)},r(e.item));var n,a}))}))]})}var yt=["value","onChange"];function wt(e){var t,n,r=e.value,i=e.onChange,c=Object(d.a)(e,yt),l=x(),s=null!==(t=null===(n=l.data)||void 0===n?void 0:n.solarSystems)&&void 0!==t?t:[],o=Object(a.useMemo)((function(){return[{name:"name",weight:100},{name:"constellation",weight:10},{name:"region",weight:1}]}),[]),u=Object(a.useCallback)((function(e){return"".concat(e.name," (").concat(e.constellation,", ").concat(e.region,")")}),[]),j=Object(a.useCallback)((function(e){return e.name}),[]);return Object(Be.jsx)(gt,Object(ue.a)({options:s,optionName:j,loadingText:l.isFetching?Object(Be.jsx)(Be.Fragment,{children:"loading\u2026"}):!!l.isError&&"error loading systems",resultLimit:50,searchKeys:o,value:r,onChange:i,renderOption:u},c))}n(125);var Nt=["Low","Medium","High","Critical"],Ct=[["TCU","TCU"],["IHub","IHub"],["POS","POS"],["POCO","POCO"],["Raitaru","Raitaru"],["Azbel","Azbel"],["Sotiyo","Sotiyo"],["Athanor","Athanor"],["Tatara","Tatara"],["Astrahus","Astrahus"],["Fortizar","Fortizar"],["Keepstar","Keepstar"],["Pharolynx","Pharolynx Cyno Beacon"],["Tenebrex","Tenebrex Cyno Jammer"],["Ansiblex","Ansiblex Jump Gate"],["other","other"]],St=["Anchoring","Shield","Armor","Structure","other"],Tt=["friendly","enemy","neutral","other"],kt=["No data","Win","Loss"];function Et(e){var t,n,r=e.show,i=e.event,c=e.onSave,l=e.onCancel,o=e.onDelete,u=Object(a.useState)({system:"",priority:"",structure:"",type:"",standing:"",result:"No data",notes:""}),d=Object(A.a)(u,2),j=d[0],b=d[1],h=Object(a.useState)({relative:F.a.duration(0)}),m=Object(A.a)(h,2),O=m[0],f=m[1];Object(a.useEffect)((function(){r&&(i?(b(Object(ue.a)({},i)),f({absolute:F.a.utc(i.time)})):(b({system:"",priority:"",structure:"",type:"",standing:"",result:"No data",notes:""}),f({relative:F.a.duration(0)})))}),[i,r]);var p=bt({time:O,onChange:f}),v=Object.entries(null!==j&&void 0!==j?j:{}).every((function(e){var t=Object(A.a)(e,2),n=t[0],a=t[1];return"notes"===n||!!a})),x="number"!==typeof(null===i||void 0===i?void 0:i.id),g=!x&&["Last edited by ".concat(null!==(t=null===i||void 0===i?void 0:i.updatedBy)&&void 0!==t?t:"unknown"),(null===i||void 0===i?void 0:i.updatedAt)?"at ".concat(F()(i.updatedAt).format("llll")," (").concat(F()(i.updatedAt).fromNow(),")"):"unknown"].join(" "),y="absolute"===p.inputMode,w=function(e,t){b((function(n){return Object(ue.a)(Object(ue.a)({},n),{},Object(s.a)({},e,t))}))},N=function(e){return function(t){return w(e,t.target.value)}},C=Object(a.useState)(!1),S=Object(A.a)(C,2),T=S[0],k=S[1];return Object(Be.jsxs)(Je.a,{show:r,size:"lg",backdrop:"static",dialogClassName:"edit-event-dialog",children:[Object(Be.jsx)(Je.a.Header,{children:Object(Be.jsxs)(Je.a.Title,{children:[x?"Add":"Edit"," Event"]})}),Object(Be.jsx)(Je.a.Body,{children:Object(Be.jsx)(lt.a,{children:Object(Be.jsxs)(Qe.a,{children:[g&&Object(Be.jsx)(_e.a,{xs:12,className:"mb-3",children:g}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"solarSystem",xs:12,sm:6,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{children:"Solar System"}),Object(Be.jsx)(wt,{value:j.system,onChange:function(e){var t;return w("system",null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"")},placeholder:"e.g. Q-5211"})]}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"priority",xs:12,sm:6,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{children:"Priority"}),Object(Be.jsxs)(lt.a.Select,{value:j.priority,onChange:N("priority"),children:[Object(Be.jsx)("option",{value:"",children:"(Please Select)"}),Nt.map((function(e){return Object(Be.jsx)("option",{value:e,children:e},e)}))]})]}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"structure",xs:12,sm:6,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{children:"Structure"}),Object(Be.jsxs)(lt.a.Select,{value:j.structure,onChange:N("structure"),children:[Object(Be.jsx)("option",{value:"",children:"(Please Select)"}),Ct.map((function(e){var t=Object(A.a)(e,2),n=t[0],a=t[1];return Object(Be.jsx)("option",{value:n,children:a},n)}))]})]}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"type",xs:12,sm:6,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{children:"Type"}),Object(Be.jsxs)(lt.a.Select,{value:j.type,onChange:N("type"),children:[Object(Be.jsx)("option",{value:"",children:"(Please Select)"}),St.map((function(e){return Object(Be.jsx)("option",{value:e,children:e},e)}))]})]}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"standing",xs:12,sm:6,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{children:"Standing"}),Object(Be.jsxs)(lt.a.Select,{value:j.standing,onChange:N("standing"),children:[Object(Be.jsx)("option",{value:"",children:"(Please Select)"}),Tt.map((function(e){return Object(Be.jsx)("option",{value:e,children:e},e)}))]})]}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"result",xs:12,sm:6,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{children:"Result"}),Object(Be.jsx)(lt.a.Select,{value:j.result,onChange:N("result"),children:kt.map((function(e){return Object(Be.jsx)("option",{value:e,children:e},e)}))})]}),Object(Be.jsx)(_e.a,{xs:12,children:Object(Be.jsx)(lt.a.Label,{children:"Event Time"})}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"eveDateTime",xs:12,lg:6,children:[Object(Be.jsx)(lt.a.Label,{children:Object(Be.jsx)(lt.a.Check,{inline:!0,label:"Use EVE Date and Time",name:"eveDateTimeMode",type:"radio",onChange:function(){return p.handleChangeInputMode("absolute")},id:"absolute",checked:y})}),Object(Be.jsx)(ot,{value:p.absoluteTime,onChange:p.handleAbsoluteDateChange,className:Object(ze.a)("time-mode-input",!y&&"inactive-time-mode")})]}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"relativeTime",xs:12,lg:6,children:[Object(Be.jsx)(lt.a.Label,{children:Object(Be.jsx)(lt.a.Check,{inline:!0,label:"Use Relative Time",name:"eveDateTimeMode",type:"radio",onChange:function(){return p.handleChangeInputMode("relative")},id:"relative",checked:!y})}),Object(Be.jsx)(jt,{value:p.relativeTime,onChange:p.handleRelativeDateChange,className:Object(ze.a)("time-mode-input",y&&"inactive-time-mode")})]}),Object(Be.jsx)(_e.a,{xs:12,className:"d-block d-lg-none",children:Object(Be.jsx)("hr",{})}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"notes",xs:12,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{children:"Notes"}),Object(Be.jsx)(lt.a.Control,{as:"textarea",rows:1,value:null!==(n=null===j||void 0===j?void 0:j.notes)&&void 0!==n?n:"",onChange:function(e){return w("notes",e.target.value)}})]})]})})}),Object(Be.jsxs)(Je.a.Footer,{className:"dialog-footer",children:[Object(Be.jsxs)("div",{className:Object(ze.a)("dialog-buttons-wrapper",T&&"hidden"),children:[!x&&Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsx)(Fe.a,{variant:"danger",disabled:T,onClick:function(){return k(!0)},children:"Delete"}),Object(Be.jsx)("div",{className:"dialog-buttons-spacer"})]}),Object(Be.jsx)(Fe.a,{variant:"secondary",onClick:l,disabled:T,children:"Cancel"}),Object(Be.jsx)(Fe.a,{variant:"primary",disabled:!v||T,onClick:function(){v&&c&&(c(Object(ue.a)(Object(ue.a)({},j),{},{time:p.absoluteTime.toISOString()})),b({system:"",priority:"",structure:"",type:"",standing:"",result:"No data",notes:""}))},children:"Save"})]}),!x&&Object(Be.jsxs)("div",{className:Object(ze.a)("confirm-delete-buttons-wrapper",!T&&"hidden"),children:[Object(Be.jsx)(Fe.a,{disabled:!T,onClick:function(){return k(!1)},children:"No"}),Object(Be.jsx)("div",{className:"dialog-buttons-spacer",children:"Are you sure you want to delete the event?"}),Object(Be.jsx)(Fe.a,{variant:"danger",disabled:!T,onClick:function(){k(!1),null===o||void 0===o||o(),b({system:"",priority:"",structure:"",type:"",standing:"",result:"No data",notes:""})},children:"Yes"})]})]})]})}var Pt=n(152);n(126);function Mt(e){var t=e.showResultColumn,n=void 0!==t&&t,a=e.canEdit,r=void 0!==a&&a,i=e.onEdit,c=e.events,l=function(e){var t=Date.parse(e.time),n=Date.now();return Math.abs(t-n)<36e5?"present":t>n?"future":"past"};return Object(Be.jsxs)(Pt.a,{hover:!0,size:"sm",variant:"dark",responsive:!0,className:"events-table",children:[Object(Be.jsx)("thead",{children:Object(Be.jsxs)("tr",{className:"events-header-row",children:[Object(Be.jsx)("th",{children:"System"}),Object(Be.jsx)("th",{children:"Region"}),Object(Be.jsx)("th",{children:"Priority"}),Object(Be.jsx)("th",{children:"Structure"}),Object(Be.jsx)("th",{children:"Type"}),Object(Be.jsx)("th",{children:"Standing"}),Object(Be.jsx)("th",{children:"Relative Time"}),Object(Be.jsx)("th",{children:"Local Time"}),Object(Be.jsx)("th",{children:"EVE Time"}),n&&Object(Be.jsx)("th",{children:"Result"}),Object(Be.jsx)("th",{children:"Notes"}),r&&Object(Be.jsx)("th",{children:"Action"})]})}),Object(Be.jsxs)("tbody",{children:[0===c.length&&Object(Be.jsx)("tr",{children:Object(Be.jsx)("td",{colSpan:+n+10+ +r,children:"No Events"})}),c.map((function(e){return Object(Be.jsxs)("tr",{className:Object(ze.a)("event-row",l(e)),children:[Object(Be.jsx)("th",{scope:"row",children:Object(Be.jsx)(tt,{system:e.system})}),Object(Be.jsx)("td",{children:Object(Be.jsx)(et,{system:e.system,region:e.region})}),Object(Be.jsx)("td",{children:e.priority}),Object(Be.jsx)("td",{children:e.structure}),Object(Be.jsx)("td",{children:e.type}),Object(Be.jsx)("td",{children:e.standing}),Object(Be.jsx)("td",{children:Object(Be.jsx)(We,{time:e.time})}),Object(Be.jsx)("td",{children:Object(Be.jsx)(He,{time:e.time})}),Object(Be.jsx)("td",{children:Object(Be.jsx)(He,{time:F()(e.time).utc(),format:"YYYY-MM-DD HH:mm",asLink:!0})}),n&&Object(Be.jsx)("td",{children:e.result}),Object(Be.jsx)("td",{className:"event-notes",children:e.notes}),r&&Object(Be.jsx)("td",{children:Object(Be.jsxs)(Fe.a,{size:"sm",onClick:function(){return null===i||void 0===i?void 0:i(e)},children:[Object(Be.jsx)("i",{className:"bi-pencil"})," Edit"]})})]},e.id)}))]})]})}n(127);function Lt(){var e,t,n,r=m(),i=(null===(e=r.data)||void 0===e?void 0:e.isLoggedIn)&&r.data.character.roles.includes(G.UserRoles.EVENTS_EDIT),c=i||(null===(t=r.data)||void 0===t?void 0:t.isLoggedIn)&&r.data.character.roles.includes(G.UserRoles.EVENTS_ADD),l=(null===(n=r.data)||void 0===n?void 0:n.isLoggedIn)&&r.data.character.roles.includes(G.UserRoles.EVENTS_READ),s=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).skip,t=qe(),n=Ve(Oe),r=Ve(pe),i=Ve(fe),c=function(){return t(be())},l=function(){return t(je())};return Object(a.useEffect)((function(){!0!==e&&t(je())}),[t,e]),{events:n,loading:r,hasMoreEvents:i,loadMoreEvents:c,reloadEvents:l}}({skip:r.isLoading||!l}),o=f(),u=Object(A.a)(o,2),d=u[0],j=u[1],b=p(),h=Object(A.a)(b,2),O=h[0],x=h[1],g=v(),y=Object(A.a)(g,2),w=y[0],N=y[1],C=Object(a.useState)(null),S=Object(A.a)(C,2),T=S[0],k=S[1],E=!!T;Object(a.useEffect)((function(){var e;switch(T){case"add":e=j;break;case"edit":e=x;break;case"delete":e=N;break;default:return}e.isLoading||(e.isError&&console.log("An Error occurred trying to",T,"an event",e.error),k(null))}),[j,N,s,T,x]);var P=Object(a.useState)({event:null,show:!1}),M=Object(A.a)(P,2),L=M[0],I=M[1],R=function(){return I({event:null,show:!1})},D=Object(Ae.h)("");if(!r.isFetching){var F;if(!(null===(F=r.data)||void 0===F?void 0:F.isLoggedIn))return Object(Be.jsx)(Ae.a,{to:"/login?postLoginRedirect=".concat(null===D||void 0===D?void 0:D.pathname)});if(!l)return Object(Be.jsx)(Re.a,{fluid:!0,children:Object(Be.jsx)("h6",{children:"Sorry, you don't have permission to view this page."})})}return Object(Be.jsxs)(Re.a,{fluid:!0,children:[Object(Be.jsxs)("div",{className:"timers-header",children:[Object(Be.jsx)("h3",{children:"Timers"}),Object(Be.jsxs)(Fe.a,{onClick:s.reloadEvents,disabled:E,children:[Object(Be.jsx)("i",{className:"bi-arrow-clockwise"})," Reload"]}),Object(Be.jsx)("div",{style:{flex:1}}),c&&Object(Be.jsxs)(Fe.a,{onClick:function(){return I({event:null,show:!0})},disabled:E,children:[Object(Be.jsx)("i",{className:"bi-calendar-plus"})," New Event"]})]}),Object(Be.jsx)(Mt,{events:s.events,showResultColumn:!0,canEdit:i,onEdit:function(e){return I({event:e,show:!0})}}),Object(Be.jsx)(Fe.a,{className:"w-100 mb-3",disabled:!s.hasMoreEvents||s.loading||E,onClick:s.loadMoreEvents,children:s.loading?"Loading\u2026":s.hasMoreEvents?"Load more":"(No more events)"}),Object(Be.jsx)(Et,{show:L.show,event:L.event,onCancel:R,onSave:function(e){L.event?(k("edit"),O({id:L.event.id,event:e})):(k("add"),d(e)),R()},onDelete:function(){var e=L.event;e&&(k("delete"),w(e.id),R())}})]})}var At=n.p+"static/media/brave-logo.070fd9e9.svg";function It(e){var t=e.width,n=e.height;return Object(Be.jsx)("img",{src:At,alt:"Logo",className:"img-fluid",width:t,height:n})}function Gt(e){var t=e.postLoginRedirect,n="/auth/login"+(t?"?".concat(new URLSearchParams({postLoginRedirect:t})):"");return Object(Be.jsx)("a",{href:n,children:Object(Be.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAAtCAQAAAD1900CAAAIy0lEQVR42u2ca2wcVxXHf7NeUqF2pxRViLKbVhXQeDYIaD7sOlABEXZAiEfkqGoIqpKCUpJSO03tiqeCIiREiCBxohYoSu0UQZGSOOUl0iSEhwR+fCkt9S5IgKBeoyCMGk+CHGi8lw/3zu68d9be9e7E+a+0O3Pm3HPPOffccx8zs9raBF9fNdDBdawECLTQcwvzVxlkSFv71Ts/fzui1VpHgkaCckx0jTeS/JmXt2rvFG/ln63WJSJeyxrO8/pWq7ECoPEGCn9PJrjQak0iQ2aN5cocWlvlqOXVRjALdyTayQG1oNVJXxrayzPLrc0CkCi32uq64K9tMx3XnMCLA8ok2yt5hkOw/Mk+Pt5pNDQSrVbhOtoXyTj1DUF5EZkjTrlx8WiGlUkRI9eJRa1W4mPfUtB4K0XcModYIXmgPZAMWgEsBc1qwDJltCbo2/6Wt8ISSDRjqdY8B7X7INje2tVrS1LEaiUvSMRK3/hCo0nDSrMgt8/jo2/ckQxLhBMRBPyGx3iIbQDs5HlfnnV8C4BjPMEB3hNBah54BzkmecFBvx4YywfRmE2wEWYBeNRXXIIBAGYZrktqmr+iOyhl4jUIxh1JeYvFjeizbsECl3icLwN38RFGPRwf4y0APM5lok7ZFoBpdEyHdoIFNF99JdJ0A+eYsdFydJMBJjiFqWi95NAxmXRp20uKS4ySwwCKTAI5DC75WOWGQR/wkIO2zaONpZNhOzuHTq7CadmQJ2XjOeYq77XJiV5SFJmkD4NzEbT3QiNwWLFTv8OvQ4RcBuBn3EsW2MUZRbGQUg4r8FMbtchXaqr3ex+tRGjuSNMHFG3N0csXbA79DCbQpwZB6CblcHs3OSYZVQ1d5H5ko09GcG+KnDp6ghxHOAYebSxI+VVfSE4Zgt30AaforsgDZ3D42eRGNzmOMIlBLtLkwA+CpAgZxweU8rWf+ChzgGHgFnbwDceVHbwOgAOqxx/lx8Ar/HER6i7U2OcQ6rvK8TBwls9i8H0MNjGCwTbgMCPsp4dtjqFOqNJSjsFtzFRotVBgF3JO5CzhV1bKP6zOplX43EQZ6ASKXEQAM5ys+LcKr03+nhCUGUKntKiZmibvygbjHwDczM0hPJeVaS9wmg8CWzjJ3ypX7+Q+AH5emVi+wqsArAlV7U8B9PrMzKMDo0CRCfLkGSEPwAgwSg86aZ+ebaHH43iDvCrdi47JKLAdOAsYwATbyQB5dQ10+jGYYdhTj122pR1kkLkEoOTT8H429aJTJE0PJqOOTGGgAzO+HNvJAxOMBgxNifDVyjMRGuBXPKqOhtjADXQwyMOVq4N0AFcqvQQGeF8Eqet8qfXuPxrK8Zb7DUUrKsq6kLIzpNns0zj9wFlm+BKoAJCUDP3ACP2AXG3J4PiimlSn2RVSW1FpJ/Ur1GlTD3lMVU+ej9oau4c8h5nw4dhPjzrLB2gmSFgjud8nGizuCypFv4t3K8o9rAdgmAuLlOn8lNVd2XCN3fpXj3UEOmCG2it/SxRJ0+nSp6AaOq3kpckBJqVK3TspAicZUpST3M1hIO+pZ7v6WHL1yryloHjSiqO3hk0yvN7LVkCn02UJPhyd9ABb2Qrk6QzwRnLpT3NXyw+ziTcCg4zzKq9hEIALjDToTqpggbD1TjU4JMoOqtNdm9kIwJCnn1rlz2CwmZJLH9lbBWCi8ybSQNEWmOM8AJQqUscRTLlkyKN+dfYUVq7oxADMStmM4pnghMdG9/c4c8w59Hf/2jnkgFLAGtD8clWNu7L3RGjGq7byVzjIfuAOtvA0H+d2AL7JFRv/50hGkBocHFGyj8WheWRZN/0Fupp9pFyNVnXpCXbTwzA46hwnT4osMMxusoomHBKctbr7sYUhG32aEhmypLHyhgBKakJqesp6bXLWKAJ+7TD4NtYw5e/T0Oc5NgDwPC/XbA4Lp9nC3cCn+R0PqtLPOWp4G7cBs/w2sswqyq6hyT0HcWeOoF4GgqMc5UXwCTaLMscZNqqRucozDWQpAc+xW034pj3u9xsA3OFy1GFFgQwGGeyhVqrweG30frvrDvp12lwA5nxjQJAMm//LvYgfMOlzzWqYf/EHh8D9PIPGTTzNjYDga66KP8EG4C/cQBjOB9BFyJkXckjIUEKuAkpAgS7V32tjnI0e3gKQRc4zTDLohE8ga0MouRvJkK0pTdq0mmmbTYtDQXXfINRYykrIaUsQfsluV5U/YhNwIwDPVpZlTryZQ6F1vj1Q4Xq2z6XjujgBdCHdbgI6XYzTVbP8Gfb6yDRVeRloUFpCA9n9hgrEKMGRZ9pmU/2QXgD4IVkeZNyHR3Pfla3/YRXvJs8helRo/IdDnqvR5JcDqAuhG1JS9pPq7CBHGWM9j5AiSwY4TpnTPALs5Tif8uhv3wQTlLnIce712DjFemCKMlN0qSOrbuvok6Q4WJFfvWbX80WbnjCmzgpcrPB0VXh2VK6/5GOTd9tNBPxaHKfZS5YHkAH5ko9PNSARlqgvR/jMe8TOVprnSf7tuTofSWoQgu+r+GOAMXT28AFM9jEGlNgHZNiDyfGa5ccDaSZWL3b33ROY6JGHrqrnZfOP1eT02iTL1wOTfZjsYQ+wL2ATTKCtEY1/O2EVP2E103xY7YY2CkluZc4nHMOxmgxOp+usJUoztBLhOdxrU/2QXpgKCA2N+eYEB7yfI/TxiwZL7eBWLvLfJugbHdfOU6K17JynYe/KOieK5znU8NCAxT/s07inQNohNJbnmRaBdpeIz+MzHdzCpRZnjnoR10yjcSVur0PWt5RdLoTpFLfQsNsSq79gkG+utB/i5UOJoIC27+PG7o23dn9zJS6I4sWYBcfVFRUcrZ6vxCw4yivqD+NabWms3rIvR7xlHye078sWDXpvZTkVrncDPUhOu6BdQwNiOKw0St/4WN06xOoP40Sb7nPUb0ccUCb5v+9p99f6c+vmjIuLk3ptTEjb3wYBj2mrV3FK+1Djla1vGdbqRdu1j7o9/F12/h8TB8xJk2exoQAAAABJRU5ErkJggg==",alt:"LOG IN with EVE Online"})})}n(128);function Rt(){var e,t=m(),n=Object(Ae.g)();if(null===(e=t.data)||void 0===e?void 0:e.isLoggedIn)return Object(Be.jsx)(Ae.a,{to:"/"});var a=new URLSearchParams(n.search).get("postLoginRedirect");return Object(Be.jsxs)(Re.a,{className:"login-container",children:[Object(Be.jsx)("div",{style:{flex:"33%"}}),Object(Be.jsxs)(Qe.a,{className:"jumbotron",style:{justifyContent:"center"},children:[Object(Be.jsxs)(_e.a,{sm:7,children:[Object(Be.jsx)("h1",{children:"Brave Collective PingBoard"}),Object(Be.jsx)("hr",{}),Object(Be.jsx)("p",{children:"Log in with your EVE Online Account to gain access."}),Object(Be.jsx)("p",{children:Object(Be.jsx)(Gt,{postLoginRedirect:a})}),Object(Be.jsxs)("p",{children:["You first need a"," ",Object(Be.jsx)("a",{href:"https://account.bravecollective.com/",target:"_blank",rel:"noreferrer",children:"BRAVE Core Service Account"})," ","to log in here."]})]}),Object(Be.jsx)(_e.a,{sm:5,children:Object(Be.jsx)(It,{})})]}),Object(Be.jsx)("div",{style:{flex:"66%"}})]})}function Dt(){return Object(Be.jsx)(Ae.b,{})}function Ft(){return Object(Be.jsx)(Ae.a,{to:"send",replace:!0})}var Bt=n(153);n(129);function Ut(){var e,t,n,a=m(),r=(null===(e=a.data)||void 0===e?void 0:e.isLoggedIn)&&a.data.character.roles.includes(G.UserRoles.PING_TEMPLATES_WRITE),i=Object(Ae.j)(),c=null!==(t="string"===typeof i.templateId&&Number(i.templateId))&&void 0!==t?t:null,l=N();return Object(Be.jsxs)(Re.a,{className:"h-100 mh-100 d-flex flex-column send-pings",children:[Object(Be.jsxs)("div",{className:"pings-header",children:[Object(Be.jsx)("h3",{children:"Send Ping"}),Object(Be.jsx)(Ie.b,{to:"../sent",className:"btn btn-primary",role:"button",children:"Show Sent Pings"}),Object(Be.jsx)("div",{style:{flex:1}}),r&&Object(Be.jsxs)(Ie.b,{to:"../templates",className:"btn btn-primary",role:"button",children:[Object(Be.jsx)("i",{className:"bi-wrench"})," Manage Ping Templates"]})]}),Object(Be.jsxs)(Bt.a,{variant:"warning",className:"py-2",children:[Object(Be.jsx)("i",{className:"bi-exclamation-triangle"})," ","If you send ",Object(Be.jsx)("b",{children:"bad pings"})," you ",Object(Be.jsx)("b",{children:"will be banned from sending pings"}),". Use the template, if possible. Also, ",Object(Be.jsx)("b",{children:"don't spam newlines and emoji in your pings or you'll have your ping rights revoked"}),". Make sure you send your pings to the correct group. Some groups are meant for emergencies, don't randomly ping them. Just use it responsibly."]}),Object(Be.jsxs)(lt.a,{as:Qe.a,className:"pings-container",children:[Object(Be.jsxs)(lt.a.Group,{as:_e.a,xs:12,md:4,className:"mb-3 pb-3 template-column",children:[Object(Be.jsx)(lt.a.Label,{children:"Send Ping to Group:"}),Object(Be.jsx)(pt.a,{className:"templates",children:null===(n=l.data)||void 0===n?void 0:n.templates.map((function(e){return Object(Be.jsxs)(pt.a.Item,{type:"button",action:!0,active:c===e.id,as:Ie.b,to:e.id.toString(),children:[e.name," (#",e.slackChannelName,")"]},e.id)}))})]}),Object(Be.jsx)(_e.a,{xs:12,md:8,className:"pb-3 ping-column",children:Object(Be.jsx)(Ae.b,{})})]})]})}var Yt=n(155);function qt(e,t,n){if(function(e){return"undefined"!==typeof window&&Object(L.a)(new Array(window.localStorage.length)).findIndex((function(t,n){return window.localStorage.key(n)===e}))>=0}(e))try{var a;return n(null!==(a=window.localStorage.getItem(e))&&void 0!==a?a:"null")}catch(r){console.error(r)}return t}var Vt=n(156),zt=n(154);function Ht(e){var t=e.placeholders,n=void 0===t?[]:t,r=e.value,i=e.onChange,c=Object(a.useRef)(null),l=function(e){return function(t){if(t.preventDefault(),c.current&&r){var n=c.current,a=n.selectionStart,l=n.selectionEnd,s=[r.substring(0,a),"{{".concat(e,"}}"),r.substring(l)].join("");i(s),setTimeout((function(){var t,n=a+e.length+4;null===(t=c.current)||void 0===t||t.setSelectionRange(n,n)}))}}};return Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsx)(lt.a.Label,{children:"Ping Text:"}),n.length>0&&Object(Be.jsxs)(Bt.a,{variant:"info",className:"py-1",children:[Object(Be.jsx)("i",{className:"bi-info-circle"})," ","There are a few placeholders available that will be replaced when sending the ping:",Object(Be.jsx)("ul",{className:"mb-0",children:n.map((function(e){var t=e.placeholder,n=e.description;return Object(Be.jsxs)("li",{children:[Object(Be.jsx)(Vt.a,{placement:"bottom",delay:{show:250,hide:0},overlay:Object(Be.jsx)(zt.a,{children:"Click to insert the placeholder at the cursor position"}),children:Object(Be.jsx)("code",{onMouseDown:l(t),role:"button",children:"{{".concat(t,"}}")})})," \u2192 ",n]},t)}))})]}),Object(Be.jsx)(lt.a.Control,{ref:c,as:"textarea",className:"ping-text flex-grow-1 overflow-auto",style:{height:"300px"},value:r,onChange:function(e){return i(e.target.value)}})]})}function Jt(e){var t=e.allowPast,n=void 0!==t&&t,a=bt({time:e.time,onChange:e.onChange,allowPast:n});return Object(Be.jsxs)(Qe.a,{className:"me-0",children:[Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"eveDateTime",xs:12,lg:6,className:"pe-0",children:[Object(Be.jsx)(lt.a.Label,{children:Object(Be.jsx)(lt.a.Check,{inline:!0,label:"Use EVE Time (UTC)",name:"eveDateTimeMode",type:"radio",onChange:function(){return a.handleChangeInputMode("absolute")},id:"absolute",checked:"absolute"===a.inputMode})}),Object(Be.jsx)(ot,{allowPast:n,value:a.absoluteTime,onChange:a.handleAbsoluteDateChange,className:Object(ze.a)("time-mode-input","absolute"!==a.inputMode&&"inactive-time-mode")})]}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"relativeTime",xs:12,lg:6,className:"mb-3 me-0",children:[Object(Be.jsx)(lt.a.Label,{children:Object(Be.jsx)(lt.a.Check,{inline:!0,label:"Use Relative Time",name:"eveDateTimeMode",type:"radio",onChange:function(){return a.handleChangeInputMode("relative")},id:"relative",checked:"relative"===a.inputMode})}),Object(Be.jsx)(jt,{value:a.relativeTime,onChange:a.handleRelativeDateChange,className:Object(ze.a)("me-n4","time-mode-input","relative"!==a.inputMode&&"inactive-time-mode")})]})]})}n(130);function Qt(){var e,t,n,r,i=m(),c=N(),l=Object(Ae.j)(),s=Object(a.useMemo)((function(){var e;return null===(e=c.data)||void 0===e?void 0:e.templates.find((function(e){return e.id===Number(l.templateId)}))}),[l.templateId,null===(e=c.data)||void 0===e?void 0:e.templates]),o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.deserialize,i=void 0===r?JSON.parse:r,c=n.serialize,l=void 0===c?JSON.stringify:c,s=Object(a.useState)((function(){return qt(e,t,i)})),o=Object(A.a)(s,2),u=o[0],d=o[1];Object(a.useEffect)((function(){d(qt(e,t,i))}),[e,i]);var j=Object(a.useCallback)((function(n){var a="function"===typeof n?n(qt(e,t,i)):n;"undefined"!==typeof window.localStorage&&(window.localStorage.setItem(e,l(a)),d(a))}),[e,t,l,i]),b=Object(a.useCallback)((function(){"undefined"!==typeof window.localStorage&&window.localStorage.removeItem(e),d(t)}),[e,t]);return[u,j,b]}("sendPing/editedPing",{text:"",addToCalendar:!1,calendarEntryTitle:"",calendarTime:{relative:F.a.duration(0).toISOString()},template:null}),u=Object(A.a)(o,3),d=u[0],j=u[1],b=u[2];Object(a.useEffect)((function(){var e;d.text.trim()===(null!==(e=d.template)&&void 0!==e?e:"").trim()&&j((function(e){return Object(ue.a)(Object(ue.a)({},e),{},{text:""})}))}),[s]);var h=function(e){if("absolute"in e)return{absolute:F()(e.absolute)};var t=e.relative.startsWith("-"),n=F.a.duration(e.relative).asMilliseconds(),a=t===n<0?1:-1;return{relative:F.a.duration(a*n)}}(d.calendarTime),O=function(e,t){return Object(a.useMemo)((function(){if(!e)return[];var n=[];return t.userName&&n.push({placeholder:"me",description:"the name of the character you are logged in with (".concat(t.userName,")")}),e.allowScheduling&&t.addToCalendar&&("string"===typeof t.calendarEntryTitle&&n.push({placeholder:"title",description:"the title of the calendar entry".concat(t.calendarEntryTitle&&" (".concat(t.calendarEntryTitle,")"))}),t.calendarTime&&n.push({placeholder:"time",description:Object(Be.jsxs)(Be.Fragment,{children:["a ",Object(Be.jsx)("a",{href:"https://time.nakamura-labs.com/",target:"_blank",rel:"noreferrer",children:"Nakamura time link"})," for the scheduled time and date (",Object(Be.jsx)(He,{time:ht(t.calendarTime),asLink:!0,format:"YYYY-MM-DD HH:mm"}),")"]})})),n}),[t.addToCalendar,t.calendarEntryTitle,t.calendarTime,t.userName,e])}(null!==s&&void 0!==s?s:null,Object(ue.a)(Object(ue.a)({},(null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.isLoggedIn)?{userName:i.data.character.name}:null),{},{addToCalendar:d.addToCalendar,calendarEntryTitle:d.calendarEntryTitle,calendarTime:h})),f="\n\n--- old text ---\n\n",p=d.text&&s&&d.template!==s.template?s.template+f+(null!==(n=d.text)&&void 0!==n?n:""):d.text||(null===s||void 0===s?void 0:s.template)||"",v=Object(a.useState)(null),x=Object(A.a)(v,2),y=x[0],w=x[1],C=s&&(p!==(null===y||void 0===y?void 0:y.text)||s.id!==y.templateId)&&p.trim()!==s.template.trim()&&""!==p.trim()&&-1===p.indexOf(f)&&(!s.allowScheduling||!d.addToCalendar||""!==(null!==(r=d.calendarEntryTitle.trim())&&void 0!==r?r:"")&&ht(h).isAfter(F()())),S=g(),T=Object(A.a)(S,2),k=T[0],E=T[1],P=Object(a.useState)(!1),M=Object(A.a)(P,2),L=M[0],I=M[1],G=Object(a.useState)(!1),R=Object(A.a)(G,2),D=R[0],B=R[1];return Object(a.useEffect)((function(){!L||D||E.isLoading||(B(!0),setTimeout((function(){I(!1),B(!1)}),2e3))}),[E.isLoading,E.isSuccess,D,L]),s?Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsxs)(lt.a.Group,{className:"mb-3 pe-0 ping",children:[!!s.allowScheduling&&Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"schedule",xs:12,className:"mb-3 pe-0",children:[Object(Be.jsx)(lt.a.Label,{children:"Ping Options"}),Object(Be.jsx)(lt.a.Check,{checked:d.addToCalendar,label:"This is a pre-ping (select for more options)",onChange:function(){j((function(e){return Object(ue.a)(Object(ue.a)({},e),{},{addToCalendar:!e.addToCalendar})}))}})]}),d.addToCalendar&&Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlid:"calendarTitle",xs:12,className:"mb-3 pe-0",children:[Object(Be.jsx)(lt.a.Label,{children:"Calendar Entry Title"}),Object(Be.jsx)(lt.a.Control,{value:d.calendarEntryTitle,onChange:function(e){j((function(t){return Object(ue.a)(Object(ue.a)({},t),{},{calendarEntryTitle:e.target.value})}))}})]}),Object(Be.jsxs)(Qe.a,{className:"me-0",children:[Object(Be.jsx)(_e.a,{xs:12,className:"pe-0",children:Object(Be.jsx)(lt.a.Label,{children:"Calendar Time"})}),Object(Be.jsx)(Jt,{time:h,onChange:function(e){j("absolute"in e?function(t){return Object(ue.a)(Object(ue.a)({},t),{},{calendarTime:{absolute:e.absolute.toISOString()}})}:function(t){return Object(ue.a)(Object(ue.a)({},t),{},{calendarTime:{relative:e.relative.toISOString()}})})}})]})]})]}),Object(Be.jsx)(Ht,{value:p,onChange:function(e){return j((function(t){var n;return Object(ue.a)(Object(ue.a)({},t),{},{text:e,template:null!==(n=null===s||void 0===s?void 0:s.template)&&void 0!==n?n:null})}))},placeholders:O})]}),Object(Be.jsxs)(_e.a,{xs:12,className:"d-flex pe-0",children:[Object(Be.jsx)(Fe.a,{variant:"warning",onClick:function(){return b()},children:"Reset Ping"}),Object(Be.jsx)("div",{style:{flexGrow:1}}),Object(Be.jsx)(Fe.a,{variant:"primary",disabled:!C,onClick:function(){if(s&&C){var e={text:p,templateId:s.id};s.allowScheduling&&d.addToCalendar&&(e.scheduledFor=ht(h).toISOString(),e.scheduledTitle=d.calendarEntryTitle),I(!0),k(e).then((function(t){"error"in t||(w({text:e.text,templateId:s.id}),j((function(e){return Object(ue.a)(Object(ue.a)({},e),{},{text:""})})))}))}},children:"Send Ping"})]}),Object(Be.jsx)(Je.a,{show:L,size:"sm",backdrop:"static",children:Object(Be.jsxs)(Je.a.Body,{className:"fs-5",children:[E.isLoading&&Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsx)(Yt.a,{animation:"border",role:"status",size:"sm",children:Object(Be.jsx)("span",{className:"visually-hidden",children:"Sending\u2026"})})," ","Sending\u2026"]}),!E.isLoading&&E.isError&&Object(Be.jsxs)("span",{className:"text-danger",children:[Object(Be.jsx)("i",{className:"bi-exclamation-circle"})," Failed to send ping"]}),!E.isLoading&&E.isSuccess&&Object(Be.jsxs)("span",{className:"text-success",children:[Object(Be.jsx)("i",{className:"bi-check-circle"})," Ping sent"]})]})})]}):c.isFetching?Object(Be.jsx)("div",{children:"Loading&ellip;"}):Object(Be.jsx)(Ae.a,{to:"../",replace:!0})}function _t(){return Object(Be.jsx)("div",{children:"Please select a group to ping!"})}var Kt=["ping"];function Wt(e){var t=e.ping,n=Object(d.a)(e,Kt);return Object(Be.jsxs)(Je.a,Object(ue.a)(Object(ue.a)({},n),{},{children:[Object(Be.jsx)(Je.a.Header,{closeButton:!0,children:Object(Be.jsxs)(Je.a.Title,{children:[Object(Be.jsx)("i",{className:"bi-broadcast-pin"})," ",(null===t||void 0===t?void 0:t.scheduledTitle)||"".concat(null===t||void 0===t?void 0:t.author," to ").concat(null===t||void 0===t?void 0:t.slackChannelName),Object(Be.jsxs)("h6",{className:"m-0",children:[(null===t||void 0===t?void 0:t.scheduledFor)&&"Scheduled/Pre-","Ping"]})]})}),Object(Be.jsx)(Je.a.Body,{children:t&&Object(Be.jsx)($e,{ping:t})})]}))}n(131);function Xt(){var e,t,n,r=m(),i=(null===(e=r.data)||void 0===e?void 0:e.isLoggedIn)&&(null===(t=r.data)||void 0===t?void 0:t.character.roles.includes(G.UserRoles.PING)),c=(null===(n=r.data)||void 0===n?void 0:n.isLoggedIn)&&r.data.character.roles.includes(G.UserRoles.PING_TEMPLATES_WRITE),l=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).skip,t=qe(),n=Ve(Te),r=Ve(Ee),i=Ve(ke),c=function(){return t(we())},l=function(){return t(ye())};return Object(a.useEffect)((function(){!0!==e&&t(ye())}),[t,e]),{pings:n,loading:r,hasMore:i,loadMore:c,reload:l}}({skip:r.isLoading||!i}),s=Object(a.useState)(!1),o=Object(A.a)(s,2),u=o[0],d=o[1],j=Object(a.useState)(null),b=Object(A.a)(j,2),h=b[0],O=b[1];return Object(Be.jsxs)(Re.a,{children:[Object(Be.jsxs)("div",{className:"sent-pings-header",children:[Object(Be.jsx)("h3",{children:"Sent Pings"}),Object(Be.jsxs)(Fe.a,{onClick:l.reload,disabled:l.loading,children:[Object(Be.jsx)("i",{className:"bi-arrow-clockwise"})," Reload"]}),Object(Be.jsx)("div",{style:{flex:1}}),Object(Be.jsxs)(Ie.b,{to:"..",className:"btn btn-primary",role:"button",children:[Object(Be.jsx)("i",{className:"bi-arrow-left"})," Back to Pings"]}),c&&Object(Be.jsxs)(Ie.b,{to:"../view-access",className:"btn btn-primary",role:"button",children:[Object(Be.jsx)("i",{className:"bi-wrench"})," Manage View Access"]})]}),Object(Be.jsxs)(Qe.a,{children:[Object(Be.jsx)(_e.a,{xs:12,children:Object(Be.jsx)(Bt.a,{variant:"info",className:"py-2",children:"These Pings were either sent by you, or were sent to channels you have view access to. View access is determined by your Neucore groups, not which Slack channels you are in."})}),Object(Be.jsxs)(_e.a,{xs:12,children:[Object(Be.jsxs)(Pt.a,{hover:!0,size:"sm",variant:"dark",responsive:!0,className:"sent-pings-table",children:[Object(Be.jsx)("thead",{children:Object(Be.jsxs)("tr",{children:[Object(Be.jsx)("th",{children:"Author"}),Object(Be.jsx)("th",{children:"Sent at"}),Object(Be.jsx)("th",{children:"Sent to"}),Object(Be.jsx)("th",{children:"Text"})]})}),Object(Be.jsxs)("tbody",{children:[l.pings.length<1&&Object(Be.jsx)("tr",{children:Object(Be.jsx)("td",{colSpan:4,children:"No Pings to show"})}),l.pings.map((function(e){return Object(Be.jsxs)("tr",{onClick:function(){return O(e),void d(!0)},children:[Object(Be.jsx)("td",{children:e.author}),Object(Be.jsx)("td",{children:Object(Be.jsx)(He,{time:e.sentAt,format:"YYYY-MM-DD HH:mm"})}),Object(Be.jsx)("td",{children:e.slackChannelName}),Object(Be.jsx)("td",{className:"text-cell",children:Object(Be.jsx)("div",{title:e.text,children:e.text})})]},e.id)}))]})]}),Object(Be.jsx)(Fe.a,{className:"w-100 mb-3",disabled:!l.hasMore||l.loading,onClick:l.loadMore,children:l.loading?"Loading\u2026":l.hasMore?"Load more":"(No more pings)"})]})]}),Object(Be.jsx)(Wt,{show:u,ping:h,onHide:function(){d(!1)},fullscreen:"sm-down"})]})}n(132);function Zt(e){var t,n,r,i,c,l,o=e.show,u=e.template,d=e.onSave,j=e.onCancel,b=e.onDelete,h=Object(a.useState)({name:"",slackChannelId:"",template:"",allowedNeucoreGroups:[],allowScheduling:!1}),m=Object(A.a)(h,2),O=m[0],f=m[1];Object(a.useEffect)((function(){return f(u?Object(ue.a)({},u):{name:"",slackChannelId:"",template:"",allowedNeucoreGroups:[],allowScheduling:!1})}),[u]);var p=O.name.length>0&&O.slackChannelId.length>0,v=y(),x=w(),g=(null!==(t=null===(n=x.data)||void 0===n?void 0:n.neucoreGroups)&&void 0!==t?t:[]).filter((function(e){return!O.allowedNeucoreGroups.includes(e.name)})),N="number"!==typeof(null===u||void 0===u?void 0:u.id),C=!N&&["Last edited by ".concat(null!==(r=null===u||void 0===u?void 0:u.updatedBy)&&void 0!==r?r:"unknown"),(null===u||void 0===u?void 0:u.updatedAt)?"at ".concat(F()(u.updatedAt).format("llll")," (").concat(F()(u.updatedAt).fromNow(),")"):"unknown"].join(" "),S=function(e,t){f((function(n){return Object(ue.a)(Object(ue.a)({},n),{},Object(s.a)({},e,t))}))},T=Object(a.useState)(!1),k=Object(A.a)(T,2),E=k[0],P=k[1];return Object(Be.jsxs)(Je.a,{show:o,size:"lg",backdrop:"static",children:[Object(Be.jsx)(Je.a.Header,{children:Object(Be.jsxs)(Je.a.Title,{children:[N?"Add":"Edit"," Ping Template"]})}),Object(Be.jsx)(Je.a.Body,{children:Object(Be.jsx)(lt.a,{children:Object(Be.jsxs)(Qe.a,{children:[C&&Object(Be.jsx)(_e.a,{xs:12,className:"mb-3",children:C}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"name",xs:12,sm:6,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{children:"Template Name"}),Object(Be.jsx)(lt.a.Control,{type:"text",value:O.name,onChange:function(e){return S("name",e.target.value)}})]}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"slackChannel",xs:12,sm:6,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{children:"Targeted Slack Channel"}),Object(Be.jsxs)(lt.a.Select,{value:O.slackChannelId,onChange:function(e){return f((function(t){return Object(ue.a)(Object(ue.a)({},t),{},{slackChannelId:e.target.value})}))},children:[v.isLoading&&Object(Be.jsx)("option",{value:"",children:"Loading\u2026"}),!v.isLoading&&((null!==(i=null===(c=v.data)||void 0===c?void 0:c.channels.length)&&void 0!==i?i:0)<1?Object(Be.jsx)("option",{value:"",children:"No valid target channels!"}):Object(Be.jsx)("option",{value:"",children:"(Please Select)"})),!v.isLoading&&(null===(l=v.data)||void 0===l?void 0:l.channels.map((function(e){return Object(Be.jsx)("option",{value:e.id,children:e.name},e.id)})))]})]}),Object(Be.jsx)(lt.a.Group,{as:_e.a,controlId:"allowScheduling",xs:12,className:"mb-3",children:Object(Be.jsx)(lt.a.Check,{checked:!!O.allowScheduling,onChange:function(){return S("allowScheduling",!O.allowScheduling)},label:Object(Be.jsxs)(Be.Fragment,{children:["Allow Showing the Ping in the Calendar",Object(Be.jsx)("span",{className:"d-block",style:{fontSize:"0.9rem"},children:"Only users with permissions to view pings sent to the target channel will be able to see them in the calendar."})]})})}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"addNeucoreGroup",xs:12,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{children:"Neucore Groups Allowed to Ping"}),Object(Be.jsxs)(Pt.a,{variant:"dark",children:[Object(Be.jsx)("thead",{children:Object(Be.jsxs)("tr",{children:[Object(Be.jsx)("th",{style:{width:"100%"},children:"Group"}),Object(Be.jsx)("th",{children:"Action"})]})}),Object(Be.jsxs)("tbody",{children:[0===O.allowedNeucoreGroups.length&&Object(Be.jsx)("tr",{children:Object(Be.jsx)("td",{colSpan:2,children:Object(Be.jsxs)(Bt.a,{variant:"warning",className:"mb-0 p-1",children:[Object(Be.jsx)("i",{className:"bi-exclamation-triangle"})," ","All users allowed to ping can use this template"]})})}),O.allowedNeucoreGroups.map((function(e){return Object(Be.jsxs)("tr",{children:[Object(Be.jsx)("td",{className:"align-middle",children:e}),Object(Be.jsx)("td",{children:Object(Be.jsxs)(Fe.a,{size:"sm",onClick:function(){return t=e,f((function(e){return Object(ue.a)(Object(ue.a)({},e),{},{allowedNeucoreGroups:e.allowedNeucoreGroups.filter((function(e){return e!==t}))})}));var t},className:"text-nowrap",children:[Object(Be.jsx)("i",{className:"bi-trash-fill"})," Remove"]})})]},e)})),x.isLoading&&Object(Be.jsx)("tr",{children:Object(Be.jsx)("td",{colSpan:2,children:"Loading\u2026"})}),!x.isLoading&&g.length<1&&O.allowedNeucoreGroups.length<1&&Object(Be.jsx)("tr",{children:Object(Be.jsx)("td",{colSpan:2,children:Object(Be.jsx)(Bt.a,{variant:"Error",children:"No Neucore groups configured!"})})}),g.length>0&&Object(Be.jsx)("tr",{children:Object(Be.jsx)("td",{colSpan:2,children:Object(Be.jsxs)(lt.a.Select,{value:"",onChange:function(e){return f((function(t){return Object(ue.a)(Object(ue.a)({},t),{},{allowedNeucoreGroups:[].concat(Object(L.a)(t.allowedNeucoreGroups),[e.target.value])})}))},children:[Object(Be.jsx)("option",{value:"",children:"(Select a group to add)"}),!x.isLoading&&g.map((function(e){return Object(Be.jsx)("option",{value:e.name,children:e.name},e.id)}))]})})})]})]})]}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"template",xs:12,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{children:"Template Text"}),Object(Be.jsx)(lt.a.Control,{as:"textarea",rows:10,value:O.template,onChange:function(e){return S("template",e.target.value)}})]})]})})}),Object(Be.jsxs)(Je.a.Footer,{className:"edit-ping-template-dialog-footer",children:[Object(Be.jsxs)("div",{className:Object(ze.a)("edit-ping-template-dialog-buttons-wrapper",E&&"hidden"),children:[!N&&Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsx)(Fe.a,{variant:"danger",disabled:E,onClick:function(){return P(!0)},children:"Delete"}),Object(Be.jsx)("div",{className:"edit-ping-template-dialog-buttons-spacer"})]}),Object(Be.jsx)(Fe.a,{variant:"secondary",onClick:j,disabled:E,children:"Cancel"}),Object(Be.jsx)(Fe.a,{variant:"primary",disabled:!p||E,onClick:function(){p&&d&&(d(O),f({name:"",slackChannelId:"",template:"",allowedNeucoreGroups:[],allowScheduling:!1}))},children:"Save"})]}),!N&&Object(Be.jsxs)("div",{className:Object(ze.a)("edit-ping-template-confirm-delete-buttons-wrapper",!E&&"hidden"),children:[Object(Be.jsx)(Fe.a,{disabled:!E,onClick:function(){return P(!1)},children:"No"}),Object(Be.jsx)("div",{className:"edit-ping-template-dialog-buttons-spacer",children:"Are you sure you want to delete this ping template?"}),Object(Be.jsx)(Fe.a,{variant:"danger",disabled:!E,onClick:function(){P(!1),null===b||void 0===b||b(),f({name:"",slackChannelId:"",template:"",allowedNeucoreGroups:[],allowScheduling:!1})},children:"Yes"})]})]})]})}n(133);function $t(){var e,t,n,i=N(),c=C(),l=Object(A.a)(c,1)[0],s=S(),o=Object(A.a)(s,1)[0],u=T(),d=Object(A.a)(u,1)[0],j=Object(a.useState)({template:null,show:!1}),b=Object(A.a)(j,2),h=b[0],m=b[1],O=function(){return m({template:null,show:!1})};return Object(Be.jsxs)(Re.a,{children:[Object(Be.jsxs)("div",{className:"templates-header",children:[Object(Be.jsx)("h3",{children:"Manage Ping Templates"}),Object(Be.jsx)("div",{style:{flex:1}}),Object(Be.jsxs)(Ie.b,{to:"..",className:"btn btn-primary",role:"button",children:[Object(Be.jsx)("i",{className:"bi-arrow-left"})," Back to Pings"]}),Object(Be.jsxs)(Fe.a,{onClick:function(){return m({template:null,show:!0})},children:[Object(Be.jsx)("i",{className:"bi-plus-lg"})," Add Ping Template"]})]}),Object(Be.jsxs)(Pt.a,{hover:!0,size:"sm",variant:"dark",responsive:!0,children:[Object(Be.jsx)("thead",{children:Object(Be.jsxs)("tr",{children:[Object(Be.jsx)("th",{children:"Name"}),Object(Be.jsx)("th",{children:"Targeted Channel"}),Object(Be.jsx)("th",{children:"Groups Allowed to Ping"}),Object(Be.jsx)("th",{children:"Calendar Support"}),Object(Be.jsx)("th",{children:"Template"}),Object(Be.jsx)("th",{children:"Action"})]})}),Object(Be.jsxs)("tbody",{children:[i.isFetching&&Object(Be.jsx)("tr",{children:Object(Be.jsx)("td",{colSpan:5,children:"Loading&elipsis;"})}),!i.isFetching&&(null!==(e=null===(t=i.data)||void 0===t?void 0:t.templates.length)&&void 0!==e?e:0)<1&&Object(Be.jsx)("tr",{children:Object(Be.jsx)("td",{colSpan:5,children:"No ping templates defined"})}),null===(n=i.data)||void 0===n?void 0:n.templates.map((function(e){return Object(Be.jsxs)("tr",{children:[Object(Be.jsx)("th",{scope:"row",children:e.name}),Object(Be.jsx)("td",{children:e.slackChannelName}),Object(Be.jsx)("td",{children:e.allowedNeucoreGroups.length<1?Object(Be.jsx)("i",{children:"(Everyone)"}):e.allowedNeucoreGroups.join(", ")}),Object(Be.jsx)("td",{children:e.allowScheduling?"Yes":"No"}),Object(Be.jsx)("td",{children:e.template.split("\n").map((function(e,t){return Object(Be.jsxs)(r.a.Fragment,{children:[e,Object(Be.jsx)("br",{})]},t)}))}),Object(Be.jsx)("td",{children:Object(Be.jsxs)(Fe.a,{size:"sm",onClick:function(){return m({template:e,show:!0})},children:[Object(Be.jsx)("i",{className:"bi-pencil"})," Edit"]})})]},e.id)}))]})]}),Object(Be.jsx)(Zt,{show:h.show,template:h.template,onCancel:O,onSave:function(e){h.template?o({id:h.template.id,template:e}):l(e),O()},onDelete:function(){var e=h.template;e&&(d(e.id),O())}})]})}n(134);var en=["neucoreGroup"];function tn(){var e,t,n,r,i,c,l,s=k(),o=Object(a.useMemo)((function(){var e,t;return(null!==(e=null===(t=s.data)||void 0===t?void 0:t.viewPermissions)&&void 0!==e?e:[]).reduce((function(e,t){var n,a=t.neucoreGroup,r=Object(d.a)(t,en);return e.set(a,[].concat(Object(L.a)(null!==(n=e.get(a))&&void 0!==n?n:[]),[r]).sort((function(e,t){return e.slackChannelName.localeCompare(t.slackChannelName)})))}),new Map)}),[null===(e=s.data)||void 0===e?void 0:e.viewPermissions]),u=Object(a.useState)(null),j=Object(A.a)(u,2),b=j[0],h=j[1],m=[].concat(Object(L.a)(o.keys()),Object(L.a)(b&&!o.has(b)?[b]:[])).sort(),O=w(),f=(null!==(t=null===(n=O.data)||void 0===n?void 0:n.neucoreGroups)&&void 0!==t?t:[]).filter((function(e){return!o.has(e.name)&&e.name!==b})).map((function(e){return e.name})),p=y(),v=(null!==(r=null===(i=p.data)||void 0===i?void 0:i.channels)&&void 0!==r?r:[]).filter((function(e){return(b&&o.get(b)||[]).every((function(t){return t.slackChannelName!==e.name}))})),x=E(),g=Object(A.a)(x,2),N=g[0],C=g[1],S=s.isFetching||O.isFetching||p.isFetching||C.isLoading;return Object(Be.jsxs)(Re.a,{children:[Object(Be.jsxs)("div",{className:"view-access-header",children:[Object(Be.jsx)("h3",{children:"Manage Ping View Access"}),Object(Be.jsx)("div",{style:{flex:1}}),Object(Be.jsxs)(Ie.b,{to:"../sent",className:"btn btn-primary",role:"button",children:[Object(Be.jsx)("i",{className:"bi-arrow-left"})," Back to Sent Pings"]})]}),Object(Be.jsxs)(Qe.a,{children:[Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"neucoreGroup",xs:12,md:4,className:"mb-3",children:[Object(Be.jsx)(lt.a.Label,{children:"Neucore Group"}),m.length<1&&(S?Object(Be.jsx)(Bt.a,{variant:"info",className:"mb-2 py-2",children:"Loading\u2026"}):Object(Be.jsx)(Bt.a,{variant:"warning",className:"mb-2 py-2",children:"No view permissions defined."})),m.length>0&&Object(Be.jsx)(pt.a,{className:"mb-2",children:m.map((function(e){return Object(Be.jsx)(pt.a.Item,{type:"button",action:!0,active:e===b,onClick:function(){return h(e)},disabled:S,children:e},e)}))}),Object(Be.jsxs)(lt.a.Select,{value:null!==b&&void 0!==b?b:"",onChange:function(e){h(e.target.value||null)},disabled:S||f.length<1,children:[S&&Object(Be.jsx)("option",{value:"",children:"Loading\u2026"}),!S&&(f.length>0?Object(Be.jsx)("option",{value:"",children:"(Select a group to add)"}):Object(Be.jsx)("option",{value:"",children:"No more groups to add"})),!S&&f.map((function(e){return Object(Be.jsx)("option",{value:e,children:e},e)}))]})]}),Object(Be.jsxs)(lt.a.Group,{as:_e.a,controlId:"slackGroups",xs:12,md:8,children:[Object(Be.jsx)(lt.a.Label,{children:"Can see pings sent to"}),Object(Be.jsxs)(Pt.a,{variant:"dark",children:[Object(Be.jsx)("thead",{children:Object(Be.jsxs)("tr",{children:[Object(Be.jsx)("th",{className:"w-100",children:"Slack Channel"}),Object(Be.jsx)("th",{children:"Action"})]})}),Object(Be.jsxs)("tbody",{children:[!b&&Object(Be.jsx)("tr",{children:Object(Be.jsx)("td",{colSpan:2,children:"(Please select a group to manage first)"})}),b&&Object(Be.jsxs)(Be.Fragment,{children:[!(null===(c=o.get(b))||void 0===c?void 0:c.length)&&Object(Be.jsx)("tr",{children:Object(Be.jsx)("td",{colSpan:2,children:Object(Be.jsxs)(Bt.a,{variant:"info",className:"mb-0 py-2",children:["Members of this group cannot view any"," ","pings other than those they sent themselves."]})})}),null===(l=o.get(b))||void 0===l?void 0:l.map((function(e){return Object(Be.jsxs)("tr",{children:[Object(Be.jsx)("td",{className:"align-middle",children:e.slackChannelName}),Object(Be.jsx)("td",{children:Object(Be.jsxs)(Fe.a,{size:"sm",className:"text-nowrap",onClick:function(){return function(e){var t;b&&N({neucoreGroup:b,allowedSlackChannelIds:(null!==(t=o.get(b))&&void 0!==t?t:[]).map((function(e){return e.slackChannelId})).filter((function(t){return t!==e}))})}(e.slackChannelId)},disabled:S,children:[Object(Be.jsx)("i",{className:"bi-trash-fill"})," Remove"]})})]},e.slackChannelId)})),v.length>0&&Object(Be.jsx)("tr",{children:Object(Be.jsx)("td",{colSpan:2,children:Object(Be.jsxs)(lt.a.Select,{value:"",onChange:function(e){var t;b&&N({neucoreGroup:b,allowedSlackChannelIds:[].concat(Object(L.a)((null!==(t=o.get(b))&&void 0!==t?t:[]).map((function(e){return e.slackChannelId}))),[e.target.value])})},disabled:S,children:[Object(Be.jsx)("option",{value:"",children:"(Select a channel to add)"}),!S&&v.map((function(e){return Object(Be.jsx)("option",{value:e.id,children:e.name},e.id)}))]})})})]})]})]})]})]})]})}n(135),n(136),n(137);function nn(){var e=Object(Ae.g)().pathname;return Object(Be.jsx)(Ae.a,{to:"/login?postLoginRedirect=".concat(e)})}function an(){var e,t=m(),n=(null===(e=t.data)||void 0===e?void 0:e.isLoggedIn)&&t.data.character.roles||[];function a(e,a){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(Be.jsx)(r.a.Fragment,{});if(t.isLoading)return Object(Be.jsx)(r.a.Fragment,{});var c=e.every((function(e){return n.includes(e)}));return c?a:"string"===typeof i?Object(Be.jsx)(nn,{}):i}return Object(Be.jsx)(Ie.a,{children:Object(Be.jsx)(Ae.e,{children:Object(Be.jsxs)(Ae.c,{path:"/",element:Object(Be.jsx)(rn,{}),children:[Object(Be.jsx)(Ae.c,{path:"",element:Object(Be.jsx)(Ae.a,{to:"calendar",replace:!0})}),Object(Be.jsx)(Ae.c,{path:"calendar",element:a([G.UserRoles.EVENTS_READ,G.UserRoles.PING],Object(Be.jsx)(ct,{}),"/calendar")}),Object(Be.jsx)(Ae.c,{path:"timers",element:a([G.UserRoles.EVENTS_READ],Object(Be.jsx)(Lt,{}),"/timers")}),Object(Be.jsxs)(Ae.c,{path:"pings",element:a([G.UserRoles.PING],Object(Be.jsx)(Dt,{}),"/pings"),children:[Object(Be.jsx)(Ae.c,{path:"",element:Object(Be.jsx)(Ft,{})}),Object(Be.jsxs)(Ae.c,{path:"send",element:Object(Be.jsx)(Ut,{}),children:[Object(Be.jsx)(Ae.c,{path:"",element:Object(Be.jsx)(_t,{})}),Object(Be.jsx)(Ae.c,{path:":templateId",element:Object(Be.jsx)(Qt,{})})]}),Object(Be.jsx)(Ae.c,{path:"sent",element:Object(Be.jsx)(Xt,{})}),a([G.UserRoles.PING_TEMPLATES_WRITE],Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsx)(Ae.c,{path:"templates",element:Object(Be.jsx)($t,{})}),Object(Be.jsx)(Ae.c,{path:"view-access",element:Object(Be.jsx)(tn,{})})]}))]}),Object(Be.jsx)(Ae.c,{path:"login",element:Object(Be.jsx)(Rt,{})})]})})})}function rn(){return Object(Be.jsxs)("div",{className:"app-wrapper",children:[Object(Be.jsx)("header",{children:Object(Be.jsx)(Ue,{pages:[{title:"Calendar",href:"/calendar"},{title:"Timers",href:"/timers"},{title:"Pings",href:"/pings"}]})}),Object(Be.jsx)("main",{className:"main",children:Object(Be.jsx)(Ae.b,{})}),Object(Be.jsx)("footer",{children:Object(Be.jsx)(Ye,{})})]})}n(138),n(139);c.a.render(Object(Be.jsx)(r.a.StrictMode,{children:Object(Be.jsx)(l.Provider,{store:Le,children:Object(Be.jsx)(an,{})})}),document.getElementById("root"))},17:function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(108),t),r(n(116),t),r(n(117),t)}},[[140,1,2]]]);
//# sourceMappingURL=main.dd306270.chunk.js.map