{"version":3,"sources":["../../../../src/api/ping.ts","../../../src/user-roles.ts","store/api.ts","utils/dayjs.ts","store/calendar-slice.ts","store/events-list-slice.ts","store/pings-list-slice.ts","store/index.ts","components/app-nav.tsx","hooks/redux.ts","components/time.tsx","components/constellation-link.tsx","components/region-link.tsx","components/relative-time.tsx","components/slack-message.tsx","components/solar-system-link.tsx","pages/calendar/calendar-entry-dialog.tsx","pages/calendar/calendar.tsx","pages/calendar/calendar-page.tsx","brave-logo.svg","pages/login/login.tsx","pages/login/eve-sso-login-black-large.png","pages/pings/edit-ping-template-dialog.tsx","pages/pings/manage-ping-templates.tsx","components/date-time-input.tsx","components/relative-time-input.tsx","hooks/use-absolute-relative-time-input.ts","pages/pings/send-pings.tsx","pages/pings/sent-pings.tsx","pages/pings/use-pings-list.ts","pages/pings/manage-view-access.tsx","pages/pings/pings.tsx","pages/timers/edit-event-dialog.tsx","pages/timers/events-table.tsx","pages/timers/timers.tsx","pages/timers/use-events-list.ts","components/app-footer.tsx","app.tsx","index.tsx","../../../src/index.ts","../../../../src/api/index.ts"],"names":["apiSlice","createApi","reducerPath","baseQuery","fetchBaseQuery","baseUrl","credentials","tagTypes","endpoints","builder","getUser","query","providesTags","logOut","mutation","url","method","invalidatesTags","getEvents","params","result","events","length","map","type","id","addEvent","event","body","updateEvent","deleteEvent","_","arg","getPings","undefined","pings","addPing","ping","getPingChannels","channels","getAvailableNeucoreGroups","neucoreGroups","getPingTemplates","templates","addPingTemplate","template","updatePingTemplate","deletePingTemplate","getPingViewPermissions","updatePingViewPermissionsByNeucoreGroup","neucoreGroup","useGetUserQuery","useLogOutMutation","useAddEventMutation","useGetEventsQuery","useUpdateEventMutation","useDeleteEventMutation","useAddPingMutation","useGetPingsQuery","useGetPingChannelsQuery","useGetAvailableNeucoreGroupsQuery","useGetPingTemplatesQuery","useAddPingTemplateMutation","useUpdatePingTemplateMutation","useDeletePingTemplateMutation","useGetPingViewPermissionsQuery","useUpdatePingViewPermissionsByNeucoreGroupMutation","dayjs","extend","duration","localeData","localizedFormat","relativeTime","utc","weekOfYear","locales","af","am","ar","az","be","bg","bi","bm","bn","bo","br","bs","ca","cs","cv","cy","da","de","dv","el","en","eo","es","et","eu","fa","fi","fo","fr","fy","ga","gd","gl","gu","he","hi","hr","ht","hu","is","it","ja","jv","ka","kk","km","kn","ko","ku","ky","lb","lo","lt","lv","me","mi","mk","ml","mn","mr","ms","mt","my","nb","ne","nl","nn","pl","pt","ro","ru","rw","sd","se","si","sk","sl","sq","sr","ss","sv","sw","ta","te","tet","tg","th","tk","tlh","tr","tzl","tzm","uk","ur","uz","vi","yo","zh","localeChangeListeners","Set","a","success","navigator","languages","language","locale","toLowerCase","console","log","forEach","l","warn","loadLocale","then","initialCalendarState","loadingMonths","loadedMonths","dayjsFromYearAndMonth","date","year","month","getMonthKey","format","getDisplayedMonthRange","mod","firstOfMonth","startOfMonthPadding","day","firstDayOfWeek","from","subtract","days","displayedWeeks","Math","ceil","daysInMonth","to","add","weeks","loadMonth","createAsyncThunk","args","loadAll","getLatestTimestamp","getValues","data","hasMore","urlParams","URLSearchParams","after","toISOString","before","fetch","toString","response","status","json","responseData","values","Promise","all","time","remaining","scheduledFor","cached","condition","getState","monthKey","calendar","includes","calendarSlice","createSlice","name","initialState","reducers","clearCalendarEntries","state","extraReducers","addCase","pending","action","push","meta","rejected","filter","m","fulfilled","payload","Map","e","baseEntry","calendarEntryFromEvent","p","calendarEntryFromPing","addMatcher","matchFulfilled","updated","eventId","originalArgs","isScheduledPing","color","priority","title","standing","charAt","toUpperCase","substr","structure","system","join","dateTime","scheduledTitle","selectCalendarEvents","actions","initialEventsListState","loading","hasMoreEvents","reloadEvents","dispatch","clearEvents","loadMoreEvents","selectEvents","count","request","r","eventsList","sortEvents","sort","b","Date","parse","eventsListSlice","eventsReceived","selectHasMoreEvents","selectIsLoadingEvents","initialPingsListState","reloadPings","clearPings","loadMorePings","selectPings","sentAt","pingsList","sortPings","pingsListSlice","pingsReceived","selectHasMorePings","selectIsLoadingPings","store","configureStore","reducer","middleware","getDefaultMiddleware","concat","setupListeners","AppNav","props","history","useHistory","navigateTo","href","preventDefault","user","pollingInterval","logout","isLoggingOut","isLoading","isFetching","Navbar","variant","expand","Container","fluid","Brand","Toggle","Collapse","className","Nav","pages","page","Link","onClick","Text","isLoggedIn","character","Button","useAppDispatch","useDispatch","useAppSelector","useSelector","Time","asLink","t","nakamuraLink","unix","target","rel","stopPropagation","ConstellationLink","link","region","constellation","RegionLink","RelativeTime","useState","fromNow","relative","setRelative","useEffect","interval","setInterval","clearInterval","slackFormatters","regex","onMatch","match","split","indexOf","substring","SlackMessage","text","fragments","reduce","flatMap","fragment","replacements","replace","slice","f","i","Fragment","SolarSystemLink","CalendarEntryDialog","entry","modalProps","Modal","Header","closeButton","Title","Body","CalendarEntryEventBody","CalendarEntryPingBody","Row","Col","xs","notes","line","slackChannelName","author","Calendar","showEntryDialog","setShowEntryDialog","selectedEntry","setSelectedEntry","Array","week","start","valueOf","end","isToday","setLocale","delete","useDayjsLocale","clsx","style","width","background","j","flexBasis","show","onHide","fullscreen","CalendarPage","canRead","roles","UserRoles","EVENTS_READ","PING","currentMonth","setCurrentMonth","useRouteMatch","size","months","LoginPage","location","useLocation","postLoginRedirect","search","get","loginUrl","flex","justifyContent","sm","src","alt","logo","EditPingTemplateDialog","onSave","onCancel","onDelete","slackChannelId","allowedNeucoreGroups","allowScheduling","editedTemplate","setEditedTemplate","canSave","remainingNeucoreGroups","g","isNewTemplate","lastEdited","updatedBy","updatedAt","setTemplateField","field","value","isDeletePending","setIsDeletePending","backdrop","Form","Group","as","controlId","Label","Control","onChange","Select","c","Check","checked","label","fontSize","Table","colSpan","Alert","groupName","rows","Footer","disabled","ManagePingTemplates","pingTemplates","addTemplate","updateTemplate","deleteTemplate","templateDialogState","setTemplateDialogState","cancelEdit","pingsUrl","role","hover","responsive","scope","DateTimeInput","rowProps","dateFormat","timeFormat","timeBaseDate","dateInputText","setDateInputText","timeInputText","setTimeInputText","propDateTime","inputDateTime","isSame","parseDateTime","d","diff","handleBlur","isValid","pattern","onBlur","maxLength","defaultDurationComponents","unit","dur","asDays","RelativeTimeInput","durationComponents","durationFromTexts","texts","Object","fromEntries","parseInt","isFinite","textsFromDuration","asMilliseconds","inputTexts","setInputTexts","inputDuration","propDuration","some","handleInputTextChange","index","newTexts","useAbsoluteRelativeTimeInput","initialTime","setTime","handleChangeInputMode","useCallback","mode","absolute","handleAbsoluteDateChange","handleRelativeDateChange","calculateTimes","times","setTimes","updateTimes","inputMode","absoluteTime","SendPings","postPing","postPingState","addPingToCalendar","setAddPingToCalendar","timeInput","calendarEntryTitle","setCalendarEntryTitle","selectedTemplate","setSelectedTemplate","pingText","setPingText","pingTextModified","setPingTextModified","oldTextSeparator","showSendingDialog","setShowSendingDialog","sendDialogClosing","setSendDialogClosing","setTimeout","isSuccess","canSend","when","message","md","ListGroup","Item","active","currentText","oldText","handlePingGroupChange","controlid","lg","inline","placeholder","templateId","Spinner","animation","isError","SentPings","canEdit","PING_TEMPLATES_WRITE","skip","loadMore","reload","usePingsList","ManagePingViewAccess","sentPingsUrl","viewPermissionsQuery","viewPermissions","useMemo","byGroup","rest","set","localeCompare","selectedGroup","setSelectedGroup","selectableGroups","keys","has","allGroups","remainingGroups","remainingChannels","every","cc","setGroupChannels","setGroupChannelsState","channelId","allowedSlackChannelIds","handleRemoveChannel","PingsPage","path","exact","priorities","structureTypes","eventTypes","standings","EditEventDialog","editedEvent","setEditedEvent","entries","k","v","isNewEvent","usesAbsoluteTime","setEventField","handleSelectValueChange","dialogClassName","prio","EventsTable","showResultColumn","onEdit","getRowClass","now","abs","TimersPage","EVENTS_WRITE","useEventsList","addEventState","updateEventState","deleteEventState","saveState","setSaveState","isSaving","error","eventDialogState","setEventDialogState","AppFooter","App","component","navPages","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.6973d8ec.chunk.js","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isScheduledPing = void 0;\nfunction isScheduledPing(ping) {\n    return typeof ping.scheduledFor === 'string' && typeof ping.scheduledTitle === 'string';\n}\nexports.isScheduledPing = isScheduledPing;\n//# sourceMappingURL=ping.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.UserRoles = void 0;\nvar UserRoles;\n(function (UserRoles) {\n    UserRoles[\"EVENTS_READ\"] = \"events.read\";\n    UserRoles[\"EVENTS_WRITE\"] = \"events.write\";\n    UserRoles[\"PING\"] = \"ping\";\n    UserRoles[\"PING_TEMPLATES_WRITE\"] = \"ping.templates.write\";\n})(UserRoles = exports.UserRoles || (exports.UserRoles = {}));\n//# sourceMappingURL=user-roles.js.map","import {\n  ApiEventEntry,\n  ApiEventEntryInput,\n  ApiEventsResponse,\n  ApiMeResponse,\n  ApiNeucoreGroupsResponse,\n  ApiPing,\n  ApiPingInput,\n  ApiPingsResponse,\n  ApiPingTemplate,\n  ApiPingTemplateInput,\n  ApiPingTemplatesResponse,\n  ApiPingViewPermissions,\n  ApiPingViewPermissionsByGroupInput,\n  ApiSlackChannelsResponse,\n} from '@ping-board/common'\nimport { createApi, fetchBaseQuery } from '@reduxjs/toolkit/dist/query/react'\n\nexport const apiSlice = createApi({\n  reducerPath: 'loginApi',\n  baseQuery: fetchBaseQuery({ baseUrl: '/', credentials: 'same-origin' }),\n  tagTypes: [\n    'User',\n    'Event',\n    'Ping',\n    'PingTemplate',\n    'PingChannel',\n    'NeucoreGroup',\n    'PingViewPermission',\n  ],\n  endpoints: builder => ({\n    /* User Management */\n    getUser: builder.query<ApiMeResponse, void>({\n      query: () => 'api/me',\n      providesTags: ['User'],\n    }),\n    logOut: builder.mutation<void, void>({\n      query: () => ({ url: 'auth/logout', method: 'POST' }),\n      invalidatesTags: ['User', 'Event'],\n    }),\n\n    /* Events */\n    getEvents: builder.query<ApiEventsResponse, GetEventsOptions>({\n      query: params => ({ url: 'api/events', params }),\n      providesTags: (result) => result && result.events.length > 0\n        ? result.events.map(({ id }) => ({ type: 'Event', id }))\n        : ['Event'],\n    }),\n    addEvent: builder.mutation<ApiEventEntry, ApiEventEntryInput>({\n      query: event => ({ url: 'api/events', method: 'POST', body: event }),\n      invalidatesTags: ['Event'],\n    }),\n    updateEvent: builder.mutation<ApiEventEntry, { id: number, event: ApiEventEntryInput }>({\n      query: ({ id, event }) => ({ url: `api/events/${id}`, method: 'PUT', body: event }),\n      invalidatesTags: ['Event'],\n    }),\n    deleteEvent: builder.mutation<void, number>({\n      query: id => ({ url: `api/events/${id}`, method: 'DELETE' }),\n      invalidatesTags: (result, _, arg) => result ? [{ type: 'Event', id: arg }] : ['Event'],\n    }),\n\n    /* Pings */\n    getPings: builder.query<ApiPingsResponse, { before?: string } | void>({\n      query: params => ({ url: 'api/pings', params: params || undefined }),\n      providesTags: result => result && result.pings.length > 0\n        ? result.pings.map(({ id }) => ({ type: 'Ping', id }))\n        : ['Ping'],\n    }),\n    addPing: builder.mutation<ApiPing, ApiPingInput>({\n      query: ping => ({ url: 'api/pings', method: 'POST', body: ping }),\n      invalidatesTags: result => result ? [({ type: 'Ping', id: result.id })] : ['Ping'],\n    }),\n    getPingChannels: builder.query<ApiSlackChannelsResponse, void>({\n      query: () => ({ url: 'api/pings/channels' }),\n      providesTags: result => result && result.channels.length > 0\n        ? result.channels.map(({ id }) => ({ type: 'PingChannel', id }))\n        : ['PingChannel'],\n    }),\n    getAvailableNeucoreGroups: builder.query<ApiNeucoreGroupsResponse, void>({\n      query: () => ({ url: 'api/pings/neucore-groups' }),\n      providesTags: result => result && result.neucoreGroups.length > 0\n        ? result.neucoreGroups.map(({ id }) => ({ type: 'NeucoreGroup', id }))\n        : ['NeucoreGroup'],\n    }),\n    getPingTemplates: builder.query<ApiPingTemplatesResponse, void>({\n      query: () => ({ url: 'api/pings/templates' }),\n      providesTags: (result) => result && result.templates.length > 0\n        ? result.templates.map(({ id }) => ({ type: 'PingTemplate', id }))\n        : ['PingTemplate'],\n    }),\n    addPingTemplate: builder.mutation<ApiPingTemplate, ApiPingTemplateInput>({\n      query: template => ({ url: 'api/pings/templates', method: 'POST', body: template }),\n      invalidatesTags: ['PingTemplate'],\n    }),\n    updatePingTemplate: builder\n      .mutation<ApiPingTemplate, { id: number, template: ApiPingTemplateInput }>({\n        query: ({ id, template }) => ({\n          url: `api/pings/templates/${id}`,\n          method: 'PUT',\n          body: template,\n        }),\n        invalidatesTags: result =>\n          result ? [{ type: 'PingTemplate', id: result.id }] : ['PingTemplate'],\n    }),\n    deletePingTemplate: builder.mutation<void, number>({\n      query: id => ({ url: `api/pings/templates/${id}`, method: 'DELETE' }),\n      invalidatesTags: (result, _, arg) =>\n        result ? [{ type: 'PingTemplate', id: arg }] : ['PingTemplate'],\n    }),\n    getPingViewPermissions: builder.query<ApiPingViewPermissions, void>({\n      query: () => ({ url: 'api/pings/view-permissions' }),\n      providesTags: ['PingViewPermission'],\n    }),\n    updatePingViewPermissionsByNeucoreGroup: builder.mutation<\n      ApiPingViewPermissions,\n      ApiPingViewPermissionsByGroupInput & { neucoreGroup: string }\n    >({\n      query: ({ neucoreGroup, ...body }) => ({\n        url: `api/pings/view-permissions/groups/${neucoreGroup}`,\n        method: 'PUT',\n        body,\n      }),\n      invalidatesTags: ['PingViewPermission', 'Ping'],\n    }),\n  }),\n})\n\nexport interface GetEventsOptions {\n  before?: string\n  after?: string\n  count?: number\n}\n\nexport const {\n  useGetUserQuery,\n  useLogOutMutation,\n\n  useGetEventsQuery,\n  useAddEventMutation,\n  useUpdateEventMutation,\n  useDeleteEventMutation,\n\n  useGetPingsQuery,\n  useAddPingMutation,\n  useGetPingChannelsQuery,\n  useGetAvailableNeucoreGroupsQuery,\n  useGetPingTemplatesQuery,\n  useAddPingTemplateMutation,\n  useUpdatePingTemplateMutation,\n  useDeletePingTemplateMutation,\n  useGetPingViewPermissionsQuery,\n  useUpdatePingViewPermissionsByNeucoreGroupMutation,\n} = apiSlice\n","import dayjs from 'dayjs'\n\nimport duration from 'dayjs/plugin/duration'\nimport localeData from 'dayjs/plugin/localeData'\nimport localizedFormat from 'dayjs/plugin/localizedFormat'\nimport relativeTime from 'dayjs/plugin/relativeTime'\nimport utc from 'dayjs/plugin/utc'\nimport weekOfYear from 'dayjs/plugin/weekOfYear'\nimport { useEffect, useState } from 'react'\ndayjs.extend(duration)\ndayjs.extend(localeData)\ndayjs.extend(localizedFormat)\ndayjs.extend(relativeTime)\ndayjs.extend(utc)\ndayjs.extend(weekOfYear)\n\n//#region locales\n\nconst locales = {\n  af: () => import('dayjs/locale/af'),\n  am: () => import('dayjs/locale/am'),\n  'ar-dz': () => import('dayjs/locale/ar-dz'),\n  // 'ar-iq': () => import('dayjs/locale/ar-iq'), // compilation fails when enabling this\n  'ar-kw': () => import('dayjs/locale/ar-kw'),\n  'ar-ly': () => import('dayjs/locale/ar-ly'),\n  'ar-ma': () => import('dayjs/locale/ar-ma'),\n  'ar-sa': () => import('dayjs/locale/ar-sa'),\n  'ar-tn': () => import('dayjs/locale/ar-tn'),\n  ar: () => import('dayjs/locale/ar'),\n  az: () => import('dayjs/locale/az'),\n  be: () => import('dayjs/locale/be'),\n  bg: () => import('dayjs/locale/bg'),\n  bi: () => import('dayjs/locale/bi'),\n  bm: () => import('dayjs/locale/bm'),\n  bn: () => import('dayjs/locale/bn'),\n  bo: () => import('dayjs/locale/bo'),\n  br: () => import('dayjs/locale/br'),\n  bs: () => import('dayjs/locale/bs'),\n  ca: () => import('dayjs/locale/ca'),\n  cs: () => import('dayjs/locale/cs'),\n  cv: () => import('dayjs/locale/cv'),\n  cy: () => import('dayjs/locale/cy'),\n  da: () => import('dayjs/locale/da'),\n  'de-at': () => import('dayjs/locale/de-at'),\n  'de-ch': () => import('dayjs/locale/de-ch'),\n  de: () => import('dayjs/locale/de'),\n  dv: () => import('dayjs/locale/dv'),\n  el: () => import('dayjs/locale/el'),\n  'en-au': () => import('dayjs/locale/en-au'),\n  'en-ca': () => import('dayjs/locale/en-ca'),\n  'en-gb': () => import('dayjs/locale/en-gb'),\n  'en-ie': () => import('dayjs/locale/en-ie'),\n  'en-il': () => import('dayjs/locale/en-il'),\n  'en-in': () => import('dayjs/locale/en-in'),\n  'en-nz': () => import('dayjs/locale/en-nz'),\n  'en-sg': () => import('dayjs/locale/en-sg'),\n  'en-tt': () => import('dayjs/locale/en-tt'),\n  en: () => import('dayjs/locale/en'),\n  eo: () => import('dayjs/locale/eo'),\n  'es-do': () => import('dayjs/locale/es-do'),\n  // 'es-mx': () => import('dayjs/locale/es-mx'), // compilation fails when enabling this\n  'es-pr': () => import('dayjs/locale/es-pr'),\n  'es-us': () => import('dayjs/locale/es-us'),\n  es: () => import('dayjs/locale/es'),\n  et: () => import('dayjs/locale/et'),\n  eu: () => import('dayjs/locale/eu'),\n  fa: () => import('dayjs/locale/fa'),\n  fi: () => import('dayjs/locale/fi'),\n  fo: () => import('dayjs/locale/fo'),\n  'fr-ca': () => import('dayjs/locale/fr-ca'),\n  'fr-ch': () => import('dayjs/locale/fr-ch'),\n  fr: () => import('dayjs/locale/fr'),\n  fy: () => import('dayjs/locale/fy'),\n  ga: () => import('dayjs/locale/ga'),\n  gd: () => import('dayjs/locale/gd'),\n  gl: () => import('dayjs/locale/gl'),\n  'gom-latn': () => import('dayjs/locale/gom-latn'),\n  gu: () => import('dayjs/locale/gu'),\n  he: () => import('dayjs/locale/he'),\n  hi: () => import('dayjs/locale/hi'),\n  hr: () => import('dayjs/locale/hr'),\n  ht: () => import('dayjs/locale/ht'),\n  hu: () => import('dayjs/locale/hu'),\n  'hy-am': () => import('dayjs/locale/hy-am'),\n  id: () => import('dayjs/locale/id'),\n  is: () => import('dayjs/locale/is'),\n  'it-ch': () => import('dayjs/locale/it-ch'),\n  it: () => import('dayjs/locale/it'),\n  ja: () => import('dayjs/locale/ja'),\n  jv: () => import('dayjs/locale/jv'),\n  ka: () => import('dayjs/locale/ka'),\n  kk: () => import('dayjs/locale/kk'),\n  km: () => import('dayjs/locale/km'),\n  kn: () => import('dayjs/locale/kn'),\n  ko: () => import('dayjs/locale/ko'),\n  ku: () => import('dayjs/locale/ku'),\n  ky: () => import('dayjs/locale/ky'),\n  lb: () => import('dayjs/locale/lb'),\n  lo: () => import('dayjs/locale/lo'),\n  lt: () => import('dayjs/locale/lt'),\n  lv: () => import('dayjs/locale/lv'),\n  me: () => import('dayjs/locale/me'),\n  mi: () => import('dayjs/locale/mi'),\n  mk: () => import('dayjs/locale/mk'),\n  ml: () => import('dayjs/locale/ml'),\n  mn: () => import('dayjs/locale/mn'),\n  mr: () => import('dayjs/locale/mr'),\n  'ms-my': () => import('dayjs/locale/ms-my'),\n  ms: () => import('dayjs/locale/ms'),\n  mt: () => import('dayjs/locale/mt'),\n  my: () => import('dayjs/locale/my'),\n  nb: () => import('dayjs/locale/nb'),\n  ne: () => import('dayjs/locale/ne'),\n  'nl-be': () => import('dayjs/locale/nl-be'),\n  nl: () => import('dayjs/locale/nl'),\n  nn: () => import('dayjs/locale/nn'),\n  'oc-lnc': () => import('dayjs/locale/oc-lnc'),\n  'pa-in': () => import('dayjs/locale/pa-in'),\n  pl: () => import('dayjs/locale/pl'),\n  'pt-br': () => import('dayjs/locale/pt-br'),\n  pt: () => import('dayjs/locale/pt'),\n  ro: () => import('dayjs/locale/ro'),\n  ru: () => import('dayjs/locale/ru'),\n  rw: () => import('dayjs/locale/rw'),\n  sd: () => import('dayjs/locale/sd'),\n  se: () => import('dayjs/locale/se'),\n  si: () => import('dayjs/locale/si'),\n  sk: () => import('dayjs/locale/sk'),\n  sl: () => import('dayjs/locale/sl'),\n  sq: () => import('dayjs/locale/sq'),\n  'sr-cyrl': () => import('dayjs/locale/sr-cyrl'),\n  sr: () => import('dayjs/locale/sr'),\n  ss: () => import('dayjs/locale/ss'),\n  'sv-fi': () => import('dayjs/locale/sv-fi'),\n  sv: () => import('dayjs/locale/sv'),\n  sw: () => import('dayjs/locale/sw'),\n  ta: () => import('dayjs/locale/ta'),\n  te: () => import('dayjs/locale/te'),\n  tet: () => import('dayjs/locale/tet'),\n  tg: () => import('dayjs/locale/tg'),\n  th: () => import('dayjs/locale/th'),\n  tk: () => import('dayjs/locale/tk'),\n  'tl-ph': () => import('dayjs/locale/tl-ph'),\n  tlh: () => import('dayjs/locale/tlh'),\n  tr: () => import('dayjs/locale/tr'),\n  tzl: () => import('dayjs/locale/tzl'),\n  'tzm-latn': () => import('dayjs/locale/tzm-latn'),\n  tzm: () => import('dayjs/locale/tzm'),\n  'ug-cn': () => import('dayjs/locale/ug-cn'),\n  uk: () => import('dayjs/locale/uk'),\n  ur: () => import('dayjs/locale/ur'),\n  'uz-latn': () => import('dayjs/locale/uz-latn'),\n  uz: () => import('dayjs/locale/uz'),\n  vi: () => import('dayjs/locale/vi'),\n  'x-pseudo': () => import('dayjs/locale/x-pseudo'),\n  yo: () => import('dayjs/locale/yo'),\n  'zh-cn': () => import('dayjs/locale/zh-cn'),\n  'zh-hk': () => import('dayjs/locale/zh-hk'),\n  'zh-tw': () => import('dayjs/locale/zh-tw'),\n  zh: () => import('dayjs/locale/zh'),\n}\n\n//#endregion\n\nconst localeChangeListeners = new Set<(newLocale: string) => void>()\n/**\n * Returns the currently active Day.js locale.\n *\n * Can also be used to re-render a component when the locale changes.\n */\nexport function useDayjsLocale(): string {\n  const [locale, setLocale] = useState(dayjs.locale())\n\n  // Ideally, this would be inside the useEffect body, but that results in race-conditions making\n  // the useDayjsLocale hook result not update properly if the new locale is loaded too fast.\n  localeChangeListeners.add(setLocale)\n  useEffect(() => {\n    return () => { localeChangeListeners.delete(setLocale) }\n  }, [])\n  return locale\n}\n\nasync function loadLocale() {\n  let success = false\n  for (const language of navigator.languages ?? []) {\n    const locale = language.toLowerCase()\n    console.log('checking locale', locale)\n    if (locale in locales) {\n      try {\n        await locales[locale as keyof typeof locales]()\n        dayjs.locale(locale)\n        console.log('loaded dayjs locale', locale)\n        success = true\n        localeChangeListeners.forEach(l => l(locale))\n        break\n      } catch {\n        // failing is fine, we'll just try the next one\n      }\n    }\n  }\n  if (!success) {\n    console.warn('failed to load dayjs locale, falling back to en')\n  }\n}\nloadLocale().then()\n\nexport { dayjs }\nexport type { Dayjs } from 'dayjs'\nexport type { Duration, DurationUnitsObjectType } from 'dayjs/plugin/duration'\n","import {\n  ApiEventEntry,\n  ApiEventsResponse,\n  ApiScheduledPing,\n  ApiScheduledPingsResponse,\n  isScheduledPing,\n} from '@ping-board/common'\nimport { createAsyncThunk, createSlice } from '@reduxjs/toolkit'\nimport { RootState } from '.'\nimport { eventColors } from '../pages/calendar/calendar'\nimport { Dayjs, dayjs } from '../utils/dayjs'\nimport { apiSlice } from './api'\n\nexport interface CalendarEntry {\n  title: string\n  dateTime: string\n  color?: typeof eventColors[number]\n  baseEntry:\n    | { type: 'event', event: ApiEventEntry }\n    | { type: 'ping', ping: ApiScheduledPing }\n}\n\ninterface CalendarState {\n  loadingMonths: string[]\n  loadedMonths: string[]\n  events: CalendarEntry[]\n}\nconst initialCalendarState: CalendarState = {\n  loadingMonths: [],\n  loadedMonths: [],\n  events: [],\n}\n\nconst dayjsFromYearAndMonth = (date: { year: number, month: number }) =>\n  // We need to month+1, because month numbers are 0-based (i.e. january = 0)\n  dayjs.utc(`${date.year}-${date.month + 1}-01`)\n\nconst getMonthKey = (date: { year: number, month: number }) =>\n  dayjsFromYearAndMonth(date).format('YYYY-MM')\n\nfunction modulo(a: number, mod: number): number {\n  return ((a % mod) + mod) % mod\n}\n\nexport function getDisplayedMonthRange(date: { year: number, month: number }): {\n  from: Dayjs\n  to: Dayjs\n  displayedWeeks: number\n} {\n  const firstOfMonth = dayjsFromYearAndMonth(date)\n  const startOfMonthPadding = modulo(firstOfMonth.day() - dayjs.localeData().firstDayOfWeek(), 7)\n  const from = firstOfMonth.subtract(dayjs.duration({ days: startOfMonthPadding }))\n  const displayedWeeks = Math.ceil((from.daysInMonth() + startOfMonthPadding) / 7)\n  const to = from.add(dayjs.duration({ weeks: displayedWeeks }))\n  return { from, to, displayedWeeks }\n}\n\nexport const loadMonth = createAsyncThunk(\n  'calendar/loadMonth',\n  async (args: { year: number, month: number }) => {\n    const { from, to } = getDisplayedMonthRange(args)\n\n    async function loadAll<R, T>(\n      baseUrl: string,\n      getLatestTimestamp: (entries: T[]) => string | null,\n      getValues: (response: R) => { values: T[], hasMore: boolean }\n    ): Promise<T[]> {\n      let data: T[] = []\n      let hasMore = true\n\n      while (hasMore) {\n        const urlParams = new URLSearchParams({\n          after: getLatestTimestamp(data) ?? from.toISOString(),\n          before: to.toISOString(),\n        })\n        const response = await fetch(\n          `${baseUrl}?${urlParams.toString()}`,\n          { credentials: 'same-origin' }\n        )\n        if (response.status === 401) {\n          // we don't have access to this resource, but it's okay to fail and assume no data here\n          hasMore = false\n        } else {\n          const responseData = await response.json() as R\n          const values = getValues(responseData)\n          data = [...data, ...values.values]\n          hasMore = values.hasMore\n        }\n      }\n\n      return data\n    }\n\n    const [events, pings] = await Promise.all([\n      loadAll<ApiEventsResponse, ApiEventEntry>(\n        '/api/events',\n        events => events.length > 0 ? events[events.length - 1].time : null,\n        response => ({ values: response.events, hasMore: response.remaining > 0 })\n      ),\n      loadAll<ApiScheduledPingsResponse, ApiScheduledPing>(\n        '/api/pings/scheduled',\n        pings => pings.length > 0 ? pings[pings.length - 1].scheduledFor : null,\n        response => ({ values: response.pings, hasMore: response.remaining > 0 })\n      ),\n    ])\n\n    return { cached: false, events, pings }\n  },\n  {\n    condition: (args, { getState }) => {\n      const monthKey = getMonthKey(args)\n      const { loadingMonths, loadedMonths } = (getState() as { calendar: CalendarState }).calendar\n      return !loadingMonths.includes(monthKey) && !loadedMonths.includes(monthKey)\n    },\n  }\n)\n\nexport const calendarSlice = createSlice({\n  name: 'calendar',\n  initialState: initialCalendarState,\n  reducers: {\n    clearCalendarEntries: state => {\n      state.events = []\n      state.loadedMonths = []\n    },\n  },\n  extraReducers: builder => builder\n    .addCase(loadMonth.pending, (state, action) => {\n      state.loadingMonths.push(getMonthKey(action.meta.arg))\n    })\n    .addCase(loadMonth.rejected, (state, action) => {\n      const monthKey = getMonthKey(action.meta.arg)\n      state.loadingMonths = state.loadingMonths.filter(m => m !== monthKey)\n    })\n    .addCase(loadMonth.fulfilled, (state, action) => {\n      const monthKey = getMonthKey(action.meta.arg)\n      state.loadingMonths = state.loadingMonths.filter(m => m !== monthKey)\n      if (!action.payload) {\n        return\n      }\n      const events = new Map<string, CalendarEntry>([\n        ...state.events.map(e => e.baseEntry.type === 'event'\n          ? [`event-${e.baseEntry.event.id}`, e] as const\n          : [`ping-${e.baseEntry.ping.id}`, e] as const\n        ),\n        ...action.payload.events.map(e => [`event-${e.id}`, calendarEntryFromEvent(e)] as const),\n        ...action.payload.pings.map(p => [`ping-${p.id}`, calendarEntryFromPing(p)] as const),\n      ])\n      state.events = [...events.values()]\n    })\n\n    // Clear state on logout to prevent leaking data that the new user should not be able to see\n    .addMatcher(apiSlice.endpoints.logOut.matchFulfilled, () => {\n      return initialCalendarState\n    })\n\n    // Add calendar entries for every added event\n    .addMatcher(apiSlice.endpoints.addEvent.matchFulfilled, (state, action) => {\n      state.events = [...state.events, calendarEntryFromEvent(action.payload)]\n    })\n    // Update calendar entries for every updated event\n    .addMatcher(apiSlice.endpoints.updateEvent.matchFulfilled, (state, action) => {\n      const updated = action.payload\n      state.events = state.events.map(e =>\n        e.baseEntry.type === 'event' &&\n        e.baseEntry.event.id === updated.id\n        ? calendarEntryFromEvent(updated)\n        : e\n      )\n    })\n    // Remove calendar entries for every removed event\n    .addMatcher(apiSlice.endpoints.deleteEvent.matchFulfilled, (state, action) => {\n      const eventId = action.meta.arg.originalArgs\n      state.events = state.events\n        .filter(e => e.baseEntry.type !== 'event' || e.baseEntry.event.id !== eventId)\n    })\n\n    // Add calendar entries for sent pings\n    .addMatcher(apiSlice.endpoints.addPing.matchFulfilled, (state, action) => {\n      if (isScheduledPing(action.payload)) {\n        state.events = [...state.events, calendarEntryFromPing(action.payload)]\n      }\n    })\n    ,\n})\n\nfunction calendarEntryFromEvent(event: ApiEventEntry): CalendarEntry {\n  let color: CalendarEntry['color']\n  switch (event.priority.toLowerCase()) {\n    case 'low': color = 'gray'; break\n    case 'medium': color = 'yellow'; break\n    case 'high': color = 'orange'; break\n    case 'critical': color = 'red'; break\n  }\n\n  const title = [\n    event.standing.charAt(0).toUpperCase(),\n    event.standing.substr(1),\n    ' ',\n    event.structure.toLowerCase() === 'other' ? '' : event.structure + ' ',\n    event.type.toLowerCase() === 'other' ? '' : event.type.toLowerCase() + ' ',\n    'timer in ',\n    event.system,\n  ].join('')\n\n  return {\n    dateTime: event.time,\n    title,\n    color,\n    baseEntry: { type: 'event', event },\n  }\n}\n\nfunction calendarEntryFromPing(ping: ApiScheduledPing): CalendarEntry {\n  return {\n    dateTime: ping.scheduledFor,\n    title: ping.scheduledTitle,\n    baseEntry: { type: 'ping', ping },\n  }\n}\n\nexport const selectCalendarEvents = (state: RootState): CalendarEntry[] => state.calendar.events\nexport const selectIsLoadingCalendarEvents = (state: RootState): boolean =>\n  state.calendar.loadingMonths.length > 0\n\nexport const {\n  clearCalendarEntries,\n} = calendarSlice.actions\n","import { ApiEventEntry, ApiEventsResponse } from '@ping-board/common'\nimport { createAsyncThunk, createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { RootState } from '.'\nimport { apiSlice } from './api'\n\ninterface EventsListState {\n  loading: boolean\n  events: ApiEventEntry[]\n  hasMoreEvents: boolean\n}\nconst initialEventsListState: EventsListState = {\n  loading: false,\n  events: [],\n  hasMoreEvents: true,\n}\n\nexport const reloadEvents = createAsyncThunk(\n  'eventsList/reloadEvents',\n  (_, { dispatch }) => {\n    dispatch(clearEvents())\n    dispatch(loadMoreEvents())\n  }\n)\n\nexport const loadMoreEvents = createAsyncThunk(\n  'eventsList/loadMore',\n  async (_, { getState }) => {\n    const events = selectEvents(getState() as RootState)\n    const urlParams = new URLSearchParams({\n      ...events.length > 0 ? { before: events[events.length - 1].time } : {},\n      count: '40',\n    })\n    const request = fetch(`/api/events?${urlParams.toString()}`, { credentials: 'same-origin' })\n    return await request.then(r => r.json()) as ApiEventsResponse\n  },\n  {\n    condition: (_, { getState }) => {\n      const state = getState() as { eventsList: EventsListState }\n      return !state.eventsList.loading\n    },\n  }\n)\n\nfunction sortEvents(events: ApiEventEntry[]): ApiEventEntry[] {\n  return [...events].sort((a, b) => Date.parse(b.time) - Date.parse(a.time))\n}\n\nexport const eventsListSlice = createSlice({\n  name: 'eventsList',\n  initialState: initialEventsListState,\n  reducers: {\n    clearEvents: state => {\n      state.loading = false\n      state.events = []\n      state.hasMoreEvents = true\n    },\n    eventsReceived: (state, action: PayloadAction<ApiEventsResponse>) => {\n      state.loading = false\n      state.events = [...state.events, ...action.payload.events]\n      state.hasMoreEvents = action.payload.remaining > 0\n    },\n  },\n  extraReducers: builder => builder\n    .addCase(loadMoreEvents.pending, state => { state.loading = true })\n    .addCase(loadMoreEvents.fulfilled, (state, action) => {\n      state.loading = false\n      state.events = sortEvents([...state.events, ...action.payload.events])\n      state.hasMoreEvents = action.payload.remaining > 0\n    })\n    .addCase(loadMoreEvents.rejected, state => {\n      state.loading = false\n    })\n\n    // Clear state on logout to prevent leaking data that the new user should not be able to see\n    .addMatcher(apiSlice.endpoints.logOut.matchFulfilled, () => {\n      return initialEventsListState\n    })\n\n    // Add added events to the event list without re-fetching them\n    .addMatcher(apiSlice.endpoints.addEvent.matchFulfilled, (state, action) => {\n      state.events = sortEvents([...state.events, action.payload])\n    })\n    // Update updated events in the event list without re-fetching them\n    .addMatcher(apiSlice.endpoints.updateEvent.matchFulfilled, (state, action) => {\n      const updated = action.payload\n      state.events = sortEvents(state.events.map(e => e.id === updated.id ? updated : e))\n    })\n    // Remove deleted events from the event list without re-fetching them\n    .addMatcher(apiSlice.endpoints.deleteEvent.matchFulfilled, (state, action) => {\n      const eventId = action.meta.arg.originalArgs\n      state.events = state.events.filter(e => e.id !== eventId)\n    }),\n})\n\nexport const selectEvents = (state: RootState): ApiEventEntry[] => state.eventsList.events\nexport const selectHasMoreEvents = (state: RootState): boolean => state.eventsList.hasMoreEvents\nexport const selectIsLoadingEvents = (state: RootState): boolean => state.eventsList.loading\n\nexport const {\n  clearEvents,\n  eventsReceived,\n} = eventsListSlice.actions\n","import { ApiPing, ApiPingsResponse } from '@ping-board/common'\nimport { createAsyncThunk, createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { RootState } from '.'\nimport { apiSlice } from './api'\n\ninterface PingsListState {\n  loading: boolean\n  pings: ApiPing[]\n  hasMore: boolean\n}\nconst initialPingsListState: PingsListState = {\n  loading: false,\n  pings: [],\n  hasMore: true,\n}\n\nexport const reloadPings = createAsyncThunk(\n  'pingsList/reloadPings',\n  (_, { dispatch }) => {\n    dispatch(clearPings())\n    dispatch(loadMorePings())\n  }\n)\n\nexport const loadMorePings = createAsyncThunk(\n  'pingsList/loadMore',\n  async (_, { getState }) => {\n    const pings = selectPings(getState() as RootState)\n    const urlParams = new URLSearchParams(\n      pings.length > 0 ? { before: pings[pings.length - 1].sentAt } : {}\n    )\n    const request = fetch(`/api/pings?${urlParams.toString()}`, { credentials: 'same-origin' })\n    return await request.then(r => r.json()) as ApiPingsResponse\n  },\n  {\n    condition: (_, { getState }) => {\n      const state = getState() as { pingsList: PingsListState }\n      return !state.pingsList.loading\n    },\n  }\n)\n\nfunction sortPings(pings: ApiPing[]): ApiPing[] {\n  return [...pings].sort((a, b) => Date.parse(b.sentAt) - Date.parse(a.sentAt))\n}\n\nexport const pingsListSlice = createSlice({\n  name: 'pingsList',\n  initialState: initialPingsListState,\n  reducers: {\n    clearPings: state => {\n      state.loading = false\n      state.pings = []\n      state.hasMore = true\n    },\n    pingsReceived: (state, action: PayloadAction<ApiPingsResponse>) => {\n      state.loading = false\n      state.pings = [...state.pings, ...action.payload.pings]\n      state.hasMore = action.payload.remaining > 0\n    },\n  },\n  extraReducers: builder => builder\n    .addCase(loadMorePings.pending, state => { state.loading = true })\n    .addCase(loadMorePings.fulfilled, (state, action) => {\n      state.loading = false\n      state.pings = sortPings([...state.pings, ...action.payload.pings])\n      state.hasMore = action.payload.remaining > 0\n    })\n    .addCase(loadMorePings.rejected, state => {\n      state.loading = false\n    })\n\n    // Clear state on logout to prevent leaking data that the new user should not be able to see\n    .addMatcher(apiSlice.endpoints.logOut.matchFulfilled, () => {\n      return initialPingsListState\n    })\n\n    // Add sent pings to the list of pings without re-fetching them\n    .addMatcher(apiSlice.endpoints.addPing.matchFulfilled, (state, action) => {\n      state.pings = sortPings([...state.pings, action.payload])\n    }),\n})\n\nexport const selectPings = (state: RootState): ApiPing[] => state.pingsList.pings\nexport const selectHasMorePings = (state: RootState): boolean => state.pingsList.hasMore\nexport const selectIsLoadingPings = (state: RootState): boolean => state.pingsList.loading\n\nexport const {\n  clearPings,\n  pingsReceived,\n} = pingsListSlice.actions\n","import { configureStore } from '@reduxjs/toolkit'\nimport { setupListeners } from '@reduxjs/toolkit/dist/query'\nimport { apiSlice } from './api'\nimport { calendarSlice } from './calendar-slice'\nimport { eventsListSlice } from './events-list-slice'\nimport { pingsListSlice } from './pings-list-slice'\nexport * from './api'\n\nexport const store = configureStore({\n  reducer: {\n    [apiSlice.reducerPath]: apiSlice.reducer,\n    [calendarSlice.name]: calendarSlice.reducer,\n    [eventsListSlice.name]: eventsListSlice.reducer,\n    [pingsListSlice.name]: pingsListSlice.reducer,\n  },\n  middleware: getDefaultMiddleware => getDefaultMiddleware()\n    .concat(apiSlice.middleware),\n})\nsetupListeners(store.dispatch)\n\nexport type RootState = ReturnType<typeof store.getState>\nexport type AppDispatch = typeof store.dispatch\n","import { Button, Container, Nav, Navbar } from 'react-bootstrap'\nimport { useHistory } from 'react-router-dom'\nimport { useGetUserQuery, useLogOutMutation } from '../store'\n\nexport interface NavPage {\n  href: string\n  title: string\n}\n\nexport interface AppNavProps {\n  pages: NavPage[]\n}\n\nexport function AppNav(props: AppNavProps): JSX.Element {\n  const history = useHistory()\n  const navigateTo = (href: string) => (e: React.MouseEvent<HTMLElement, MouseEvent>) => {\n    e.preventDefault()\n    history.push(href)\n  }\n\n  const user = useGetUserQuery(void 0, {\n    pollingInterval: 60 * 1000,\n  })\n  const [logout, { isLoading: isLoggingOut }] = useLogOutMutation()\n\n  const isLoading = user.isFetching || isLoggingOut\n\n  return (\n    <Navbar variant=\"dark\" bg=\"primary\" expand=\"md\">\n      <Container fluid>\n        <Navbar.Brand href=\"/\">Brave Collective Pingboard</Navbar.Brand>\n        <Navbar.Toggle aria-controls=\"navbar-nav\" />\n          <Navbar.Collapse id=\"navbar-nav\" className=\"justify-content-end\">\n            <Nav variant=\"pills\" className=\"me-auto\">\n              {props.pages.map(page => (\n                <Nav.Link onClick={navigateTo(page.href)} key={page.title} href={page.href}>\n                  {page.title}\n                </Nav.Link>\n              ))}\n            </Nav>\n            {isLoading\n              ? <Navbar.Text>Loading…</Navbar.Text>\n              : user.data?.isLoggedIn\n                ? <>\n                    <Navbar.Text>{user.data.character.name}</Navbar.Text>\n                    <Button onClick={() => logout()}>Log Out</Button>\n                  </>\n                : <Button onClick={navigateTo('/login')} href=\"/login\">Log In</Button>\n            }\n          </Navbar.Collapse>\n      </Container>\n    </Navbar>\n  )\n}\n","import { AppDispatch, RootState } from '../store'\nimport { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux'\n\nexport const useAppDispatch = (): AppDispatch => useDispatch<AppDispatch>()\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector\n","import { Dayjs, dayjs } from '../utils/dayjs'\n\nexport interface TimeProps {\n  time: Date | string | Dayjs\n  format?: string\n  asLink?: boolean\n  className?: string\n}\nexport function Time({\n  time,\n  format = 'llll',\n  asLink = false,\n  className,\n}: TimeProps): JSX.Element {\n  const t = dayjs(time)\n\n  if (asLink) {\n    const nakamuraLink = `https://time.nakamura-labs.com/#${t.unix()}`\n    return (\n      <a\n        className={className}\n        href={nakamuraLink}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n        onClick={e => e.stopPropagation()}\n      >\n        {t.format(format)}\n      </a>\n    )\n  }\n\n  return (\n    <span className={className}>{t.format(format)}</span>\n  )\n}\n","export function ConstellationLink(props: { region: string, constellation: string }): JSX.Element {\n  const link = `https://evemaps.dotlan.net/map/${props.region}/${props.constellation}`\n\n  return (\n    <a href={link} target=\"_blank\" rel=\"noreferrer\">\n      {props.constellation}\n    </a>\n  )\n}\n","export function RegionLink(props: { region: string, system?: string }): JSX.Element {\n  const link = `https://evemaps.dotlan.net/map/${props.region}` +\n    (props.system ? `/${props.system}` : '')\n\n  return (\n    <a href={link} target=\"_blank\" rel=\"noreferrer\">\n      {props.region}\n    </a>\n  )\n}\n","import dayjs from 'dayjs'\nimport { useEffect, useState } from 'react'\n\nexport interface RelativeTimeProps {\n  time: Date | string\n}\nexport function RelativeTime({\n  time,\n}: RelativeTimeProps): JSX.Element {\n  const [relative, setRelative] = useState(dayjs(time).fromNow())\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setRelative(dayjs(time).fromNow())\n    }, 1000)\n    return () => clearInterval(interval)\n  }, [time])\n\n  return (\n    <span>{relative}</span>\n  )\n}\n","import React from 'react'\n\nconst slackFormatters: { regex: RegExp, onMatch: (...match: string[]) => React.ReactNode }[] = [\n  // newlines\n  { regex: /\\n/g, onMatch: _ => <br /> }, // eslint-disable-line @typescript-eslint/no-unused-vars\n  // links (`[title](url)`)\n  {\n    regex: /\\[([^\\]]+\\]\\([^)]+)\\)>/g,\n    onMatch: match => {\n      const split = match.indexOf('](')\n      const href = match.substring(0, split)\n      const title = match.substring(split + 2)\n      return <a href={href} target=\"_blank\" rel=\"noreferrer\">{title}</a>\n    },\n  },\n  // links (`<href|title>`)\n  {\n    regex: /<([^|]+\\|[^>]+)>/g,\n    onMatch: match => {\n      const split = match.indexOf('|')\n      const href = match.substring(0, split)\n      const title = match.substring(split + 1)\n      return <a href={href} target=\"_blank\" rel=\"noreferrer\">{title}</a>\n    },\n  },\n  // bold text\n  { regex: /\\*([^*]+)\\*/g, onMatch: match => <b>{match}</b> },\n  // italics\n  { regex: /_([^*]+)_/g, onMatch: match => <i>{match}</i> },\n  // strikethrough\n  { regex: /~([^~]+)~/g, onMatch: match => <s>{match}</s> },\n]\n\nexport function SlackMessage({ text }: { text: string }): JSX.Element {\n  const fragments = slackFormatters.reduce(\n    (fragments, { regex, onMatch }) => fragments.flatMap(fragment => {\n      if (typeof fragment !== 'string') {\n        return [fragment]\n      }\n      const placeholder = '\\0'\n      const replacements: React.ReactNode[] = []\n      const formatted = fragment.replace(regex, (...args) => {\n        const match = args.length > 3 ? args.slice(1, args.length - 2) as string[] : []\n        replacements.push(onMatch(...match))\n        return placeholder\n      })\n      return formatted\n        .split(placeholder)\n        .flatMap((f, i) => [f, ...replacements[i] ? [replacements[i]] : []])\n    }),\n    [text] as React.ReactNode[]\n  )\n\n  return (<>\n    {fragments.map((f, i) => <React.Fragment key={i}>{f}</React.Fragment>)}\n  </>)\n}\n","export function SolarSystemLink(props: { system: string }): JSX.Element {\n  const link = `https://evemaps.dotlan.net/system/${props.system}`\n  return (\n    <a href={link} target=\"_blank\" rel=\"noreferrer\">\n      {props.system}\n    </a>\n  )\n}\n","import { ApiEventEntry, ApiScheduledPing } from '@ping-board/common'\nimport { Col, Modal, ModalProps, Row } from 'react-bootstrap'\nimport { ConstellationLink } from '../../components/constellation-link'\nimport { RegionLink } from '../../components/region-link'\nimport { RelativeTime } from '../../components/relative-time'\nimport { SlackMessage } from '../../components/slack-message'\nimport { SolarSystemLink } from '../../components/solar-system-link'\nimport { Time } from '../../components/time'\nimport { CalendarEntry } from '../../store/calendar-slice'\nimport { dayjs } from '../../utils/dayjs'\n\nexport interface CalendarEntryDialogProps {\n  entry?: CalendarEntry | null\n}\nexport function CalendarEntryDialog({\n  entry,\n  ...modalProps\n}: CalendarEntryDialogProps & ModalProps): JSX.Element {\n  return (\n    <Modal {...modalProps}>\n      <Modal.Header closeButton>\n        <Modal.Title>\n          <i className={{\n            event: 'bi-stopwatch',\n            ping: 'bi-broadcast-pin',\n          }[entry?.baseEntry.type ?? 'event']} />{' '}\n          {entry?.title}\n          <h6 className=\"m-0\">\n            {{\n              event: 'Timerboard Event',\n              ping: 'Ping',\n            }[entry?.baseEntry.type ?? 'event']}\n          </h6>\n        </Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        {entry?.baseEntry.type === 'event' && (\n          <CalendarEntryEventBody event={entry.baseEntry.event} />\n        )}\n        {entry?.baseEntry.type === 'ping' && (\n          <CalendarEntryPingBody ping={entry.baseEntry.ping} />\n        )}\n      </Modal.Body>\n    </Modal>\n  )\n}\n\nfunction CalendarEntryEventBody({ event }: { event: ApiEventEntry }): JSX.Element {\n  return (\n    <Row className=\"mt-n2\">\n      <Col xs={3}>EVE Time</Col>\n      <Col xs={9}>\n        <Time\n          time={dayjs.utc(event.time)}\n          asLink\n          format=\"YYYY-MM-DD HH:mm\"\n        />\n      </Col>\n\n      <Col xs={3}>Local Time</Col>\n      <Col xs={9}>\n        <Time time={event.time} /> (\n          <RelativeTime time={event.time} />\n        )\n      </Col>\n\n      <Col xs={3}>Priority</Col>\n      <Col xs={9}>{event.priority}</Col>\n\n      <hr className=\"my-1\" />\n\n      <Col xs={3}>System</Col>\n      <Col xs={9}>\n        <SolarSystemLink system={event.system} />\n      </Col>\n\n      <Col xs={3}>Constellation</Col>\n      <Col xs={9}>\n        <ConstellationLink\n          constellation={event.constellation}\n          region={event.region}\n        />\n      </Col>\n\n      <Col xs={3}>Region</Col>\n      <Col xs={9}>\n        <RegionLink\n          region={event.region}\n          system={event.system}\n        />\n      </Col>\n\n      <hr className=\"my-1\" />\n\n      {event.result && (<>\n        <Col xs={3}>Result</Col>\n        <Col xs={9}>{event.result}</Col>\n      </>)}\n\n      <Col xs={3}>Standing</Col>\n      <Col xs={9}>{event.standing}</Col>\n\n      <Col xs={3}>Type</Col>\n      <Col xs={9}>{event.type}</Col>\n\n      <Col xs={3}>Structure</Col>\n      <Col xs={9}>{event.structure}</Col>\n\n      {event.notes && (<>\n        <Col xs={3}>Notes</Col>\n        <Col xs={9}>{event.notes.split('\\n').map(line => (\n          <>{line}<br /></>\n        ))}</Col>\n      </>)}\n    </Row>\n  )\n}\nfunction CalendarEntryPingBody({ ping }: { ping: ApiScheduledPing }): JSX.Element {\n  return (\n    <Row className=\"mt-n2\">\n      <Col xs={3}>EVE Time</Col>\n      <Col xs={9}>\n        <Time\n          time={dayjs.utc(ping.scheduledFor)}\n          asLink\n          format=\"YYYY-MM-DD HH:mm\"\n        />\n      </Col>\n\n      <Col xs={3}>Local Time</Col>\n      <Col xs={9}>\n        <Time time={ping.scheduledFor} /> (\n          <RelativeTime time={ping.scheduledFor} />\n        )\n      </Col>\n\n      <Col xs={3}>Channel</Col>\n      <Col xs={9}>{ping.slackChannelName}</Col>\n\n      <Col xs={3}>Sent By</Col>\n      <Col xs={9}>{ping.author}</Col>\n\n      <hr className=\"my-1\" />\n\n      <Col xs={3}>Ping Text</Col>\n      <Col xs={9}>\n        <SlackMessage text={ping.text} />\n      </Col>\n    </Row>\n  )\n}\n","import clsx from 'clsx'\nimport { useState } from 'react'\nimport { Time } from '../../components/time'\nimport { CalendarEntry, getDisplayedMonthRange } from '../../store/calendar-slice'\nimport { dayjs, useDayjsLocale } from '../../utils/dayjs'\nimport { CalendarEntryDialog } from './calendar-entry-dialog'\nimport './calendar.scss'\n\nexport const eventColors = [\n  'blue',\n  'indigo',\n  'purple',\n  'pink',\n  'red',\n  'orange',\n  'yellow',\n  'green',\n  'teal',\n  'cyan',\n  'gray',\n] as const\ninterface CalendarProps {\n  year: number\n  month: number\n  events: CalendarEntry[]\n  className?: string\n}\nexport function Calendar({\n  year,\n  month,\n  events,\n  className,\n}: CalendarProps): JSX.Element {\n  const { from, displayedWeeks } = getDisplayedMonthRange({ year, month })\n\n  const [showEntryDialog, setShowEntryDialog] = useState(false)\n  const [selectedEntry, setSelectedEntry] = useState<CalendarEntry | null>(null)\n  const handleClickEntry = (entry: CalendarEntry) => {\n    setShowEntryDialog(true)\n    setSelectedEntry(entry)\n  }\n  const handleHideEntry = () => { setShowEntryDialog(false) }\n\n  const weeks = [...new Array<void>(displayedWeeks)]\n    .map((_, week) => ({\n      week: from.add(week * 7, 'days').week(),\n      days: [...new Array<void>(7)].map((_, day) => {\n        const date = from.add(week * 7 + day, 'days')\n        const start = date.valueOf()\n        const end = date.add(1, 'days').valueOf()\n        const isToday = date.format('YYYY-MM-DD') === dayjs.utc().format('YYYY-MM-DD')\n        return {\n          date,\n          isToday,\n          events: events.filter(e => {\n            const t = dayjs.utc(e.dateTime).valueOf()\n            return t >= start && t < end\n          }).sort((a, b) => dayjs.utc(a.dateTime).valueOf() - dayjs.utc(b.dateTime).valueOf()),\n        }\n      }),\n    }))\n\n  // Update the component when the locale changes\n  useDayjsLocale()\n\n  return (\n    <div className={clsx('d-flex', 'flex-column', 'bg-dark', className)}>\n      {weeks.map((week, i) => (\n        <div key={i}\n          className={clsx(\n            'flex-fill position-relative d-flex flex-grow-1',\n            i > 0 && 'border-top',\n          )}\n        >\n          {/* Week number */}\n          <div className=\"py-1 mx-1\" style={{ width: 28 }}>\n            <div\n              className=\"h-100 rounded-1 px-1 text-center\"\n              style={{ background: 'var(--bs-gray-700)' }}\n            >\n              {week.days[0].date.week()}\n            </div>\n          </div>\n          {/* Days */}\n          {week.days.map((day, j) => (\n            <div key={day.date.date()}\n              aria-hidden={true}\n              className={clsx(\n                'calendar-day',\n                'flex-grow-1',\n                'overflow-hidden',\n                j > 0 && 'border-start',\n                day.date.month() !== month && 'text-muted'\n              )}\n              style={{ flexBasis: 0 }}\n            >\n              {i === 0 &&\n                // display the weekday in the first row of the calendar\n                <div className=\"px-1 text-center text-white\">\n                  {day.date.format('dddd')}\n                </div>\n              }\n              <div className={clsx('day', day.isToday && 'today')}>\n                <span>{day.date.date()}</span>\n              </div>\n              {day.events.map((e, i) => (\n                <div key={i}\n                  className={clsx(\n                    'calendar-event',\n                    e.color ?? 'cyan',\n                  )}\n                  onClick={() => handleClickEntry(e)}\n                >\n                  <Time time={dayjs.utc(e.dateTime)} asLink format=\"HH:mm\" className=\"me-1\" />\n                  <span>\n                    <i className={{\n                      event: 'bi-stopwatch',\n                      ping: 'bi-broadcast-pin',\n                    }[e.baseEntry.type]} />{' '}\n                    {e.title}\n                  </span>\n                </div>\n              ))}\n            </div>\n          ))}\n        </div>\n      ))}\n\n      <CalendarEntryDialog\n        entry={selectedEntry}\n        show={showEntryDialog}\n        onHide={handleHideEntry}\n        fullscreen=\"sm-down\"\n      />\n    </div>\n  )\n}\n","import { UserRoles } from '@ping-board/common'\nimport dayjs from 'dayjs'\nimport { useEffect, useState } from 'react'\nimport { Button, Container } from 'react-bootstrap'\nimport { Redirect, useRouteMatch } from 'react-router-dom'\nimport { useAppDispatch, useAppSelector } from '../../hooks/redux'\nimport { useGetUserQuery } from '../../store'\nimport { clearCalendarEntries, loadMonth, selectCalendarEvents } from '../../store/calendar-slice'\nimport { Calendar } from './calendar'\n\nexport function CalendarPage(): JSX.Element {\n  const dispatch = useAppDispatch()\n  const me = useGetUserQuery()\n  const canRead = me.data?.isLoggedIn && (\n    me.data.character.roles.includes(UserRoles.EVENTS_READ) ||\n    me.data.character.roles.includes(UserRoles.PING)\n  )\n\n  const events = useAppSelector(selectCalendarEvents)\n\n  const [currentMonth, setCurrentMonth] = useState(dayjs.utc())\n  const month = currentMonth.month()\n  const year = currentMonth.year()\n  useEffect(() => {\n    dispatch(loadMonth({ month, year }))\n  }, [dispatch, month, year])\n\n  const handleTodayClicked = () => setCurrentMonth(dayjs.utc())\n  const handleNextMonthClicked = () =>\n    setCurrentMonth(m => m.add(dayjs.duration({ months: 1 })))\n  const handlePrevMonthClicked = () =>\n    setCurrentMonth(m => m.subtract(dayjs.duration({ months: 1 })))\n  const handleReloadClicked = () => {\n    dispatch(clearCalendarEntries())\n    dispatch(loadMonth({ month, year }))\n  }\n\n  const { url } = useRouteMatch()\n  if (!me.isFetching) {\n    if (!me.data?.isLoggedIn) {\n      return <Redirect to={`/login?postLoginRedirect=${url}`} />\n    }\n    if (!canRead) {\n      return (\n        <Container fluid>\n          <h6>Sorry, you don&apos;t have permission to view this page.</h6>\n        </Container>\n      )\n    }\n  }\n\n  return (\n    <Container fluid className=\"h-100 d-flex flex-column\">\n      <h3 className=\"mt-n1 pt-3\">Calendar</h3>\n      <div className=\"d-flex mb-2\">\n        <Button size=\"sm\" variant=\"outline-light\" className=\"me-2\" onClick={handleTodayClicked}>\n          Today\n        </Button>\n        <Button size=\"sm\" variant=\"outline-light\" className=\"me-2\" onClick={handlePrevMonthClicked}>\n          <i className=\"bi-chevron-left\" />\n        </Button>\n        <Button size=\"sm\" variant=\"outline-light\" className=\"me-2\" onClick={handleNextMonthClicked}>\n          <i className=\"bi-chevron-right\" />\n        </Button>\n        <h4 className=\"h-100 mb-0 me-2 align-middle\">{currentMonth.format('MMMM YYYY')}</h4>\n        <Button size=\"sm\" variant=\"outline-light\" onClick={handleReloadClicked}>\n          <i className=\"bi-arrow-clockwise\" /> Reload\n        </Button>\n      </div>\n      <Calendar\n        className=\"flex-fill mb-2\"\n        year={currentMonth.year()}\n        month={currentMonth.month()}\n        events={events}\n      />\n    </Container>\n  )\n}\n","export default __webpack_public_path__ + \"static/media/brave-logo.070fd9e9.svg\";","import { Col, Container, Row } from 'react-bootstrap'\nimport { Redirect, useLocation } from 'react-router-dom'\nimport logo from '../../brave-logo.svg'\nimport { useGetUserQuery } from '../../store'\nimport loginButton from './eve-sso-login-black-large.png'\nimport './login.scss'\n\nexport function LoginPage(): JSX.Element {\n  const me = useGetUserQuery()\n\n  const location = useLocation()\n\n  if (me.data?.isLoggedIn) {\n    return <Redirect to=\"/\" />\n  }\n\n  const urlParams = new URLSearchParams(location.search)\n  const postLoginRedirect = urlParams.get('postLoginRedirect')\n  const loginUrl = '/auth/login' + (\n    postLoginRedirect\n    ? `?${new URLSearchParams({ postLoginRedirect })}`\n    : ''\n  )\n\n  return (\n    <Container className=\"login-container\">\n      <div style={{ flex: '33%' }} />\n      <Row className=\"jumbotron\" style={{ justifyContent: 'center' }}>\n        <Col sm={7}>\n          <h1>Brave Collective PingBoard</h1>\n          <hr />\n          <p>Log in with your EVE Online Account to gain access.</p>\n          <p>\n            <a href={loginUrl}>\n              <img src={loginButton} alt=\"LOG IN with EVE Online\" />\n            </a>\n          </p>\n          <p>\n            You first need a{' '}\n            <a href=\"https://account.bravecollective.com/\" target=\"_blank\" rel=\"noreferrer\">\n              BRAVE Core Service Account\n            </a>{' '}\n            to log in here.\n          </p>\n        </Col>\n        <Col sm={5}>\n          <img src={logo} alt=\"Logo\" className=\"img-fluid\" />\n        </Col>\n      </Row>\n      <div style={{ flex: '66%' }} />\n    </Container>\n  )\n}\n","export default \"data:image/png;base64,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\"","import { ApiPingTemplate, ApiPingTemplateInput } from '@ping-board/common'\nimport clsx from 'clsx'\nimport { ChangeEvent, useEffect, useState } from 'react'\nimport {\n  Alert,\n  Button,\n  Col,\n  Form,\n  Modal,\n  Row,\n  Table,\n} from 'react-bootstrap'\nimport {\n  useGetAvailableNeucoreGroupsQuery,\n  useGetPingChannelsQuery,\n} from '../../store'\nimport { dayjs } from '../../utils/dayjs'\nimport './edit-ping-template-dialog.scss'\n\nexport interface EditPingTemplateDialogProps {\n  show: boolean\n  template?: ApiPingTemplate | null\n  onSave?: (template: ApiPingTemplateInput) => void\n  onCancel?: () => void\n  onDelete?: () => void\n}\nexport function EditPingTemplateDialog({\n  show,\n  template,\n  onSave,\n  onCancel,\n  onDelete,\n}: EditPingTemplateDialogProps): JSX.Element {\n  const [editedTemplate, setEditedTemplate] = useState<ApiPingTemplateInput>(\n    getDefaultEditedTemplate()\n  )\n  useEffect(() => setEditedTemplate(\n    template ? { ...template } : getDefaultEditedTemplate()\n  ), [template])\n  const canSave = (\n    editedTemplate.name.length > 0 &&\n    editedTemplate.slackChannelId.length > 0\n  )\n  const save = () => {\n    if (canSave && onSave) {\n      const template = editedTemplate\n      onSave(template)\n      setEditedTemplate(getDefaultEditedTemplate())\n    }\n  }\n\n  const channels = useGetPingChannelsQuery()\n  const neucoreGroups = useGetAvailableNeucoreGroupsQuery()\n  const remainingNeucoreGroups = (neucoreGroups.data?.neucoreGroups ?? [])\n    .filter(g => !editedTemplate.allowedNeucoreGroups.includes(g.name))\n\n  const isNewTemplate = typeof template?.id !== 'number'\n  const lastEdited = !isNewTemplate && [\n    `Last edited by ${template?.updatedBy ?? 'unknown'}`,\n    template?.updatedAt\n      ? `at ${dayjs(template.updatedAt).format('llll')} (${dayjs(template.updatedAt).fromNow()})`\n      : 'unknown',\n  ].join(' ')\n\n  const setTemplateField = <T extends keyof ApiPingTemplateInput>(\n    field: T, value: ApiPingTemplateInput[T]\n  ) => {\n    setEditedTemplate(t => ({ ...t, [field]: value }))\n  }\n\n  const handleSlackChannelChange = (e: ChangeEvent<HTMLSelectElement>) =>\n    setEditedTemplate(t => ({ ...t, slackChannelId: e.target.value }))\n\n  const handleAllowSchedulingChange = () =>\n    setTemplateField('allowScheduling', !editedTemplate.allowScheduling)\n\n  const handleNeucoreGroupSelected = (e: ChangeEvent<HTMLSelectElement>) =>\n    setEditedTemplate(t => ({\n      ...t,\n      allowedNeucoreGroups: [...t.allowedNeucoreGroups, e.target.value ],\n    }))\n  const handleRemoveNeucoreGroup = (groupName: string) =>\n    setEditedTemplate(t => ({\n      ...t,\n      allowedNeucoreGroups: t.allowedNeucoreGroups.filter(g => g !== groupName),\n    }))\n\n  const [isDeletePending, setIsDeletePending] = useState(false)\n  const handleStartDelete = () => setIsDeletePending(true)\n  const handleCancelDelete = () => setIsDeletePending(false)\n  const handleConfirmDelete = () => {\n    setIsDeletePending(false)\n    onDelete?.()\n    setEditedTemplate(getDefaultEditedTemplate())\n  }\n\n  return (\n    <Modal show={show} size=\"lg\" backdrop=\"static\">\n      <Modal.Header>\n        <Modal.Title>{isNewTemplate ? 'Add' : 'Edit'} Ping Template</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <Form>\n          <Row>\n            {lastEdited && <Col xs={12} className=\"mb-3\">{lastEdited}</Col>}\n\n            <Form.Group as={Col} controlId=\"name\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Template Name</Form.Label>\n              <Form.Control\n                type=\"text\"\n                value={editedTemplate.name}\n                onChange={e => setTemplateField('name', e.target.value)}\n              />\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"slackChannel\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Targeted Slack Channel</Form.Label>\n              <Form.Select\n                value={editedTemplate.slackChannelId}\n                onChange={handleSlackChannelChange}\n              >\n                {channels.isLoading &&\n                  <option value=\"\">Loading&hellip;</option>\n                }\n                {!channels.isLoading && ((channels.data?.channels.length ?? 0) < 1\n                  ? <option value=\"\">No valid target channels!</option>\n                  : <option value=\"\">(Please Select)</option>\n                )}\n                {!channels.isLoading && channels.data?.channels.map(c => (\n                  <option key={c.id} value={c.id}>{c.name}</option>\n                ))}\n              </Form.Select>\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"allowScheduling\" xs={12} className=\"mb-3\">\n              <Form.Check\n                checked={!!editedTemplate.allowScheduling}\n                onChange={handleAllowSchedulingChange}\n                label={<>\n                  Allow Showing the Ping in the Calendar\n                  <span className=\"d-block\" style={{fontSize: '0.9rem' }}>\n                    Only users with permissions to view pings sent to the target channel will be\n                    able to see them in the calendar.\n                  </span>\n                </>}\n              />\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"addNeucoreGroup\" xs={12} className=\"mb-3\">\n              <Form.Label>Neucore Groups Allowed to Ping</Form.Label>\n              <Table variant=\"dark\">\n                <thead>\n                  <tr>\n                    <th style={{ width: '100%' }}>Group</th>\n                    <th>Action</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {editedTemplate.allowedNeucoreGroups.length === 0 &&\n                    <tr>\n                      <td colSpan={2}>\n                        <Alert variant=\"warning\" className=\"mb-0 p-1\">\n                          <i className=\"bi-exclamation-triangle\" />{' '}\n                          All users allowed to ping can use this template\n                        </Alert>\n                      </td>\n                    </tr>\n                  }\n                  {editedTemplate.allowedNeucoreGroups.map(g => (\n                    <tr key={g}>\n                      <td className=\"align-middle\">{g}</td>\n                      <td>\n                        <Button\n                          size=\"sm\"\n                          onClick={() => handleRemoveNeucoreGroup(g)}\n                          className=\"text-nowrap\"\n                        >\n                          <i className=\"bi-trash-fill\" /> Remove\n                        </Button>\n                      </td>\n                    </tr>\n                  ))}\n                  {neucoreGroups.isLoading &&\n                    <tr><td colSpan={2}>Loading&hellip;</td></tr>\n                  }\n                  {!neucoreGroups.isLoading &&\n                    remainingNeucoreGroups.length < 1 &&\n                    editedTemplate.allowedNeucoreGroups.length < 1 &&\n                    <tr>\n                      <td colSpan={2}>\n                        <Alert variant=\"Error\">\n                          No Neucore groups configured!\n                        </Alert>\n                      </td>\n                    </tr>\n                  }\n                  {remainingNeucoreGroups.length > 0 && (\n                    <tr>\n                      <td colSpan={2}>\n                        <Form.Select value=\"\" onChange={handleNeucoreGroupSelected}>\n                          <option value=\"\">(Select a group to add)</option>\n                          {!neucoreGroups.isLoading && remainingNeucoreGroups.map(g => (\n                            <option key={g.id} value={g.name}>{g.name}</option>\n                          ))}\n                        </Form.Select>\n                      </td>\n                    </tr>\n                  )}\n                </tbody>\n              </Table>\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"template\" xs={12} className=\"mb-3\">\n              <Form.Label>Template Text</Form.Label>\n              <Form.Control\n                as=\"textarea\"\n                rows={10}\n                value={editedTemplate.template}\n                onChange={e => setTemplateField('template', e.target.value)}\n              />\n            </Form.Group>\n          </Row>\n        </Form>\n      </Modal.Body>\n      <Modal.Footer className=\"edit-ping-template-dialog-footer\">\n        <div className={clsx(\n          'edit-ping-template-dialog-buttons-wrapper',\n          isDeletePending && 'hidden',\n        )}>\n          {!isNewTemplate && (\n            <>\n              <Button\n                variant=\"danger\"\n                disabled={isDeletePending}\n                onClick={handleStartDelete}\n              >\n                Delete\n              </Button>\n              <div className=\"edit-ping-template-dialog-buttons-spacer\" />\n            </>\n          )}\n          <Button variant=\"secondary\" onClick={onCancel} disabled={isDeletePending}>\n            Cancel\n          </Button>\n          <Button variant=\"primary\" disabled={!canSave || isDeletePending} onClick={save}>\n            Save\n          </Button>\n        </div>\n        {!isNewTemplate && (\n          <div className={clsx(\n            'edit-ping-template-confirm-delete-buttons-wrapper',\n            !isDeletePending && 'hidden'\n          )}>\n            <Button disabled={!isDeletePending} onClick={handleCancelDelete}>\n              No\n            </Button>\n            <div className=\"edit-ping-template-dialog-buttons-spacer\">\n              Are you sure you want to delete this ping template?\n            </div>\n            <Button variant=\"danger\" disabled={!isDeletePending} onClick={handleConfirmDelete}>\n              Yes\n            </Button>\n          </div>\n        )}\n      </Modal.Footer>\n    </Modal>\n  )\n}\n\nfunction getDefaultEditedTemplate(): ApiPingTemplateInput {\n  return {\n    name: '',\n    slackChannelId: '',\n    template: '',\n    allowedNeucoreGroups: [],\n    allowScheduling: false,\n  }\n}\n","import { ApiPingTemplate, ApiPingTemplateInput } from '@ping-board/common'\nimport React from 'react'\nimport { useState } from 'react'\nimport { Button, Table } from 'react-bootstrap'\nimport { Link, useRouteMatch } from 'react-router-dom'\nimport {\n  useAddPingTemplateMutation,\n  useDeletePingTemplateMutation,\n  useGetPingTemplatesQuery,\n  useUpdatePingTemplateMutation,\n} from '../../store'\nimport { EditPingTemplateDialog } from './edit-ping-template-dialog'\nimport './pings.scss'\n\nexport function ManagePingTemplates(): JSX.Element {\n  const pingTemplates = useGetPingTemplatesQuery()\n  const [addTemplate] = useAddPingTemplateMutation()\n  const [updateTemplate] = useUpdatePingTemplateMutation()\n  const [deleteTemplate] = useDeletePingTemplateMutation()\n\n  const [templateDialogState, setTemplateDialogState] = useState({\n    template: null as ApiPingTemplate | null,\n    show: false,\n  })\n  const editTemplate = (template: ApiPingTemplate) =>\n    setTemplateDialogState({ template, show: true })\n  const addNewTemplate = () => setTemplateDialogState({ template: null, show: true })\n  const cancelEdit = () => setTemplateDialogState({ template: null, show: false })\n\n  const { url } = useRouteMatch()\n  const pingsUrl = url.split('/').slice(0, -1).join('/')\n\n  const confirmEditTemplate = (template: ApiPingTemplateInput) => {\n    if (!templateDialogState.template) {\n      addTemplate(template)\n    } else {\n      updateTemplate({ id: templateDialogState.template.id, template })\n    }\n    cancelEdit()\n  }\n  const deleteEditedTemplate = () => {\n    const { template } = templateDialogState\n    if (!template) {\n      return\n    }\n    deleteTemplate(template.id)\n    cancelEdit()\n  }\n\n  return (<>\n    <div className=\"pings-header\">\n      <h3>Manage Ping Templates</h3>\n      <div style={{ flex: 1 }} />\n      <Link to={pingsUrl} className=\"btn btn-primary\" role=\"button\">\n        <i className=\"bi-arrow-left\" /> Back to Pings\n      </Link>\n      <Button onClick={addNewTemplate}>\n        <i className=\"bi-plus-lg\" /> Add Ping Template\n      </Button>\n    </div>\n    <Table hover size=\"sm\" variant=\"dark\" responsive>\n      <thead>\n        <tr>\n          <th>Name</th>\n          <th>Targeted Channel</th>\n          <th>Groups Allowed to Ping</th>\n          <th>Calendar Support</th>\n          <th>Template</th>\n          <th>Action</th>\n        </tr>\n      </thead>\n      <tbody>\n        {pingTemplates.isFetching &&\n          <tr>\n            <td colSpan={5}>Loading&elipsis;</td>\n          </tr>\n        }\n        {!pingTemplates.isFetching && (pingTemplates.data?.templates.length ?? 0) < 1 &&\n          <tr>\n            <td colSpan={5}>No ping templates defined</td>\n          </tr>\n        }\n        {pingTemplates.data?.templates.map(t => (\n          <tr key={t.id}>\n            <th scope=\"row\">{t.name}</th>\n            <td>{t.slackChannelName}</td>\n            <td>\n              {t.allowedNeucoreGroups.length < 1\n                ? <i>(Everyone)</i>\n                : t.allowedNeucoreGroups.join(', ')\n              }\n            </td>\n            <td>{t.allowScheduling ? 'Yes' : 'No'}</td>\n            <td>\n              {t.template.split('\\n').map((line, i) => (\n                <React.Fragment key={i}>{line}<br /></React.Fragment>\n              ))}\n            </td>\n            <td>\n              <Button size=\"sm\" onClick={() => editTemplate(t)}>\n                <i className=\"bi-pencil\" /> Edit\n              </Button>\n            </td>\n          </tr>\n        ))}\n      </tbody>\n    </Table>\n\n    <EditPingTemplateDialog\n      show={templateDialogState.show}\n      template={templateDialogState.template}\n      onCancel={cancelEdit}\n      onSave={confirmEditTemplate}\n      onDelete={deleteEditedTemplate}\n    />\n  </>)\n}\n","import { ChangeEvent, useEffect } from 'react'\nimport { useState } from 'react'\nimport { Col, Form, Row, RowProps } from 'react-bootstrap'\nimport { Dayjs, dayjs } from '../utils/dayjs'\n\nexport interface DateTimeInputProps extends Omit<RowProps, 'onChange'> {\n  value: Date | string | Dayjs\n  onChange: (date: Dayjs) => void\n}\nexport function DateTimeInput({\n  value: date,\n  onChange,\n  ...rowProps\n}: DateTimeInputProps): JSX.Element {\n  const dateFormat = 'YYYY-MM-DD'\n  const timeFormat = 'HH:mm'\n  const timeBaseDate = '1970-01-01' // Date used for HH:mm calculations\n\n  const [dateInputText, setDateInputText] = useState('')\n  const [timeInputText, setTimeInputText] = useState('')\n\n  useEffect(() => {\n    const propDateTime = dayjs.utc(date)\n\n    const inputDateTime = dayjs.utc(`${dateInputText}T${timeInputText}`)\n    if (!propDateTime.isSame(inputDateTime)) {\n      setDateInputText(propDateTime.format(dateFormat))\n      setTimeInputText(propDateTime.format(timeFormat))\n    }\n  // We only want to run this when the date prop changes, not when the input fields change\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [date])\n\n  const parseDateTime = (date: string, time: string): Dayjs => {\n    const d = dayjs.utc(date)\n    const t = dayjs.duration(\n      dayjs.utc(`${timeBaseDate}T${time}`).diff(dayjs.utc(timeBaseDate))\n    )\n    return d.add(t)\n  }\n\n  const handleDateInputChange = (e: ChangeEvent<HTMLInputElement>) => {\n    const { value } = e.target\n    setDateInputText(value)\n\n    const date = dayjs.utc(value)\n    if (!date.isValid()) {\n      return\n    }\n    const dateTime = parseDateTime(value, timeInputText)\n    if (dateTime.isValid()) {\n      onChange(dateTime)\n    }\n  }\n\n  const handleTimeInputChange = (e: ChangeEvent<HTMLInputElement>) => {\n    const { value } = e.target\n    setTimeInputText(value)\n\n    const time = dayjs.utc(`${timeBaseDate}T${value}`)\n    if (!time.isValid()) {\n      return\n    }\n    const dateTime = parseDateTime(dateInputText, value)\n    if (dateTime.isValid()) {\n      onChange(dateTime)\n    }\n  }\n\n  /** Update the input field values when they lose focus */\n  const handleBlur = () => {\n    let dateTime = parseDateTime(dateInputText, timeInputText)\n    if (!dateTime.isValid()) {\n      dateTime = dayjs(date)\n    }\n    setDateInputText(dateTime.format(dateFormat))\n    setTimeInputText(dateTime.format(timeFormat))\n  }\n\n  return (\n    <Row {...rowProps}>\n      <Form.Group as={Col} controlId=\"date\" xs={6} className=\"mb-3\">\n        <Form.Label className=\"text-nowrap\">Date ({dateFormat})</Form.Label>\n        <Form.Control\n          type=\"date\"\n          value={dateInputText}\n          pattern=\"^[0-9]{4}-[0-9]{2}-[0-9]{2}$\"\n          onChange={handleDateInputChange}\n          onBlur={handleBlur}\n        />\n      </Form.Group>\n      <Form.Group as={Col} controlId=\"time\" xs={6} className=\"mb-3\">\n        <Form.Label className=\"text-nowrap\">Time ({timeFormat})</Form.Label>\n        <Form.Control\n          type=\"text\"\n          maxLength={5}\n          pattern=\"^[0-9]{2}:[0-9]{2}$\"\n          value={timeInputText}\n          onChange={handleTimeInputChange}\n          onBlur={handleBlur}\n        />\n      </Form.Group>\n    </Row>\n  )\n}\n","import { useEffect } from 'react'\nimport { useState } from 'react'\nimport { Col, Form, Row, RowProps } from 'react-bootstrap'\nimport { dayjs, Duration, DurationUnitsObjectType } from '../utils/dayjs'\n\ninterface DurationComponent {\n  label: string\n  unit: keyof DurationUnitsObjectType\n  format: string | ((duration: Duration) => string | number)\n}\nconst defaultDurationComponents: DurationComponent[] = [\n  { label: 'Days', unit: 'days', format: dur => dur.asDays() | 0 },\n  { label: 'Hours', unit: 'hours', format: 'HH' },\n  { label: 'Minutes', unit: 'minutes', format: 'mm' },\n]\n\nexport interface RelativeTimeInputProps extends Omit<RowProps, 'onChange'> {\n  value: Duration\n  onChange: (value: Duration) => void\n  durationComponents?: DurationComponent[]\n}\nexport function RelativeTimeInput({\n  value: duration,\n  onChange,\n  durationComponents = defaultDurationComponents,\n  ...rowProps\n}: RelativeTimeInputProps): JSX.Element {\n  const durationFromTexts = (texts: string[]) => dayjs.duration(Object.fromEntries(\n    durationComponents.map(({ unit }, i) => {\n      const value = parseInt(texts[i], 10)\n      return [unit, isFinite(value) ? value : 0]\n    })\n  ))\n  const textsFromDuration = (duration: Duration) => durationComponents\n    .map(({ format }) => typeof format === 'function'\n      ? `${format(duration)}`\n      : dayjs.duration(duration.asMilliseconds(), 'milliseconds').format(format)\n    )\n\n  const [inputTexts, setInputTexts] = useState(textsFromDuration(duration))\n\n  useEffect(() => {\n    const inputDuration = textsFromDuration(durationFromTexts(inputTexts))\n    const propDuration = textsFromDuration(duration)\n    if (inputDuration.some((c, i) => c !== propDuration[i])) {\n      setInputTexts(textsFromDuration(duration))\n    }\n  // We only want to run this when the duration prop changes, not when the input fields change\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [duration])\n\n  const handleInputTextChange = (index: number, text: string) => {\n    const newTexts = inputTexts.map((t, i) => i === index ? text : t)\n    setInputTexts(newTexts)\n    onChange(durationFromTexts(newTexts))\n  }\n\n  /** Update the input field values when they lose focus */\n  const handleBlur = () => {\n    setInputTexts(textsFromDuration(duration))\n  }\n\n  return (\n    <Row {...rowProps}>\n      {durationComponents.map(({ label }, i) => (\n        <Form.Group key={label} as={Col} xs={12 / durationComponents.length}>\n          <Form.Label>{label}</Form.Label>\n          <Form.Control\n            type=\"number\"\n            pattern=\"^-?[0-9]*$\"\n            value={inputTexts[i]}\n            onChange={e => handleInputTextChange(i, e.target.value)}\n            onBlur={handleBlur}\n          />\n        </Form.Group>\n      ))}\n    </Row>\n  )\n}\n","import { useCallback, useEffect, useState } from 'react'\nimport { dayjs, Dayjs, Duration } from '../utils/dayjs'\n\nexport type TimeInputMode = 'absolute' | 'relative'\nexport interface UseAbsoluteRelativeTimeInputReturn {\n  absoluteTime: Dayjs\n  relativeTime: Duration\n\n  handleChangeInputMode: (mode: TimeInputMode) => void\n  inputMode: TimeInputMode\n\n  handleAbsoluteDateChange: (date: Dayjs) => void\n  handleRelativeDateChange: (relative: Duration) => void\n}\n\ntype AbsoluteOrRelativeTime =\n  | { absolute: Dayjs }\n  | { relative: Duration }\n\nexport interface UseAbsoluteRelativeTimeInputOptions {\n  time: AbsoluteOrRelativeTime\n}\n\nexport function useAbsoluteRelativeTimeInput({\n  time: initialTime,\n}: UseAbsoluteRelativeTimeInputOptions): UseAbsoluteRelativeTimeInputReturn {\n  const [time, setTime] = useState(initialTime)\n\n  const handleChangeInputMode = useCallback((mode: TimeInputMode) => {\n    setTime(time => {\n      if (mode === 'absolute' && 'relative' in time) {\n        return { absolute: dayjs().add(time.relative).utc() }\n      } else if (mode === 'relative' && 'absolute' in time) {\n        return { relative: dayjs.duration(time.absolute.diff(dayjs())) }\n      }\n      return time\n    })\n  }, [])\n\n  const handleAbsoluteDateChange = useCallback((absolute: Dayjs) => setTime({ absolute }), [])\n  const handleRelativeDateChange = useCallback((relative: Duration) => setTime({ relative }), [])\n\n  const [times, setTimes] = useState(calculateTimes(time))\n  useEffect(() => {\n    const updateTimes = () => setTimes(calculateTimes(time))\n    const interval = setInterval(updateTimes, 1000)\n    updateTimes()\n    return () => clearInterval(interval)\n  }, [time])\n\n  return {\n    ...times,\n    handleChangeInputMode,\n    inputMode: 'absolute' in time ? 'absolute' : 'relative',\n    handleAbsoluteDateChange,\n    handleRelativeDateChange,\n  }\n}\n\nfunction calculateTimes(time: AbsoluteOrRelativeTime): {\n  absoluteTime: Dayjs\n  relativeTime: Duration\n} {\n  return {\n    absoluteTime: 'absolute' in time ? time.absolute : dayjs().add(time.relative).utc(),\n    relativeTime: 'relative' in time ? time.relative : dayjs.duration(time.absolute.diff(dayjs())),\n  }\n}\n","import { ApiPingTemplate } from '@ping-board/common'\nimport clsx from 'clsx'\nimport { ChangeEvent, useEffect, useState } from 'react'\nimport { Alert, Button, Col, Form, ListGroup, Modal, Row, Spinner } from 'react-bootstrap'\nimport { Prompt } from 'react-router-dom'\nimport { DateTimeInput } from '../../components/date-time-input'\nimport { RelativeTimeInput } from '../../components/relative-time-input'\nimport { useAbsoluteRelativeTimeInput } from '../../hooks/use-absolute-relative-time-input'\nimport { useGetPingTemplatesQuery, useAddPingMutation } from '../../store'\nimport { dayjs } from '../../utils/dayjs'\nimport './send-pings.scss'\n\nexport function SendPings(): JSX.Element {\n  const pingTemplates = useGetPingTemplatesQuery()\n  const [postPing, postPingState] = useAddPingMutation()\n\n  const [addPingToCalendar, setAddPingToCalendar] = useState(false)\n  const timeInput = useAbsoluteRelativeTimeInput({\n    time: { relative: dayjs.duration(0) },\n  })\n  const [calendarEntryTitle, setCalendarEntryTitle] = useState('')\n\n  const [selectedTemplate, setSelectedTemplate] = useState<ApiPingTemplate | null>(null)\n  const [pingText, setPingText] = useState<string>('')\n  const [pingTextModified, setPingTextModified] = useState(false)\n  const handlePingTextChange = (e: ChangeEvent<HTMLInputElement>) => {\n    setPingText(e.target.value)\n    setPingTextModified(true)\n  }\n\n  const oldTextSeparator = '\\n\\n--- old text ---\\n\\n'\n  const handlePingGroupChange = (template: ApiPingTemplate) => {\n    setSelectedTemplate(template ?? null)\n    if (!template) {\n      return\n    }\n    const [currentText, oldText] = pingText.split(oldTextSeparator, 2)\n    if (currentText === selectedTemplate?.template || currentText === '') {\n      if (oldText) {\n        setPingText(template.template + oldTextSeparator + oldText)\n        setPingTextModified(true)\n      } else {\n        setPingText(template.template)\n        setPingTextModified(false)\n      }\n    } else if (currentText !== template.template) {\n      setPingText(template.template + oldTextSeparator + currentText)\n      setPingTextModified(true)\n    } else {\n      setPingText(template.template)\n      setPingTextModified(false)\n    }\n  }\n\n  const [showSendingDialog, setShowSendingDialog] = useState(false)\n  const [sendDialogClosing, setSendDialogClosing] = useState(false)\n  useEffect(() => {\n    if (showSendingDialog && !sendDialogClosing && !postPingState.isLoading) {\n      setSendDialogClosing(true)\n      setTimeout(() => {\n        setShowSendingDialog(false)\n        setSendDialogClosing(false)\n      }, 2000)\n      setPingTextModified(!postPingState.isSuccess)\n    }\n  }, [postPingState.isLoading, postPingState.isSuccess, sendDialogClosing, showSendingDialog])\n\n  const canSend = (\n    selectedTemplate &&\n    pingText !== selectedTemplate?.template &&\n    pingText !== '' &&\n    pingText.indexOf(oldTextSeparator) === -1\n  )\n\n  const sendPing = () => {\n    if (canSend && selectedTemplate && pingText) {\n      postPing({\n        templateId: selectedTemplate.id,\n        text: pingText,\n        ...selectedTemplate.allowScheduling && addPingToCalendar ? {\n          scheduledTitle: calendarEntryTitle,\n          scheduledFor: timeInput.absoluteTime.toISOString(),\n        } : {},\n      })\n      setShowSendingDialog(true)\n    }\n  }\n\n  return (\n    <Form className=\"send-pings\">\n      <Prompt\n        when={pingTextModified}\n        message=\"You haven't sent your ping yet. Are you sure you want to leave?\"\n      />\n\n      <Row>\n        <Col xs={12}>\n          <Alert variant=\"warning\">\n            <i className=\"bi-exclamation-triangle\" />{' '}\n            If you send <b>bad pings</b> you <b>will be banned from sending pings</b>. Use the\n            template, if possible. Also, <b>don&apos;t spam newlines and emoji in your pings or\n            you&apos;ll have your ping rights revoked</b>. Make sure you send your pings to the\n            correct group. Some groups are meant for emergencies, don&apos;t randomly ping them.\n            Just use it responsibly.\n          </Alert>\n        </Col>\n\n        <Form.Group as={Col} xs={12} md={4} className=\"mb-3\">\n          <Form.Label>Send Ping to Group:</Form.Label>\n          <ListGroup>\n            {pingTemplates.data?.templates.map(t => (\n              <ListGroup.Item key={t.id}\n                type=\"button\"\n                action\n                active={t === selectedTemplate}\n                onClick={() => handlePingGroupChange(t)}\n              >\n                {t.name} (#{t.slackChannelName})\n              </ListGroup.Item>\n            ))}\n          </ListGroup>\n        </Form.Group>\n\n        <Col as={Row} xs={12} md={8} className=\"mb-3 px-0\">\n          {!!selectedTemplate?.allowScheduling && (<>\n            <Form.Group as={Col} controlId=\"schedule\" xs={12} className=\"mb-3 pe-0\">\n              <Form.Label>Ping Options</Form.Label>\n              <Form.Check\n                checked={addPingToCalendar}\n                onChange={() => setAddPingToCalendar(add => !add)}\n                label=\"Add this Ping to the Calendar\"\n              />\n            </Form.Group>\n\n            {addPingToCalendar && (<>\n              <Form.Group as={Col} controlid=\"calendarTitle\" xs={12} className=\"mb-3 pe-0\">\n                <Form.Label>Calendar Entry Title</Form.Label>\n                <Form.Control\n                  value={calendarEntryTitle}\n                  onChange={e => setCalendarEntryTitle(e.target.value)}\n                />\n              </Form.Group>\n\n              <Col xs={12} className=\"pe-0\">\n                <Form.Label>Calendar Time</Form.Label>\n              </Col>\n\n              <Form.Group as={Col} controlId=\"eveDateTime\" xs={12} lg={6} className=\"pe-0\">\n                <Form.Label>\n                  <Form.Check\n                    inline\n                    label=\"Use EVE Date and Time\"\n                    name=\"eveDateTimeMode\"\n                    type=\"radio\"\n                    onChange={() => timeInput.handleChangeInputMode('absolute')}\n                    id=\"absolute\"\n                    checked={timeInput.inputMode === 'absolute'}\n                  />\n                </Form.Label>\n                <DateTimeInput\n                  value={timeInput.absoluteTime}\n                  onChange={timeInput.handleAbsoluteDateChange}\n                  className={clsx(\n                    'time-mode-input',\n                    timeInput.inputMode !== 'absolute' && 'inactive-time-mode')}\n                />\n              </Form.Group>\n\n              <Form.Group as={Col} controlId=\"relativeTime\" xs={12} lg={6} className=\"mb-3 pe-0\">\n                <Form.Label>\n                  <Form.Check\n                    inline\n                    label=\"Use Relative Time\"\n                    name=\"eveDateTimeMode\"\n                    type=\"radio\"\n                    onChange={() => timeInput.handleChangeInputMode('relative')}\n                    id=\"relative\"\n                    checked={timeInput.inputMode === 'relative'}\n                  />\n                </Form.Label>\n                <RelativeTimeInput\n                  value={timeInput.relativeTime}\n                  onChange={timeInput.handleRelativeDateChange}\n                  className={clsx(\n                    'time-mode-input',\n                    timeInput.inputMode !== 'relative' && 'inactive-time-mode'\n                  )}\n                />\n              </Form.Group>\n            </>)}\n\n            {/* <div className=\"pe-0\"><hr className=\"mt-0\" /></div> */}\n          </>)}\n\n          <Form.Group as={Col} xs={12} className=\"mb-3 pe-0\">\n            <Form.Label>Ping Text:</Form.Label>\n            <Form.Control\n              as=\"textarea\"\n              rows={15}\n              disabled={!selectedTemplate}\n              placeholder={selectedTemplate ? '' : 'Please select a channel first.'}\n              value={selectedTemplate ? pingText : ''}\n              onChange={handlePingTextChange}\n            />\n          </Form.Group>\n\n          <Col xs={12} className=\"d-flex justify-content-end pe-0\">\n            <Button variant=\"danger\" disabled={!canSend} onClick={sendPing}>\n              Send Ping\n            </Button>\n          </Col>\n        </Col>\n\n        <Modal show={showSendingDialog} size=\"sm\" backdrop=\"static\">\n          <Modal.Body className=\"fs-5\">\n            {postPingState.isLoading && <>\n              <Spinner animation=\"border\" role=\"status\" size=\"sm\">\n                <span className=\"visually-hidden\">Sending&hellip;</span>\n              </Spinner>{' '}\n              Sending&hellip;\n            </>}\n            {!postPingState.isLoading && postPingState.isError &&\n              <span className=\"text-danger\">\n                <i className=\"bi-exclamation-circle\" /> Failed to send ping\n              </span>\n            }\n            {!postPingState.isLoading && postPingState.isSuccess &&\n              <span className=\"text-success\">\n                <i className=\"bi-check-circle\" /> Ping sent\n              </span>\n            }\n          </Modal.Body>\n        </Modal>\n      </Row>\n    </Form>\n  )\n}\n","import { UserRoles } from '@ping-board/common'\nimport { Alert, Button, Col, Row, Table } from 'react-bootstrap'\nimport { Link, useRouteMatch } from 'react-router-dom'\nimport { Time } from '../../components/time'\nimport { useGetUserQuery } from '../../store'\nimport './pings.scss'\nimport './sent-pings.scss'\nimport { usePingsList } from './use-pings-list'\n\nexport function SentPings(): JSX.Element {\n  const me = useGetUserQuery()\n\n  const canRead = me.data?.isLoggedIn && me.data?.character.roles.includes(UserRoles.PING)\n  const canEdit = me.data?.isLoggedIn &&\n    me.data.character.roles.includes(UserRoles.PING_TEMPLATES_WRITE)\n\n  const pings = usePingsList({ skip: me.isLoading || !canRead })\n\n  const { url } = useRouteMatch()\n  const pingsUrl = url.split('/').slice(0, -1).join('/')\n\n  return (<>\n    <div className=\"pings-header\">\n      <h3>Sent Pings</h3>\n      <Button onClick={pings.reload} disabled={pings.loading}>\n        <i className=\"bi-arrow-clockwise\" /> Reload\n      </Button>\n      <div style={{ flex: 1 }} />\n      <Link to={pingsUrl} className=\"btn btn-primary\" role=\"button\">\n        <i className=\"bi-arrow-left\" /> Back to Pings\n      </Link>\n      {canEdit &&\n        <Link to={`${pingsUrl}/view-access`} className=\"btn btn-primary\" role=\"button\">\n          <i className=\"bi-wrench\" /> Manage View Access\n        </Link>\n      }\n    </div>\n    <Row>\n      <Col xs={12}>\n        <Alert variant=\"info\">\n          These Pings were either sent by you, or were sent to channels you have view access to.\n          View access is determined by your Neucore groups, not which Slack channels you are in.\n        </Alert>\n      </Col>\n      <Col xs={12}>\n        <Table hover size=\"sm\" variant=\"dark\" responsive className=\"sent-pings-table\">\n          <thead>\n            <tr>\n              <th>Author</th>\n              <th>Sent at</th>\n              <th>Sent to</th>\n              <th>Text</th>\n            </tr>\n          </thead>\n          <tbody>\n            {pings.pings.length < 1 &&\n              <tr>\n                <td colSpan={4}>No Pings to show</td>\n              </tr>\n            }\n            {pings.pings.map(p => (\n              <tr key={p.id}>\n                <td>{p.author}</td>\n                <td><Time time={p.sentAt} format=\"YYYY-MM-DD HH:mm\" /></td>\n                <td>{p.slackChannelName}</td>\n                <td className=\"text-cell\">\n                  <div title={p.text}>\n                    {p.text}\n                  </div>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </Table>\n\n        <Button\n          style={{ width: '100%' }}\n          disabled={!pings.hasMore || pings.loading}\n          onClick={pings.loadMore}\n        >\n          {pings.loading\n            ? 'Loading…'\n            : pings.hasMore\n              ? 'Load more'\n              : '(No more pings)'\n          }\n        </Button>\n      </Col>\n    </Row>\n  </>)\n}\n","import { ApiPing } from '@ping-board/common'\nimport { useEffect } from 'react'\nimport { useAppDispatch, useAppSelector } from '../../hooks/redux'\nimport {\n  loadMorePings,\n  reloadPings,\n  selectHasMorePings,\n  selectIsLoadingPings,\n  selectPings,\n} from '../../store/pings-list-slice'\n\nexport interface UsePingsListResult {\n  pings: ApiPing[]\n  loading: boolean\n  hasMore: boolean\n  loadMore: () => void\n  reload: () => void\n}\nexport interface UsePingsListOptions {\n  skip?: boolean\n}\nexport function usePingsList({\n  skip,\n}: UsePingsListOptions = {}): UsePingsListResult {\n  const dispatch = useAppDispatch()\n  const pings = useAppSelector(selectPings)\n  const loading = useAppSelector(selectIsLoadingPings)\n  const hasMore = useAppSelector(selectHasMorePings)\n\n  const loadMore = () => dispatch(loadMorePings())\n  const reload = () => dispatch(reloadPings())\n\n  useEffect(() => {\n    if (skip !== true) {\n      dispatch(reloadPings())\n    }\n  }, [dispatch, skip])\n\n  return {\n    pings,\n    loading,\n    hasMore,\n    loadMore,\n    reload,\n  }\n}\n","import { ChangeEvent, useMemo, useState } from 'react'\nimport { Alert, Button, Col, Form, ListGroup, Row, Table } from 'react-bootstrap'\nimport { Link, useRouteMatch } from 'react-router-dom'\nimport {\n  useGetAvailableNeucoreGroupsQuery,\n  useGetPingChannelsQuery,\n  useGetPingViewPermissionsQuery,\n  useUpdatePingViewPermissionsByNeucoreGroupMutation,\n} from '../../store'\n\nexport function ManagePingViewAccess(): JSX.Element {\n  const { url } = useRouteMatch()\n  const sentPingsUrl = url.split('/').slice(0, -1).join('/') + '/sent'\n\n  const viewPermissionsQuery = useGetPingViewPermissionsQuery()\n  const viewPermissions = useMemo(() => (viewPermissionsQuery.data?.viewPermissions ?? []).reduce(\n    (byGroup, { neucoreGroup, ...rest }) => byGroup.set(\n      neucoreGroup,\n      [...byGroup.get(neucoreGroup) ?? [], rest].sort(\n        (a, b) => a.slackChannelName.localeCompare(b.slackChannelName)\n      )\n    ),\n    new Map<string, { slackChannelId: string, slackChannelName: string }[]>()\n  ), [viewPermissionsQuery.data?.viewPermissions])\n\n  const [selectedGroup, setSelectedGroup] = useState<string | null>(null)\n  const selectableGroups = [\n    ...viewPermissions.keys(),\n    ...selectedGroup && !viewPermissions.has(selectedGroup) ? [selectedGroup] : [],\n  ].sort()\n  const handleGroupChange = (e: ChangeEvent<HTMLSelectElement>) => {\n    setSelectedGroup(e.target.value || null)\n  }\n\n  const allGroups = useGetAvailableNeucoreGroupsQuery()\n  const remainingGroups = (allGroups.data?.neucoreGroups ?? [])\n    .filter(g => !viewPermissions.has(g.name) && g.name !== selectedGroup)\n    .map(g => g.name)\n\n  const channels = useGetPingChannelsQuery()\n  const remainingChannels = (channels.data?.channels ?? [])\n    .filter(c => (selectedGroup && viewPermissions.get(selectedGroup) || [])\n      .every(cc => cc.slackChannelName !== c.name)\n    )\n\n  const [\n    setGroupChannels,\n    setGroupChannelsState,\n  ] = useUpdatePingViewPermissionsByNeucoreGroupMutation()\n  const handleChannelSelected = (e: ChangeEvent<HTMLSelectElement>) => {\n    if (!selectedGroup) {\n      return\n    }\n    setGroupChannels({\n      neucoreGroup: selectedGroup,\n      allowedSlackChannelIds: [\n        ...(viewPermissions.get(selectedGroup) ?? []).map(g => g.slackChannelId),\n        e.target.value,\n      ],\n    })\n  }\n  const handleRemoveChannel = (channelId: string) => {\n    if (!selectedGroup) {\n      return\n    }\n    setGroupChannels({\n      neucoreGroup: selectedGroup,\n      allowedSlackChannelIds: (viewPermissions.get(selectedGroup) ?? [])\n        .map(g => g.slackChannelId)\n        .filter(g => g !== channelId),\n    })\n  }\n\n  const isLoading =\n    viewPermissionsQuery.isFetching ||\n    allGroups.isFetching ||\n    channels.isFetching ||\n    setGroupChannelsState.isLoading\n\n  return (<>\n    <div className=\"pings-header\">\n      <h3>Manage Ping View Access</h3>\n      <div style={{ flex: 1 }} />\n      <Link to={sentPingsUrl} className=\"btn btn-primary\" role=\"button\">\n        <i className=\"bi-arrow-left\" /> Back to Sent Pings\n      </Link>\n    </div>\n    <Row>\n      <Form.Group as={Col} controlId=\"neucoreGroup\" xs={12} md={4} className=\"mb-3\">\n        <Form.Label>Neucore Group</Form.Label>\n        {selectableGroups.length < 1 && (isLoading\n          ? <Alert variant=\"info\" className=\"mb-2 py-2\">\n              Loading&hellip;\n            </Alert>\n          : <Alert variant=\"warning\" className=\"mb-2 py-2\">\n              No view permissions defined.\n            </Alert>\n        )}\n        {selectableGroups.length > 0 &&\n          <ListGroup className=\"mb-2\">\n            {selectableGroups.map(g => (\n              <ListGroup.Item key={g}\n                type=\"button\"\n                action\n                active={g === selectedGroup}\n                onClick={() => setSelectedGroup(g)}\n                disabled={isLoading}\n              >\n                {g}\n              </ListGroup.Item>\n            ))}\n          </ListGroup>\n        }\n        <Form.Select\n          value={selectedGroup ?? ''}\n          onChange={handleGroupChange}\n          disabled={isLoading || remainingGroups.length < 1}\n        >\n          {isLoading &&\n            <option value=\"\">Loading&hellip;</option>\n          }\n          {!isLoading && (remainingGroups.length > 0\n            ? <option value=\"\">(Select a group to add)</option>\n            : <option value=\"\">No more groups to add</option>\n          )}\n          {!isLoading && remainingGroups.map(g => (\n            <option key={g} value={g}>{g}</option>\n          ))}\n        </Form.Select>\n      </Form.Group>\n\n      <Form.Group as={Col} controlId=\"slackGroups\" xs={12} md={8}>\n        <Form.Label>Can see pings sent to</Form.Label>\n        <Table variant=\"dark\">\n          <thead>\n            <tr>\n              <th className=\"w-100\">Slack Channel</th>\n              <th>Action</th>\n            </tr>\n          </thead>\n          <tbody>\n            {!selectedGroup && (\n              <tr>\n                <td colSpan={2}>(Please select a group to manage first)</td>\n              </tr>\n            )}\n            {selectedGroup && <>\n              {!viewPermissions.get(selectedGroup)?.length && (\n                <tr>\n                  <td colSpan={2}>\n                    <Alert variant=\"info\" className=\"mb-0 py-2\">\n                      Members of this group cannot view any{' '}\n                      pings other than those they sent themselves.\n                    </Alert>\n                  </td>\n                </tr>\n              )}\n              {viewPermissions.get(selectedGroup)?.map(p => (\n                <tr key={p.slackChannelId}>\n                  <td className=\"align-middle\">{p.slackChannelName}</td>\n                  <td>\n                    <Button\n                      size=\"sm\"\n                      className=\"text-nowrap\"\n                      onClick={() => handleRemoveChannel(p.slackChannelId)}\n                      disabled={isLoading}\n                    >\n                      <i className=\"bi-trash-fill\" /> Remove\n                    </Button>\n                  </td>\n                </tr>\n              ))}\n              {remainingChannels.length > 0 && (\n                <tr>\n                  <td colSpan={2}>\n                    <Form.Select\n                      value=\"\"\n                      onChange={handleChannelSelected}\n                      disabled={isLoading}\n                    >\n                      <option value=\"\">(Select a channel to add)</option>\n                      {!isLoading && remainingChannels.map(c => (\n                        <option key={c.id} value={c.id}>{c.name}</option>\n                      ))}\n                    </Form.Select>\n                  </td>\n                </tr>\n              )}\n            </>}\n          </tbody>\n        </Table>\n      </Form.Group>\n    </Row>\n  </>)\n}\n","import { UserRoles } from '@ping-board/common'\nimport { Container } from 'react-bootstrap'\nimport { Link, Redirect, Route, Switch, useRouteMatch } from 'react-router-dom'\nimport { useGetUserQuery } from '../../store'\nimport { ManagePingTemplates } from './manage-ping-templates'\nimport { SendPings } from './send-pings'\nimport { SentPings } from './sent-pings'\nimport { ManagePingViewAccess } from './manage-view-access'\nimport './pings.scss'\n\nexport function PingsPage(): JSX.Element {\n  const me = useGetUserQuery()\n\n  const canRead = me.data?.isLoggedIn && me.data.character.roles.includes(UserRoles.PING)\n  const canEdit = me.data?.isLoggedIn &&\n    me.data.character.roles.includes(UserRoles.PING_TEMPLATES_WRITE)\n\n  const { path, url } = useRouteMatch()\n\n  if (!me.isFetching) {\n    if (!me.data?.isLoggedIn) {\n      return <Redirect to={`/login?postLoginRedirect=${url}`} />\n    }\n    if (!canRead) {\n      return (\n        <Container fluid>\n          <h6>Sorry, you don&apos;t have permission to view this page.</h6>\n        </Container>\n      )\n    }\n  }\n\n  return (\n    <Container>\n      <Switch>\n        <Route exact path={path}>\n          <div className=\"pings-header\">\n            <h3>Send Pings</h3>\n            <Link to={`${url}/sent`} className=\"btn btn-primary\" role=\"button\">\n              Show Sent Pings\n            </Link>\n            <div style={{ flex: 1 }} />\n            {canEdit &&\n              <Link to={`${url}/templates`} className=\"btn btn-primary\" role=\"button\">\n                <i className=\"bi-wrench\" /> Manage Ping Templates\n              </Link>\n            }\n          </div>\n          <SendPings />\n        </Route>\n        <Route path={`${path}/sent`}>\n          <SentPings />\n        </Route>\n        {canEdit && <>\n          <Route path={`${path}/templates`}>\n            <ManagePingTemplates />\n          </Route>\n          <Route path={`${path}/view-access`}>\n            <ManagePingViewAccess />\n          </Route>\n        </>}\n      </Switch>\n    </Container>\n  )\n}\n","import { ApiEventEntry, ApiEventEntryInput } from '@ping-board/common'\nimport clsx from 'clsx'\nimport { ChangeEvent, useEffect, useState } from 'react'\nimport { Button, Col, Form, Modal, Row } from 'react-bootstrap'\nimport { DateTimeInput } from '../../components/date-time-input'\nimport { RelativeTimeInput } from '../../components/relative-time-input'\nimport { useAbsoluteRelativeTimeInput } from '../../hooks/use-absolute-relative-time-input'\nimport { dayjs } from '../../utils/dayjs'\nimport './edit-event-dialog.scss'\n\ntype EditedEvent = Omit<ApiEventEntryInput, 'time'>\n\nconst priorities = ['Low', 'Medium', 'High', 'Critical']\nconst structureTypes: [value: string, title: string][] = [\n  ['TCU', 'TCU'],\n  ['IHub', 'IHub'],\n  ['POS', 'POS'],\n  ['POCO', 'POCO'],\n  ['Raitaru', 'Raitaru'],\n  ['Azbel', 'Azbel'],\n  ['Sotiyo', 'Sotiyo'],\n  ['Athanor', 'Athanor'],\n  ['Tatara', 'Tatara'],\n  ['Astrahus', 'Astrahus'],\n  ['Fortizar', 'Fortizar'],\n  ['Keepstar', 'Keepstar'],\n  ['Pharolynx', 'Pharolynx Cyno Beacon'],\n  ['Tenebrex', 'Tenebrex Cyno Jammer'],\n  ['Ansiblex', 'Ansiblex Jump Gate'],\n  ['other', 'other'],\n]\nconst eventTypes = ['Anchoring', 'Shield', 'Armor', 'Structure', 'other']\nconst standings = ['friendly', 'enemy', 'neutral', 'other']\nconst result = ['No data', 'Win', 'Loss']\n\nexport interface EditEventDialogProps {\n  show: boolean\n  event?: ApiEventEntry | null\n  onSave?: (event: ApiEventEntryInput) => void\n  onCancel?: () => void\n  onDelete?: () => void\n}\nexport function EditEventDialog({\n  show,\n  event,\n  onSave,\n  onCancel,\n  onDelete,\n}: EditEventDialogProps): JSX.Element {\n  const [editedEvent, setEditedEvent] = useState<EditedEvent>(getDefaultEditedEvent())\n  useEffect(() => setEditedEvent(event\n    ? { ...event }\n    : getDefaultEditedEvent()\n  ), [event])\n\n  const timeInput = useAbsoluteRelativeTimeInput({\n    time: event\n      ? { absolute: dayjs.utc(event.time) }\n      : { relative: dayjs.duration(0) },\n  })\n\n  const canSave = Object.entries(editedEvent ?? {}).every(([k, v]) => k === 'notes' || !!v)\n  const save = () => {\n    if (canSave && onSave) {\n      onSave({\n        ...editedEvent,\n        time: timeInput.absoluteTime.toISOString(),\n      })\n      setEditedEvent(getDefaultEditedEvent())\n    }\n  }\n\n  const isNewEvent = typeof event?.id !== 'number'\n  const lastEdited = !isNewEvent && [\n    `Last edited by ${event?.updatedBy ?? 'unknown'}`,\n    event?.updatedAt\n      ? `at ${dayjs(event.updatedAt).format('llll')} (${dayjs(event.updatedAt).fromNow()})`\n      : 'unknown',\n  ].join(' ')\n  const usesAbsoluteTime = timeInput.inputMode === 'absolute'\n\n  const setEventField = <T extends keyof EditedEvent>(field: T, value: EditedEvent[T]) => {\n    setEditedEvent(e => ({ ...e, [field]: value }))\n  }\n\n  type ValueKeys<T, V> = { [K in keyof T]: T[K] extends V ? T[K] : never }\n  const handleSelectValueChange = <T extends keyof ValueKeys<EditedEvent, string>>(field: T) =>\n    (e: ChangeEvent<HTMLSelectElement>) => setEventField(field, e.target.value as EditedEvent[T])\n\n  const [isDeletePending, setIsDeletePending] = useState(false)\n  const handleStartDelete = () => setIsDeletePending(true)\n  const handleCancelDelete = () => setIsDeletePending(false)\n  const handleConfirmDelete = () => {\n    setIsDeletePending(false)\n    onDelete?.()\n    setEditedEvent(getDefaultEditedEvent())\n  }\n\n  return (\n    <Modal show={show} size=\"lg\" backdrop=\"static\" dialogClassName=\"edit-event-dialog\">\n      <Modal.Header>\n        <Modal.Title>{isNewEvent ? 'Add' : 'Edit'} Event</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <Form>\n          <Row>\n            {lastEdited && <Col xs={12} className=\"mb-3\">{lastEdited}</Col>}\n\n            <Form.Group as={Col} controlId=\"solarSystem\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Solar System</Form.Label>\n              <Form.Control\n                type=\"text\"\n                placeholder=\"e.g. NBPH-N\"\n                value={editedEvent.system}\n                onChange={e => setEventField('system', e.target.value)}\n              />\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"priority\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Priority</Form.Label>\n              <Form.Select\n                value={editedEvent.priority}\n                onChange={handleSelectValueChange('priority')}\n              >\n                <option value=\"\">(Please Select)</option>\n                {priorities.map(prio => (\n                  <option key={prio} value={prio}>\n                    {prio}\n                  </option>\n                ))}\n              </Form.Select>\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"structure\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Structure</Form.Label>\n              <Form.Select\n                value={editedEvent.structure}\n                onChange={handleSelectValueChange('structure')}\n              >\n                <option value=\"\">(Please Select)</option>\n                {structureTypes.map(([value, title]) => (\n                  <option key={value} value={value}>\n                    {title}\n                  </option>\n                ))}\n              </Form.Select>\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"type\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Type</Form.Label>\n              <Form.Select\n                value={editedEvent.type}\n                onChange={handleSelectValueChange('type')}\n              >\n                <option value=\"\">(Please Select)</option>\n                {eventTypes.map(type => (\n                  <option key={type} value={type}>\n                    {type}\n                  </option>\n                ))}\n              </Form.Select>\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"standing\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Standing</Form.Label>\n              <Form.Select\n                value={editedEvent.standing}\n                onChange={handleSelectValueChange('standing')}\n              >\n                <option value=\"\">(Please Select)</option>\n                {standings.map(type => (\n                  <option key={type} value={type}>\n                    {type}\n                  </option>\n                ))}\n              </Form.Select>\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"result\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Result</Form.Label>\n              <Form.Select\n                value={editedEvent.result}\n                onChange={handleSelectValueChange('result')}\n              >\n                {result.map(type => (\n                  <option key={type} value={type}>\n                    {type}\n                  </option>\n                ))}\n              </Form.Select>\n            </Form.Group>\n\n            <Col xs={12}>\n              <Form.Label>Event Time</Form.Label>\n            </Col>\n\n            <Form.Group as={Col} controlId=\"eveDateTime\" xs={12} lg={6}>\n              <Form.Label>\n                <Form.Check\n                  inline\n                  label=\"Use EVE Date and Time\"\n                  name=\"eveDateTimeMode\"\n                  type=\"radio\"\n                  onChange={() => timeInput.handleChangeInputMode('absolute')}\n                  id=\"absolute\"\n                  checked={usesAbsoluteTime}\n                />\n              </Form.Label>\n              <DateTimeInput\n                value={timeInput.absoluteTime}\n                onChange={timeInput.handleAbsoluteDateChange}\n                className={clsx('time-mode-input', !usesAbsoluteTime && 'inactive-time-mode')}\n              />\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"relativeTime\" xs={12} lg={6}>\n              <Form.Label>\n                <Form.Check\n                  inline\n                  label=\"Use Relative Time\"\n                  name=\"eveDateTimeMode\"\n                  type=\"radio\"\n                  onChange={() => timeInput.handleChangeInputMode('relative')}\n                  id=\"relative\"\n                  checked={!usesAbsoluteTime}\n                />\n              </Form.Label>\n              <RelativeTimeInput\n                value={timeInput.relativeTime}\n                onChange={timeInput.handleRelativeDateChange}\n                className={clsx('time-mode-input', usesAbsoluteTime && 'inactive-time-mode')}\n              />\n            </Form.Group>\n\n            {/*\n              Show a horizontal divider on smaller screens (≤ md) to make it more obvious that\n              the inputs below are not affected by the absolute/relative time radio buttons\n            */}\n            <Col xs={12} className=\"d-block d-lg-none\">\n              <hr />\n            </Col>\n\n            <Form.Group as={Col} controlId=\"notes\" xs={12} className=\"mb-3\">\n              <Form.Label>Notes</Form.Label>\n              <Form.Control\n                as=\"textarea\"\n                rows={1}\n                value={editedEvent?.notes ?? ''}\n                onChange={e => setEventField('notes', e.target.value)}\n              />\n            </Form.Group>\n          </Row>\n        </Form>\n      </Modal.Body>\n      <Modal.Footer className=\"dialog-footer\">\n        <div className={clsx('dialog-buttons-wrapper', isDeletePending && 'hidden')}>\n          {!isNewEvent && (\n            <>\n              <Button\n                variant=\"danger\"\n                disabled={isDeletePending}\n                onClick={handleStartDelete}\n              >\n                Delete\n              </Button>\n              <div className=\"dialog-buttons-spacer\" />\n            </>\n          )}\n          <Button variant=\"secondary\" onClick={onCancel} disabled={isDeletePending}>\n            Cancel\n          </Button>\n          <Button variant=\"primary\" disabled={!canSave || isDeletePending} onClick={save}>\n            Save\n          </Button>\n        </div>\n        {!isNewEvent && (\n          <div className={clsx(\n            'confirm-delete-buttons-wrapper',\n            !isDeletePending && 'hidden'\n          )}>\n            <Button disabled={!isDeletePending} onClick={handleCancelDelete}>\n              No\n            </Button>\n            <div className=\"dialog-buttons-spacer\">\n              Are you sure you want to delete the event?\n            </div>\n            <Button variant=\"danger\" disabled={!isDeletePending} onClick={handleConfirmDelete}>\n              Yes\n            </Button>\n          </div>\n        )}\n      </Modal.Footer>\n    </Modal>\n  )\n}\n\nfunction getDefaultEditedEvent(): EditedEvent {\n  return {\n    system: '',\n    priority: '',\n    structure: '',\n    type: '',\n    standing: '',\n    result: 'No data',\n    notes: '',\n  }\n}\n","import { ApiEventEntry } from '@ping-board/common'\nimport clsx from 'clsx'\nimport dayjs from 'dayjs'\nimport { Button, Table } from 'react-bootstrap'\nimport { RegionLink } from '../../components/region-link'\nimport { RelativeTime } from '../../components/relative-time'\nimport { SolarSystemLink } from '../../components/solar-system-link'\nimport { Time } from '../../components/time'\nimport './events-table.scss'\n\nexport interface EventsTableProps {\n  showResultColumn?: boolean\n  canEdit?: boolean\n  onEdit?: (event: ApiEventEntry) => void\n  events: ApiEventEntry[]\n}\nexport function EventsTable({\n  showResultColumn = false,\n  canEdit = false,\n  onEdit,\n  events,\n}: EventsTableProps): JSX.Element {\n  const getRowClass = (event: ApiEventEntry): string => {\n    const time = Date.parse(event.time)\n    const now = Date.now()\n    if (Math.abs(time - now) < 1000 * 60 * 60) {\n      return 'present'\n    }\n    return time > now ? 'future' : 'past'\n  }\n\n  return (\n    <Table hover size=\"sm\" variant=\"dark\" responsive className=\"events-table\">\n      <thead>\n        <tr className=\"events-header-row\">\n          <th>System</th>\n          <th>Region</th>\n          <th>Priority</th>\n          <th>Structure</th>\n          <th>Type</th>\n          <th>Standing</th>\n          <th>Relative Time</th>\n          <th>Local Time</th>\n          <th>EVE Time</th>\n          {showResultColumn && <th>Result</th>}\n          <th>Notes</th>\n          {canEdit && <th>Action</th>}\n        </tr>\n      </thead>\n      <tbody>\n        {events.length === 0 && (\n          <tr>\n            <td colSpan={10 + (+showResultColumn) + (+canEdit)}>\n              No Events\n            </td>\n          </tr>\n        )}\n        {events.map(event => (\n          <tr key={event.id} className={clsx('event-row', getRowClass(event))}>\n            <th scope=\"row\"><SolarSystemLink system={event.system} /></th>\n            <td><RegionLink system={event.system} region={event.region} /></td>\n            <td>{event.priority}</td>\n            <td>{event.structure}</td>\n            <td>{event.type}</td>\n            <td>{event.standing}</td>\n            <td><RelativeTime time={event.time} /></td>\n            <td><Time time={event.time} /></td>\n            <td><Time time={dayjs(event.time).utc()} format=\"YYYY-MM-DD HH:mm\" asLink /></td>\n            {showResultColumn && (\n              <td>{event.result}</td>\n            )}\n            <td className=\"event-notes\">{event.notes}</td>\n            {canEdit && (\n              <td>\n                <Button size=\"sm\" onClick={() => onEdit?.(event)}>\n                  <i className=\"bi-pencil\" /> Edit\n                </Button>\n              </td>\n            )}\n          </tr>\n        ))}\n      </tbody>\n    </Table>\n  )\n}\n","import { ApiEventEntry, ApiEventEntryInput, UserRoles } from '@ping-board/common'\nimport { useEffect, useState } from 'react'\nimport { Button, Container } from 'react-bootstrap'\nimport { Redirect, useRouteMatch } from 'react-router-dom'\nimport {\n  useAddEventMutation,\n  useDeleteEventMutation,\n  useGetUserQuery,\n  useUpdateEventMutation,\n} from '../../store'\nimport { EditEventDialog } from './edit-event-dialog'\nimport { EventsTable } from './events-table'\nimport './timers.scss'\nimport { useEventsList } from './use-events-list'\n\nexport function TimersPage(): JSX.Element {\n  const me = useGetUserQuery()\n\n  const canEdit = me.data?.isLoggedIn && me.data.character.roles.includes(UserRoles.EVENTS_WRITE)\n  const canRead = me.data?.isLoggedIn && me.data.character.roles.includes(UserRoles.EVENTS_READ)\n\n  const eventsList = useEventsList({ skip: me.isLoading || !canRead })\n\n  const [addEvent, addEventState] = useAddEventMutation()\n  const [updateEvent, updateEventState] = useUpdateEventMutation()\n  const [deleteEvent, deleteEventState] = useDeleteEventMutation()\n\n  const [saveState, setSaveState] = useState<'add' | 'edit' | 'delete' | null>(null)\n  const isSaving = !!saveState\n  useEffect(() => {\n    let state: (typeof addEventState) | (typeof updateEventState) | (typeof deleteEventState)\n    switch (saveState) {\n      case 'add':    state = addEventState; break\n      case 'edit':   state = updateEventState; break\n      case 'delete': state = deleteEventState; break\n      default: return\n    }\n    if (!state.isLoading) {\n      if (state.isError) {\n        console.log('An Error occurred trying to', saveState, 'an event', state.error)\n      }\n      setSaveState(null)\n    }\n  }, [addEventState, deleteEventState, eventsList, saveState, updateEventState])\n\n  const [eventDialogState, setEventDialogState] = useState({\n    event: null as ApiEventEntry | null,\n    show: false,\n  })\n\n  const editEvent = (event: ApiEventEntry) => setEventDialogState({ event, show: true })\n  const addNewEvent = () => setEventDialogState({ event: null, show: true })\n  const cancelEdit = () => setEventDialogState({ event: null, show: false })\n  const confirmEditEvent = (event: ApiEventEntryInput) => {\n    if (!eventDialogState.event) {\n      setSaveState('add')\n      addEvent(event)\n    } else {\n      setSaveState('edit')\n      updateEvent({ id: eventDialogState.event.id, event })\n    }\n    cancelEdit()\n  }\n  const deleteEditedEvent = () => {\n    const { event } = eventDialogState\n    if (!event) {\n      return\n    }\n    setSaveState('delete')\n    deleteEvent(event.id)\n    cancelEdit()\n  }\n\n  const { url } = useRouteMatch()\n  if (!me.isFetching) {\n    if (!me.data?.isLoggedIn) {\n      return <Redirect to={`/login?postLoginRedirect=${url}`} />\n    }\n    if (!canRead) {\n      return (\n        <Container fluid>\n          <h6>Sorry, you don&apos;t have permission to view this page.</h6>\n        </Container>\n      )\n    }\n  }\n\n  return (\n    <Container fluid>\n      <div className=\"timers-header\">\n        <h3>Timers</h3>\n        <Button onClick={eventsList.reloadEvents} disabled={isSaving}>\n          <i className=\"bi-arrow-clockwise\" /> Reload\n        </Button>\n        <div style={{ flex: 1 }} />\n        {canEdit &&\n          <Button onClick={addNewEvent} disabled={isSaving}>\n            <i className=\"bi-calendar-plus\" /> New Event\n          </Button>\n        }\n      </div>\n\n      <EventsTable\n        events={eventsList.events}\n        showResultColumn\n        canEdit={canEdit}\n        onEdit={editEvent}\n      />\n\n      <Button\n        style={{ width: '100%' }}\n        disabled={!eventsList.hasMoreEvents || eventsList.loading || isSaving}\n        onClick={eventsList.loadMoreEvents}\n      >\n        {eventsList.loading\n          ? 'Loading…'\n          : eventsList.hasMoreEvents\n            ? 'Load more'\n            : '(No more events)'\n        }\n      </Button>\n\n      <EditEventDialog\n        show={eventDialogState.show}\n        event={eventDialogState.event}\n        onCancel={cancelEdit}\n        onSave={confirmEditEvent}\n        onDelete={deleteEditedEvent}\n      />\n    </Container>\n  )\n}\n","import { ApiEventEntry } from '@ping-board/common'\nimport { useEffect } from 'react'\nimport { useAppDispatch, useAppSelector } from '../../hooks/redux'\nimport {\n  loadMoreEvents,\n  reloadEvents,\n  selectEvents,\n  selectHasMoreEvents,\n  selectIsLoadingEvents,\n} from '../../store/events-list-slice'\n\nexport interface UseEventsListResult {\n  events: ApiEventEntry[]\n  loading: boolean\n  hasMoreEvents: boolean\n  loadMoreEvents: () => void\n  reloadEvents: () => void\n}\nexport interface UseEventsListOptions {\n  skip?: boolean\n}\nexport function useEventsList({\n  skip,\n}: UseEventsListOptions = {}): UseEventsListResult {\n  const dispatch = useAppDispatch()\n  const events = useAppSelector(selectEvents)\n  const loading = useAppSelector(selectIsLoadingEvents)\n  const hasMoreEvents = useAppSelector(selectHasMoreEvents)\n\n  const loadMore = () => dispatch(loadMoreEvents())\n  const reload = () => dispatch(reloadEvents())\n\n  useEffect(() => {\n    if (skip !== true) {\n      dispatch(reloadEvents())\n    }\n  }, [dispatch, skip])\n\n  return {\n    events,\n    loading,\n    hasMoreEvents,\n    loadMoreEvents: loadMore,\n    reloadEvents: reload,\n  }\n}\n","import { Container, Navbar } from 'react-bootstrap'\nimport './app-footer.css'\n\nexport function AppFooter(): JSX.Element {\n  return (\n    <Navbar variant=\"dark\" bg=\"primary\" expand=\"lg\">\n      <Container>\n        <div className=\"footer\">\n          Brave Collective Services. For support write to support@bravecollective.freshdesk.com\n          or ask in the ingame channel &apos;Brave IT Team&apos;.\n        </div>\n      </Container>\n    </Navbar>\n  )\n}\n","import 'bootstrap/dist/css/bootstrap.min.css'\nimport './app.css'\nimport './custom.scss'\nimport { AppNav, NavPage } from './components/app-nav'\nimport { BrowserRouter, Redirect, Route, Switch } from 'react-router-dom'\nimport { CalendarPage, LoginPage, PingsPage, TimersPage } from './pages'\nimport { AppFooter } from './components/app-footer'\n\nexport default function App(): JSX.Element {\n  const pages: { href: string, title?: string, component: () => JSX.Element }[] = [\n    { href: '/calendar', title: 'Calendar', component: CalendarPage },\n    { href: '/timers', title: 'Timers', component: TimersPage },\n    { href: '/pings', title: 'Pings', component: PingsPage },\n    { href: '/login', component: LoginPage },\n  ]\n  const navPages: NavPage[] = pages.filter(\n    (p): p is NavPage & { component: () => JSX.Element } => !!p.title\n  )\n\n  return (\n    <BrowserRouter>\n      <div className=\"app-wrapper\">\n        <header>\n          <AppNav pages={navPages} />\n        </header>\n        <main className=\"main\">\n          <Switch>\n            {pages.map(page => (\n              <Route key={page.href} path={page.href} component={page.component} />\n            ))}\n            <Redirect from=\"/\" to=\"/calendar\" />\n          </Switch>\n        </main>\n        <footer>\n          <AppFooter />\n        </footer>\n      </div>\n    </BrowserRouter>\n  )\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Provider } from 'react-redux'\nimport { store } from './store'\nimport App from './app'\nimport './index.css'\nimport 'bootstrap-icons/font/bootstrap-icons.css'\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./api\"), exports);\n__exportStar(require(\"./neucore-groups\"), exports);\n__exportStar(require(\"./user-roles\"), exports);\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./events\"), exports);\n__exportStar(require(\"./me\"), exports);\n__exportStar(require(\"./ping-template\"), exports);\n__exportStar(require(\"./ping-view-permissions\"), exports);\n__exportStar(require(\"./ping\"), exports);\n__exportStar(require(\"./slack-channels\"), exports);\n//# sourceMappingURL=index.js.map"],"sourceRoot":""}