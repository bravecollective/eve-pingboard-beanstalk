{"version":3,"sources":["../../../../src/api/index.ts","../../../../src/api/ping.ts","../../../src/user-roles.ts","store/api.ts","utils/dayjs.ts","store/calendar-slice.ts","store/events-list-slice.ts","store/pings-list-slice.ts","store/index.ts","components/app-nav.tsx","components/app-footer.tsx","hooks/redux.ts","components/time.tsx","components/constellation-link.tsx","components/relative-time.tsx","components/slack-message.tsx","components/ping-details.tsx","components/region-link.tsx","components/solar-system-link.tsx","components/calendar-entry-dialog.tsx","components/calendar.tsx","pages/calendar.tsx","components/date-time-input.tsx","components/relative-time-input.tsx","hooks/use-absolute-relative-time-input.ts","components/autocomplete.tsx","components/solar-system-input.tsx","components/edit-event-dialog.tsx","components/events-table.tsx","pages/timers.tsx","hooks/use-events-list.ts","components/brave-logo.svg","components/brave-logo.tsx","components/login-button.tsx","components/eve-sso-login-black-large.png","pages/login.tsx","pages/pings.tsx","pages/_pings/index.tsx","pages/_pings/send.tsx","hooks/use-local-storage.ts","components/ping-input.tsx","components/ping-time-input.tsx","pages/_pings/_send/:templateId.tsx","hooks/use-ping-placeholders.tsx","pages/_pings/_send/index.tsx","components/ping-detail-dialog.tsx","pages/_pings/sent.tsx","hooks/use-pings-list.ts","components/edit-ping-template-dialog.tsx","pages/_pings/templates.tsx","pages/_pings/view-access.tsx","app.tsx","index.tsx","../../../src/index.ts"],"names":["apiSlice","createApi","reducerPath","baseQuery","fetchBaseQuery","baseUrl","credentials","tagTypes","endpoints","builder","getUser","query","providesTags","logOut","mutation","url","method","invalidatesTags","getEvents","params","result","events","length","map","type","id","addEvent","event","body","updateEvent","deleteEvent","_","arg","getSolarSystems","getPings","undefined","pings","addPing","ping","getPingChannels","channels","getAvailableNeucoreGroups","neucoreGroups","getPingTemplates","templates","addPingTemplate","template","updatePingTemplate","deletePingTemplate","getPingViewPermissions","updatePingViewPermissionsByNeucoreGroup","neucoreGroup","useGetUserQuery","useLogOutMutation","useAddEventMutation","useGetEventsQuery","useUpdateEventMutation","useDeleteEventMutation","useGetSolarSystemsQuery","useAddPingMutation","useGetPingsQuery","useGetPingChannelsQuery","useGetAvailableNeucoreGroupsQuery","useGetPingTemplatesQuery","useAddPingTemplateMutation","useUpdatePingTemplateMutation","useDeletePingTemplateMutation","useGetPingViewPermissionsQuery","useUpdatePingViewPermissionsByNeucoreGroupMutation","dayjs","extend","duration","localeData","localizedFormat","relativeTime","utc","weekOfYear","locales","af","am","ar","az","be","bg","bi","bm","bn","bo","br","bs","ca","cs","cv","cy","da","de","dv","el","en","eo","es","et","eu","fa","fi","fo","fr","fy","ga","gd","gl","gu","he","hi","hr","ht","hu","is","it","ja","jv","ka","kk","km","kn","ko","ku","ky","lb","lo","lt","lv","me","mi","mk","ml","mn","mr","ms","mt","my","nb","ne","nl","nn","pl","pt","ro","ru","rw","sd","se","si","sk","sl","sq","sr","ss","sv","sw","ta","te","tet","tg","th","tk","tlh","tr","tzl","tzm","uk","ur","uz","vi","yo","zh","localeChangeListeners","Set","a","success","navigator","languages","language","locale","toLowerCase","console","log","forEach","l","warn","loadLocale","then","initialCalendarState","loadingMonths","loadedMonths","dayjsFromYearAndMonth","date","year","month","getMonthKey","format","getDisplayedMonthRange","mod","firstOfMonth","startOfMonthPadding","day","firstDayOfWeek","from","subtract","days","displayedWeeks","Math","ceil","daysInMonth","to","add","weeks","loadMonth","createAsyncThunk","args","loadAll","getLatestTimestamp","getValues","data","hasMore","urlParams","URLSearchParams","after","toISOString","before","fetch","toString","response","status","json","responseData","values","Promise","all","time","remaining","scheduledFor","cached","condition","getState","monthKey","calendar","includes","calendarSlice","createSlice","name","initialState","reducers","clearCalendarEntries","state","extraReducers","addCase","pending","action","push","meta","rejected","filter","m","fulfilled","payload","Map","e","baseEntry","calendarEntryFromEvent","p","calendarEntryFromPing","addMatcher","matchFulfilled","updated","eventId","originalArgs","isScheduledPing","color","priority","title","standing","charAt","toUpperCase","substr","structure","system","join","dateTime","scheduledTitle","selectCalendarEvents","actions","initialEventsListState","loading","hasMoreEvents","reloadEvents","dispatch","clearEvents","loadMoreEvents","selectEvents","count","request","r","eventsList","sortEvents","sort","b","Date","parse","eventsListSlice","eventsReceived","selectHasMoreEvents","selectIsLoadingEvents","initialPingsListState","reloadPings","clearPings","loadMorePings","selectPings","sentAt","pingsList","sortPings","pingsListSlice","pingsReceived","selectHasMorePings","selectIsLoadingPings","store","configureStore","reducer","middleware","getDefaultMiddleware","concat","setupListeners","AppNav","props","user","pollingInterval","logout","isLoggingOut","isLoading","isFetching","Navbar","variant","expand","Container","fluid","Brand","href","Toggle","Collapse","className","Nav","pages","page","Link","as","NavLink","Text","isLoggedIn","character","Button","onClick","AppFooter","useAppDispatch","useDispatch","useAppSelector","useSelector","Time","asLink","t","nakamuraLink","unix","target","rel","stopPropagation","ConstellationLink","link","region","constellation","RelativeTime","useState","fromNow","relative","setRelative","useEffect","interval","setInterval","clearInterval","slackFormatters","regex","onMatch","match","split","indexOf","substring","SlackMessage","text","fragments","reduce","flatMap","fragment","replacements","replace","slice","f","i","Fragment","PingDetails","Row","Col","xs","slackChannelName","author","RegionLink","replaceAll","SolarSystemLink","CalendarEntryDialog","entry","modalProps","Modal","Header","closeButton","Title","Body","CalendarEntryEventBody","notes","line","Calendar","showEntryDialog","setShowEntryDialog","selectedEntry","setSelectedEntry","Array","week","start","valueOf","end","isToday","setLocale","delete","useDayjsLocale","clsx","style","width","background","j","flexBasis","show","onHide","fullscreen","CalendarPage","canRead","roles","UserRoles","EVENTS_READ","PING","currentMonth","setCurrentMonth","useMatch","pathname","size","months","DateTimeInput","allowPast","value","onChange","rowProps","dateFormat","timeFormat","timeBaseDate","dateInputText","setDateInputText","timeInputText","setTimeInputText","propDateTime","inputDateTime","isSame","parseDateTime","d","diff","handleBlur","isValid","isBefore","Form","Group","controlId","Label","Control","pattern","min","onBlur","maxLength","isBeforeNow","defaultDurationComponents","label","unit","dur","asDays","RelativeTimeInput","allowNegative","durationComponents","durationFromTexts","texts","Object","fromEntries","parseInt","isFinite","asMilliseconds","textsFromDuration","inputTexts","setInputTexts","inputDuration","propDuration","some","c","handleInputTextChange","index","newTexts","useAbsoluteRelativeTimeInput","inputMode","calculateTimes","times","setTimes","updateTimes","handleChangeInputMode","mode","absolute","handleAbsoluteDateChange","handleRelativeDateChange","toAbsoluteTime","toRelativeTime","absoluteTime","Autocomplete","options","resultLimit","optionName","loadingText","searchKeys","renderOption","controlProps","input","setInput","results","setResults","selectedResultIndex","setSelectedResultIndex","active","setActive","fuse","useMemo","Fuse","keys","distance","threshold","updateSearch","useCallback","search","newResults","findIndex","item","handleSelectResult","newResultIndex","max","referenceElement","useRef","popperElement","optionRef","setOptionRef","popper","usePopper","current","placement","modifiers","ref","onFocus","option","onKeyDown","key","newIndex","preventDefault","selectedResult","ListGroup","styles","maxHeight","overflow","zIndex","attributes","Item","res","tabIndex","onMouseDown","isActive","scrollIntoView","block","SolarSystemInput","autocompleteProps","systems","solarSystems","weight","isError","priorities","structureTypes","eventTypes","standings","EditEventDialog","onSave","onCancel","onDelete","editedEvent","setEditedEvent","inputTime","setInputTime","timeInput","canSave","entries","every","k","v","isNewEvent","lastEdited","updatedBy","updatedAt","usesAbsoluteTime","setEventField","field","handleSelectValueChange","isDeletePending","setIsDeletePending","backdrop","dialogClassName","sm","s","placeholder","Select","prio","lg","Check","inline","checked","rows","Footer","disabled","EventsTable","showResultColumn","canEdit","onEdit","getRowClass","now","abs","Table","hover","responsive","colSpan","scope","TimersPage","EVENTS_EDIT","canAdd","EVENTS_ADD","skip","loadMore","reload","useEventsList","addEventState","updateEventState","deleteEventState","saveState","setSaveState","isSaving","error","eventDialogState","setEventDialogState","cancelEdit","flex","BraveLogo","height","src","logo","alt","LoginButton","postLoginRedirect","loginUrl","LoginPage","location","useLocation","get","justifyContent","PingsPage","PingsIndex","SendPingLayout","PING_TEMPLATES_WRITE","useParams","activeTemplateId","templateId","Number","role","Alert","md","getLocalStorageValue","defaultValue","deserialize","window","localStorage","localStorageHasKey","getItem","PingInput","placeholders","inputRef","insertPlaceholder","selectionStart","selectionEnd","newText","setTimeout","newSelection","setSelectionRange","description","OverlayTrigger","delay","hide","overlay","Tooltip","PingTimeInput","SendPing","find","serializationOptions","JSON","serialize","stringify","storedValue","setStoredValue","setValue","newValue","setItem","clearValue","removeItem","useLocalStorage","addToCalendar","calendarEntryTitle","calendarTime","editedPing","setEditedPing","clearEditedPing","trim","pingTime","isNegative","startsWith","timeMs","sign","parsePingTime","userName","allowScheduling","usePingPlaceholders","oldTextSeparator","pingText","lastSentPing","setLastSentPing","canSend","isAfter","postPing","postPingState","showSendingDialog","setShowSendingDialog","sendDialogClosing","setSendDialogClosing","isSuccess","controlid","flexGrow","Spinner","animation","NoPingTemplateSelected","PingDetailDialog","SentPings","usePingsList","showPingDialog","setShowPingDialog","displayedPing","setDisplayedPing","EditPingTemplateDialog","slackChannelId","allowedNeucoreGroups","editedTemplate","setEditedTemplate","remainingNeucoreGroups","g","isNewTemplate","setTemplateField","fontSize","groupName","ManagePingTemplates","pingTemplates","addTemplate","updateTemplate","deleteTemplate","templateDialogState","setTemplateDialogState","ManagePingViewAccess","viewPermissionsQuery","viewPermissions","byGroup","rest","set","localeCompare","selectedGroup","setSelectedGroup","selectableGroups","has","allGroups","remainingGroups","remainingChannels","cc","setGroupChannels","setGroupChannelsState","channelId","allowedSlackChannelIds","handleRemoveChannel","LoginAndReturn","currentPath","App","ifHasRoles","requiredRoles","element","fallback","hasRoles","path","Layout","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.dd306270.chunk.js","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./events\"), exports);\n__exportStar(require(\"./me\"), exports);\n__exportStar(require(\"./ping-template\"), exports);\n__exportStar(require(\"./ping-view-permissions\"), exports);\n__exportStar(require(\"./ping\"), exports);\n__exportStar(require(\"./slack-channels\"), exports);\n__exportStar(require(\"./solar-systems\"), exports);\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isScheduledPing = void 0;\nfunction isScheduledPing(ping) {\n    return typeof ping.scheduledFor === 'string' && typeof ping.scheduledTitle === 'string';\n}\nexports.isScheduledPing = isScheduledPing;\n//# sourceMappingURL=ping.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.UserRoles = void 0;\nvar UserRoles;\n(function (UserRoles) {\n    UserRoles[\"EVENTS_READ\"] = \"events.read\";\n    UserRoles[\"EVENTS_ADD\"] = \"events.add\";\n    UserRoles[\"EVENTS_EDIT\"] = \"events.edit\";\n    UserRoles[\"PING\"] = \"ping\";\n    UserRoles[\"PING_TEMPLATES_WRITE\"] = \"ping.templates.write\";\n})(UserRoles = exports.UserRoles || (exports.UserRoles = {}));\n//# sourceMappingURL=user-roles.js.map","import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/dist/query/react'\nimport {\n  ApiEventEntry,\n  ApiEventEntryInput,\n  ApiEventsResponse,\n  ApiMeResponse,\n  ApiNeucoreGroupsResponse,\n  ApiPing,\n  ApiPingInput,\n  ApiPingsResponse,\n  ApiPingTemplate,\n  ApiPingTemplateInput,\n  ApiPingTemplatesResponse,\n  ApiPingViewPermissions,\n  ApiPingViewPermissionsByGroupInput,\n  ApiSlackChannelsResponse,\n  ApiSolarSystemsResponse,\n} from '@ping-board/common'\n\nexport const apiSlice = createApi({\n  reducerPath: 'loginApi',\n  baseQuery: fetchBaseQuery({ baseUrl: '/', credentials: 'same-origin' }),\n  tagTypes: [\n    'User',\n    'Event',\n    'Ping',\n    'PingTemplate',\n    'PingChannel',\n    'NeucoreGroup',\n    'PingViewPermission',\n  ],\n  endpoints: builder => ({\n    /* User Management */\n    getUser: builder.query<ApiMeResponse, void>({\n      query: () => 'api/me',\n      providesTags: ['User'],\n    }),\n    logOut: builder.mutation<void, void>({\n      query: () => ({ url: 'auth/logout', method: 'POST' }),\n      invalidatesTags: ['User', 'Event'],\n    }),\n\n    /* Events */\n    getEvents: builder.query<ApiEventsResponse, GetEventsOptions>({\n      query: params => ({ url: 'api/events', params }),\n      providesTags: (result) => result && result.events.length > 0\n        ? result.events.map(({ id }) => ({ type: 'Event', id }))\n        : ['Event'],\n    }),\n    addEvent: builder.mutation<ApiEventEntry, ApiEventEntryInput>({\n      query: event => ({ url: 'api/events', method: 'POST', body: event }),\n      invalidatesTags: ['Event'],\n    }),\n    updateEvent: builder.mutation<ApiEventEntry, { id: number, event: ApiEventEntryInput }>({\n      query: ({ id, event }) => ({ url: `api/events/${id}`, method: 'PUT', body: event }),\n      invalidatesTags: ['Event'],\n    }),\n    deleteEvent: builder.mutation<void, number>({\n      query: id => ({ url: `api/events/${id}`, method: 'DELETE' }),\n      invalidatesTags: (result, _, arg) => result ? [{ type: 'Event', id: arg }] : ['Event'],\n    }),\n    getSolarSystems: builder.query<ApiSolarSystemsResponse, void>({\n      query: () => 'api/events/solarSystems',\n    }),\n\n    /* Pings */\n    getPings: builder.query<ApiPingsResponse, { before?: string } | void>({\n      query: params => ({ url: 'api/pings', params: params || undefined }),\n      providesTags: result => result && result.pings.length > 0\n        ? result.pings.map(({ id }) => ({ type: 'Ping', id }))\n        : ['Ping'],\n    }),\n    addPing: builder.mutation<ApiPing, ApiPingInput>({\n      query: ping => ({ url: 'api/pings', method: 'POST', body: ping }),\n      invalidatesTags: result => result ? [({ type: 'Ping', id: result.id })] : ['Ping'],\n    }),\n    getPingChannels: builder.query<ApiSlackChannelsResponse, void>({\n      query: () => ({ url: 'api/pings/channels' }),\n      providesTags: result => result && result.channels.length > 0\n        ? result.channels.map(({ id }) => ({ type: 'PingChannel', id }))\n        : ['PingChannel'],\n    }),\n    getAvailableNeucoreGroups: builder.query<ApiNeucoreGroupsResponse, void>({\n      query: () => ({ url: 'api/pings/neucore-groups' }),\n      providesTags: result => result && result.neucoreGroups.length > 0\n        ? result.neucoreGroups.map(({ id }) => ({ type: 'NeucoreGroup', id }))\n        : ['NeucoreGroup'],\n    }),\n    getPingTemplates: builder.query<ApiPingTemplatesResponse, void>({\n      query: () => ({ url: 'api/pings/templates' }),\n      providesTags: (result) => result && result.templates.length > 0\n        ? result.templates.map(({ id }) => ({ type: 'PingTemplate', id }))\n        : ['PingTemplate'],\n    }),\n    addPingTemplate: builder.mutation<ApiPingTemplate, ApiPingTemplateInput>({\n      query: template => ({ url: 'api/pings/templates', method: 'POST', body: template }),\n      invalidatesTags: ['PingTemplate'],\n    }),\n    updatePingTemplate: builder\n      .mutation<ApiPingTemplate, { id: number, template: ApiPingTemplateInput }>({\n        query: ({ id, template }) => ({\n          url: `api/pings/templates/${id}`,\n          method: 'PUT',\n          body: template,\n        }),\n        invalidatesTags: result =>\n          result ? [{ type: 'PingTemplate', id: result.id }] : ['PingTemplate'],\n    }),\n    deletePingTemplate: builder.mutation<void, number>({\n      query: id => ({ url: `api/pings/templates/${id}`, method: 'DELETE' }),\n      invalidatesTags: (result, _, arg) =>\n        result ? [{ type: 'PingTemplate', id: arg }] : ['PingTemplate'],\n    }),\n    getPingViewPermissions: builder.query<ApiPingViewPermissions, void>({\n      query: () => ({ url: 'api/pings/view-permissions' }),\n      providesTags: ['PingViewPermission'],\n    }),\n    updatePingViewPermissionsByNeucoreGroup: builder.mutation<\n      ApiPingViewPermissions,\n      ApiPingViewPermissionsByGroupInput & { neucoreGroup: string }\n    >({\n      query: ({ neucoreGroup, ...body }) => ({\n        url: `api/pings/view-permissions/groups/${neucoreGroup}`,\n        method: 'PUT',\n        body,\n      }),\n      invalidatesTags: ['PingViewPermission', 'Ping'],\n    }),\n  }),\n})\n\nexport interface GetEventsOptions {\n  before?: string\n  after?: string\n  count?: number\n}\n\nexport const {\n  useGetUserQuery,\n  useLogOutMutation,\n\n  useGetEventsQuery,\n  useAddEventMutation,\n  useUpdateEventMutation,\n  useDeleteEventMutation,\n  useGetSolarSystemsQuery,\n\n  useGetPingsQuery,\n  useAddPingMutation,\n  useGetPingChannelsQuery,\n  useGetAvailableNeucoreGroupsQuery,\n  useGetPingTemplatesQuery,\n  useAddPingTemplateMutation,\n  useUpdatePingTemplateMutation,\n  useDeletePingTemplateMutation,\n  useGetPingViewPermissionsQuery,\n  useUpdatePingViewPermissionsByNeucoreGroupMutation,\n} = apiSlice\n","import dayjs from 'dayjs'\n\nimport duration from 'dayjs/plugin/duration'\nimport localeData from 'dayjs/plugin/localeData'\nimport localizedFormat from 'dayjs/plugin/localizedFormat'\nimport relativeTime from 'dayjs/plugin/relativeTime'\nimport utc from 'dayjs/plugin/utc'\nimport weekOfYear from 'dayjs/plugin/weekOfYear'\nimport { useEffect, useState } from 'react'\ndayjs.extend(duration)\ndayjs.extend(localeData)\ndayjs.extend(localizedFormat)\ndayjs.extend(relativeTime)\ndayjs.extend(utc)\ndayjs.extend(weekOfYear)\n\n//#region locales\n\nconst locales = {\n  af: () => import('dayjs/locale/af'),\n  am: () => import('dayjs/locale/am'),\n  'ar-dz': () => import('dayjs/locale/ar-dz'),\n  // 'ar-iq': () => import('dayjs/locale/ar-iq'), // compilation fails when enabling this\n  'ar-kw': () => import('dayjs/locale/ar-kw'),\n  'ar-ly': () => import('dayjs/locale/ar-ly'),\n  'ar-ma': () => import('dayjs/locale/ar-ma'),\n  'ar-sa': () => import('dayjs/locale/ar-sa'),\n  'ar-tn': () => import('dayjs/locale/ar-tn'),\n  ar: () => import('dayjs/locale/ar'),\n  az: () => import('dayjs/locale/az'),\n  be: () => import('dayjs/locale/be'),\n  bg: () => import('dayjs/locale/bg'),\n  bi: () => import('dayjs/locale/bi'),\n  bm: () => import('dayjs/locale/bm'),\n  bn: () => import('dayjs/locale/bn'),\n  bo: () => import('dayjs/locale/bo'),\n  br: () => import('dayjs/locale/br'),\n  bs: () => import('dayjs/locale/bs'),\n  ca: () => import('dayjs/locale/ca'),\n  cs: () => import('dayjs/locale/cs'),\n  cv: () => import('dayjs/locale/cv'),\n  cy: () => import('dayjs/locale/cy'),\n  da: () => import('dayjs/locale/da'),\n  'de-at': () => import('dayjs/locale/de-at'),\n  'de-ch': () => import('dayjs/locale/de-ch'),\n  de: () => import('dayjs/locale/de'),\n  dv: () => import('dayjs/locale/dv'),\n  el: () => import('dayjs/locale/el'),\n  'en-au': () => import('dayjs/locale/en-au'),\n  'en-ca': () => import('dayjs/locale/en-ca'),\n  'en-gb': () => import('dayjs/locale/en-gb'),\n  'en-ie': () => import('dayjs/locale/en-ie'),\n  'en-il': () => import('dayjs/locale/en-il'),\n  'en-in': () => import('dayjs/locale/en-in'),\n  'en-nz': () => import('dayjs/locale/en-nz'),\n  'en-sg': () => import('dayjs/locale/en-sg'),\n  'en-tt': () => import('dayjs/locale/en-tt'),\n  en: () => import('dayjs/locale/en'),\n  eo: () => import('dayjs/locale/eo'),\n  'es-do': () => import('dayjs/locale/es-do'),\n  // 'es-mx': () => import('dayjs/locale/es-mx'), // compilation fails when enabling this\n  'es-pr': () => import('dayjs/locale/es-pr'),\n  'es-us': () => import('dayjs/locale/es-us'),\n  es: () => import('dayjs/locale/es'),\n  et: () => import('dayjs/locale/et'),\n  eu: () => import('dayjs/locale/eu'),\n  fa: () => import('dayjs/locale/fa'),\n  fi: () => import('dayjs/locale/fi'),\n  fo: () => import('dayjs/locale/fo'),\n  'fr-ca': () => import('dayjs/locale/fr-ca'),\n  'fr-ch': () => import('dayjs/locale/fr-ch'),\n  fr: () => import('dayjs/locale/fr'),\n  fy: () => import('dayjs/locale/fy'),\n  ga: () => import('dayjs/locale/ga'),\n  gd: () => import('dayjs/locale/gd'),\n  gl: () => import('dayjs/locale/gl'),\n  'gom-latn': () => import('dayjs/locale/gom-latn'),\n  gu: () => import('dayjs/locale/gu'),\n  he: () => import('dayjs/locale/he'),\n  hi: () => import('dayjs/locale/hi'),\n  hr: () => import('dayjs/locale/hr'),\n  ht: () => import('dayjs/locale/ht'),\n  hu: () => import('dayjs/locale/hu'),\n  'hy-am': () => import('dayjs/locale/hy-am'),\n  id: () => import('dayjs/locale/id'),\n  is: () => import('dayjs/locale/is'),\n  'it-ch': () => import('dayjs/locale/it-ch'),\n  it: () => import('dayjs/locale/it'),\n  ja: () => import('dayjs/locale/ja'),\n  jv: () => import('dayjs/locale/jv'),\n  ka: () => import('dayjs/locale/ka'),\n  kk: () => import('dayjs/locale/kk'),\n  km: () => import('dayjs/locale/km'),\n  kn: () => import('dayjs/locale/kn'),\n  ko: () => import('dayjs/locale/ko'),\n  ku: () => import('dayjs/locale/ku'),\n  ky: () => import('dayjs/locale/ky'),\n  lb: () => import('dayjs/locale/lb'),\n  lo: () => import('dayjs/locale/lo'),\n  lt: () => import('dayjs/locale/lt'),\n  lv: () => import('dayjs/locale/lv'),\n  me: () => import('dayjs/locale/me'),\n  mi: () => import('dayjs/locale/mi'),\n  mk: () => import('dayjs/locale/mk'),\n  ml: () => import('dayjs/locale/ml'),\n  mn: () => import('dayjs/locale/mn'),\n  mr: () => import('dayjs/locale/mr'),\n  'ms-my': () => import('dayjs/locale/ms-my'),\n  ms: () => import('dayjs/locale/ms'),\n  mt: () => import('dayjs/locale/mt'),\n  my: () => import('dayjs/locale/my'),\n  nb: () => import('dayjs/locale/nb'),\n  ne: () => import('dayjs/locale/ne'),\n  'nl-be': () => import('dayjs/locale/nl-be'),\n  nl: () => import('dayjs/locale/nl'),\n  nn: () => import('dayjs/locale/nn'),\n  'oc-lnc': () => import('dayjs/locale/oc-lnc'),\n  'pa-in': () => import('dayjs/locale/pa-in'),\n  pl: () => import('dayjs/locale/pl'),\n  'pt-br': () => import('dayjs/locale/pt-br'),\n  pt: () => import('dayjs/locale/pt'),\n  ro: () => import('dayjs/locale/ro'),\n  ru: () => import('dayjs/locale/ru'),\n  rw: () => import('dayjs/locale/rw'),\n  sd: () => import('dayjs/locale/sd'),\n  se: () => import('dayjs/locale/se'),\n  si: () => import('dayjs/locale/si'),\n  sk: () => import('dayjs/locale/sk'),\n  sl: () => import('dayjs/locale/sl'),\n  sq: () => import('dayjs/locale/sq'),\n  'sr-cyrl': () => import('dayjs/locale/sr-cyrl'),\n  sr: () => import('dayjs/locale/sr'),\n  ss: () => import('dayjs/locale/ss'),\n  'sv-fi': () => import('dayjs/locale/sv-fi'),\n  sv: () => import('dayjs/locale/sv'),\n  sw: () => import('dayjs/locale/sw'),\n  ta: () => import('dayjs/locale/ta'),\n  te: () => import('dayjs/locale/te'),\n  tet: () => import('dayjs/locale/tet'),\n  tg: () => import('dayjs/locale/tg'),\n  th: () => import('dayjs/locale/th'),\n  tk: () => import('dayjs/locale/tk'),\n  'tl-ph': () => import('dayjs/locale/tl-ph'),\n  tlh: () => import('dayjs/locale/tlh'),\n  tr: () => import('dayjs/locale/tr'),\n  tzl: () => import('dayjs/locale/tzl'),\n  'tzm-latn': () => import('dayjs/locale/tzm-latn'),\n  tzm: () => import('dayjs/locale/tzm'),\n  'ug-cn': () => import('dayjs/locale/ug-cn'),\n  uk: () => import('dayjs/locale/uk'),\n  ur: () => import('dayjs/locale/ur'),\n  'uz-latn': () => import('dayjs/locale/uz-latn'),\n  uz: () => import('dayjs/locale/uz'),\n  vi: () => import('dayjs/locale/vi'),\n  'x-pseudo': () => import('dayjs/locale/x-pseudo'),\n  yo: () => import('dayjs/locale/yo'),\n  'zh-cn': () => import('dayjs/locale/zh-cn'),\n  'zh-hk': () => import('dayjs/locale/zh-hk'),\n  'zh-tw': () => import('dayjs/locale/zh-tw'),\n  zh: () => import('dayjs/locale/zh'),\n}\n\n//#endregion\n\nconst localeChangeListeners = new Set<(newLocale: string) => void>()\n/**\n * Returns the currently active Day.js locale.\n *\n * Can also be used to re-render a component when the locale changes.\n */\nexport function useDayjsLocale(): string {\n  const [locale, setLocale] = useState(dayjs.locale())\n\n  // Ideally, this would be inside the useEffect body, but that results in race-conditions making\n  // the useDayjsLocale hook result not update properly if the new locale is loaded too fast.\n  localeChangeListeners.add(setLocale)\n  useEffect(() => {\n    return () => { localeChangeListeners.delete(setLocale) }\n  }, [])\n  return locale\n}\n\nasync function loadLocale() {\n  let success = false\n  for (const language of navigator.languages ?? []) {\n    const locale = language.toLowerCase()\n    console.log('checking locale', locale)\n    if (locale in locales) {\n      try {\n        await locales[locale as keyof typeof locales]()\n        dayjs.locale(locale)\n        console.log('loaded dayjs locale', locale)\n        success = true\n        localeChangeListeners.forEach(l => l(locale))\n        break\n      } catch {\n        // failing is fine, we'll just try the next one\n      }\n    }\n  }\n  if (!success) {\n    console.warn('failed to load dayjs locale, falling back to en')\n  }\n}\nloadLocale().then()\n\nexport { dayjs }\nexport { Dayjs } from 'dayjs'\nexport type { Duration, DurationUnitsObjectType } from 'dayjs/plugin/duration'\n","import { createAsyncThunk, createSlice } from '@reduxjs/toolkit'\nimport {\n  ApiEventEntry,\n  ApiEventsResponse,\n  ApiScheduledPing,\n  ApiScheduledPingsResponse,\n  isScheduledPing,\n} from '@ping-board/common'\nimport { RootState } from '.'\nimport { eventColors } from '../components/calendar'\nimport { Dayjs, dayjs } from '../utils/dayjs'\nimport { apiSlice } from './api'\n\nexport interface CalendarEntry {\n  title: string\n  dateTime: string\n  color?: typeof eventColors[number]\n  baseEntry:\n    | { type: 'event', event: ApiEventEntry }\n    | { type: 'ping', ping: ApiScheduledPing }\n}\n\ninterface CalendarState {\n  loadingMonths: string[]\n  loadedMonths: string[]\n  events: CalendarEntry[]\n}\nconst initialCalendarState: CalendarState = {\n  loadingMonths: [],\n  loadedMonths: [],\n  events: [],\n}\n\nconst dayjsFromYearAndMonth = (date: { year: number, month: number }) =>\n  // We need to month+1, because month numbers are 0-based (i.e. january = 0)\n  dayjs.utc(`${date.year}-${date.month + 1}-01`)\n\nconst getMonthKey = (date: { year: number, month: number }) =>\n  dayjsFromYearAndMonth(date).format('YYYY-MM')\n\nfunction modulo(a: number, mod: number): number {\n  return ((a % mod) + mod) % mod\n}\n\nexport function getDisplayedMonthRange(date: { year: number, month: number }): {\n  from: Dayjs\n  to: Dayjs\n  displayedWeeks: number\n} {\n  const firstOfMonth = dayjsFromYearAndMonth(date)\n  const startOfMonthPadding = modulo(firstOfMonth.day() - dayjs.localeData().firstDayOfWeek(), 7)\n  const from = firstOfMonth.subtract(dayjs.duration({ days: startOfMonthPadding }))\n  const displayedWeeks = Math.ceil((from.daysInMonth() + startOfMonthPadding) / 7)\n  const to = from.add(dayjs.duration({ weeks: displayedWeeks }))\n  return { from, to, displayedWeeks }\n}\n\nexport const loadMonth = createAsyncThunk(\n  'calendar/loadMonth',\n  async (args: { year: number, month: number }) => {\n    const { from, to } = getDisplayedMonthRange(args)\n\n    async function loadAll<R, T>(\n      baseUrl: string,\n      getLatestTimestamp: (entries: T[]) => string | null,\n      getValues: (response: R) => { values: T[], hasMore: boolean }\n    ): Promise<T[]> {\n      let data: T[] = []\n      let hasMore = true\n\n      while (hasMore) {\n        const urlParams = new URLSearchParams({\n          after: getLatestTimestamp(data) ?? from.toISOString(),\n          before: to.toISOString(),\n        })\n        const response = await fetch(\n          `${baseUrl}?${urlParams.toString()}`,\n          { credentials: 'same-origin' }\n        )\n        if (response.status === 401) {\n          // we don't have access to this resource, but it's okay to fail and assume no data here\n          hasMore = false\n        } else {\n          const responseData = await response.json() as R\n          const values = getValues(responseData)\n          data = [...data, ...values.values]\n          hasMore = values.hasMore\n        }\n      }\n\n      return data\n    }\n\n    const [events, pings] = await Promise.all([\n      loadAll<ApiEventsResponse, ApiEventEntry>(\n        '/api/events',\n        events => events.length > 0 ? events[events.length - 1].time : null,\n        response => ({ values: response.events, hasMore: response.remaining > 0 })\n      ),\n      loadAll<ApiScheduledPingsResponse, ApiScheduledPing>(\n        '/api/pings/scheduled',\n        pings => pings.length > 0 ? pings[pings.length - 1].scheduledFor : null,\n        response => ({ values: response.pings, hasMore: response.remaining > 0 })\n      ),\n    ])\n\n    return { cached: false, events, pings }\n  },\n  {\n    condition: (args, { getState }) => {\n      const monthKey = getMonthKey(args)\n      const { loadingMonths, loadedMonths } = (getState() as { calendar: CalendarState }).calendar\n      return !loadingMonths.includes(monthKey) && !loadedMonths.includes(monthKey)\n    },\n  }\n)\n\nexport const calendarSlice = createSlice({\n  name: 'calendar',\n  initialState: initialCalendarState,\n  reducers: {\n    clearCalendarEntries: state => {\n      state.events = []\n      state.loadedMonths = []\n    },\n  },\n  extraReducers: builder => builder\n    .addCase(loadMonth.pending, (state, action) => {\n      state.loadingMonths.push(getMonthKey(action.meta.arg))\n    })\n    .addCase(loadMonth.rejected, (state, action) => {\n      const monthKey = getMonthKey(action.meta.arg)\n      state.loadingMonths = state.loadingMonths.filter(m => m !== monthKey)\n    })\n    .addCase(loadMonth.fulfilled, (state, action) => {\n      const monthKey = getMonthKey(action.meta.arg)\n      state.loadingMonths = state.loadingMonths.filter(m => m !== monthKey)\n      if (!action.payload) {\n        return\n      }\n      const events = new Map<string, CalendarEntry>([\n        ...state.events.map(e => e.baseEntry.type === 'event'\n          ? [`event-${e.baseEntry.event.id}`, e] as const\n          : [`ping-${e.baseEntry.ping.id}`, e] as const\n        ),\n        ...action.payload.events.map(e => [`event-${e.id}`, calendarEntryFromEvent(e)] as const),\n        ...action.payload.pings.map(p => [`ping-${p.id}`, calendarEntryFromPing(p)] as const),\n      ])\n      state.events = [...events.values()]\n    })\n\n    // Clear state on logout to prevent leaking data that the new user should not be able to see\n    .addMatcher(apiSlice.endpoints.logOut.matchFulfilled, () => {\n      return initialCalendarState\n    })\n\n    // Add calendar entries for every added event\n    .addMatcher(apiSlice.endpoints.addEvent.matchFulfilled, (state, action) => {\n      state.events = [...state.events, calendarEntryFromEvent(action.payload)]\n    })\n    // Update calendar entries for every updated event\n    .addMatcher(apiSlice.endpoints.updateEvent.matchFulfilled, (state, action) => {\n      const updated = action.payload\n      state.events = state.events.map(e =>\n        e.baseEntry.type === 'event' &&\n        e.baseEntry.event.id === updated.id\n        ? calendarEntryFromEvent(updated)\n        : e\n      )\n    })\n    // Remove calendar entries for every removed event\n    .addMatcher(apiSlice.endpoints.deleteEvent.matchFulfilled, (state, action) => {\n      const eventId = action.meta.arg.originalArgs\n      state.events = state.events\n        .filter(e => e.baseEntry.type !== 'event' || e.baseEntry.event.id !== eventId)\n    })\n\n    // Add calendar entries for sent pings\n    .addMatcher(apiSlice.endpoints.addPing.matchFulfilled, (state, action) => {\n      if (isScheduledPing(action.payload)) {\n        state.events = [...state.events, calendarEntryFromPing(action.payload)]\n      }\n    })\n    ,\n})\n\nfunction calendarEntryFromEvent(event: ApiEventEntry): CalendarEntry {\n  let color: CalendarEntry['color']\n  switch (event.priority.toLowerCase()) {\n    case 'low': color = 'gray'; break\n    case 'medium': color = 'yellow'; break\n    case 'high': color = 'orange'; break\n    case 'critical': color = 'red'; break\n  }\n\n  const title = [\n    event.standing.charAt(0).toUpperCase(),\n    event.standing.substr(1),\n    ' ',\n    event.structure.toLowerCase() === 'other' ? '' : event.structure + ' ',\n    event.type.toLowerCase() === 'other' ? '' : event.type.toLowerCase() + ' ',\n    'timer in ',\n    event.system,\n  ].join('')\n\n  return {\n    dateTime: event.time,\n    title,\n    color,\n    baseEntry: { type: 'event', event },\n  }\n}\n\nfunction calendarEntryFromPing(ping: ApiScheduledPing): CalendarEntry {\n  return {\n    dateTime: ping.scheduledFor,\n    title: ping.scheduledTitle,\n    baseEntry: { type: 'ping', ping },\n  }\n}\n\nexport const selectCalendarEvents = (state: RootState): CalendarEntry[] => state.calendar.events\nexport const selectIsLoadingCalendarEvents = (state: RootState): boolean =>\n  state.calendar.loadingMonths.length > 0\n\nexport const {\n  clearCalendarEntries,\n} = calendarSlice.actions\n","import { createAsyncThunk, createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { ApiEventEntry, ApiEventsResponse } from '@ping-board/common'\nimport { RootState } from '.'\nimport { apiSlice } from './api'\n\ninterface EventsListState {\n  loading: boolean\n  events: ApiEventEntry[]\n  hasMoreEvents: boolean\n}\nconst initialEventsListState: EventsListState = {\n  loading: false,\n  events: [],\n  hasMoreEvents: true,\n}\n\nexport const reloadEvents = createAsyncThunk(\n  'eventsList/reloadEvents',\n  (_, { dispatch }) => {\n    dispatch(clearEvents())\n    dispatch(loadMoreEvents())\n  }\n)\n\nexport const loadMoreEvents = createAsyncThunk(\n  'eventsList/loadMore',\n  async (_, { getState }) => {\n    const events = selectEvents(getState() as RootState)\n    const urlParams = new URLSearchParams({\n      ...events.length > 0 ? { before: events[events.length - 1].time } : {},\n      count: '40',\n    })\n    const request = fetch(`/api/events?${urlParams.toString()}`, { credentials: 'same-origin' })\n    return await request.then(r => r.json()) as ApiEventsResponse\n  },\n  {\n    condition: (_, { getState }) => {\n      const state = getState() as { eventsList: EventsListState }\n      return !state.eventsList.loading\n    },\n  }\n)\n\nfunction sortEvents(events: ApiEventEntry[]): ApiEventEntry[] {\n  return [...events].sort((a, b) => Date.parse(b.time) - Date.parse(a.time))\n}\n\nexport const eventsListSlice = createSlice({\n  name: 'eventsList',\n  initialState: initialEventsListState,\n  reducers: {\n    clearEvents: state => {\n      state.loading = false\n      state.events = []\n      state.hasMoreEvents = true\n    },\n    eventsReceived: (state, action: PayloadAction<ApiEventsResponse>) => {\n      state.loading = false\n      state.events = [...state.events, ...action.payload.events]\n      state.hasMoreEvents = action.payload.remaining > 0\n    },\n  },\n  extraReducers: builder => builder\n    .addCase(loadMoreEvents.pending, state => { state.loading = true })\n    .addCase(loadMoreEvents.fulfilled, (state, action) => {\n      state.loading = false\n      state.events = sortEvents([...state.events, ...action.payload.events])\n      state.hasMoreEvents = action.payload.remaining > 0\n    })\n    .addCase(loadMoreEvents.rejected, state => {\n      state.loading = false\n    })\n\n    // Clear state on logout to prevent leaking data that the new user should not be able to see\n    .addMatcher(apiSlice.endpoints.logOut.matchFulfilled, () => {\n      return initialEventsListState\n    })\n\n    // Add added events to the event list without re-fetching them\n    .addMatcher(apiSlice.endpoints.addEvent.matchFulfilled, (state, action) => {\n      state.events = sortEvents([...state.events, action.payload])\n    })\n    // Update updated events in the event list without re-fetching them\n    .addMatcher(apiSlice.endpoints.updateEvent.matchFulfilled, (state, action) => {\n      const updated = action.payload\n      state.events = sortEvents(state.events.map(e => e.id === updated.id ? updated : e))\n    })\n    // Remove deleted events from the event list without re-fetching them\n    .addMatcher(apiSlice.endpoints.deleteEvent.matchFulfilled, (state, action) => {\n      const eventId = action.meta.arg.originalArgs\n      state.events = state.events.filter(e => e.id !== eventId)\n    }),\n})\n\nexport const selectEvents = (state: RootState): ApiEventEntry[] => state.eventsList.events\nexport const selectHasMoreEvents = (state: RootState): boolean => state.eventsList.hasMoreEvents\nexport const selectIsLoadingEvents = (state: RootState): boolean => state.eventsList.loading\n\nexport const {\n  clearEvents,\n  eventsReceived,\n} = eventsListSlice.actions\n","import { createAsyncThunk, createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { ApiPing, ApiPingsResponse } from '@ping-board/common'\nimport { RootState } from '.'\nimport { apiSlice } from './api'\n\ninterface PingsListState {\n  loading: boolean\n  pings: ApiPing[]\n  hasMore: boolean\n}\nconst initialPingsListState: PingsListState = {\n  loading: false,\n  pings: [],\n  hasMore: true,\n}\n\nexport const reloadPings = createAsyncThunk(\n  'pingsList/reloadPings',\n  (_, { dispatch }) => {\n    dispatch(clearPings())\n    dispatch(loadMorePings())\n  }\n)\n\nexport const loadMorePings = createAsyncThunk(\n  'pingsList/loadMore',\n  async (_, { getState }) => {\n    const pings = selectPings(getState() as RootState)\n    const urlParams = new URLSearchParams(\n      pings.length > 0 ? { before: pings[pings.length - 1].sentAt } : {}\n    )\n    const request = fetch(`/api/pings?${urlParams.toString()}`, { credentials: 'same-origin' })\n    return await request.then(r => r.json()) as ApiPingsResponse\n  },\n  {\n    condition: (_, { getState }) => {\n      const state = getState() as { pingsList: PingsListState }\n      return !state.pingsList.loading\n    },\n  }\n)\n\nfunction sortPings(pings: ApiPing[]): ApiPing[] {\n  return [...pings].sort((a, b) => Date.parse(b.sentAt) - Date.parse(a.sentAt))\n}\n\nexport const pingsListSlice = createSlice({\n  name: 'pingsList',\n  initialState: initialPingsListState,\n  reducers: {\n    clearPings: state => {\n      state.loading = false\n      state.pings = []\n      state.hasMore = true\n    },\n    pingsReceived: (state, action: PayloadAction<ApiPingsResponse>) => {\n      state.loading = false\n      state.pings = [...state.pings, ...action.payload.pings]\n      state.hasMore = action.payload.remaining > 0\n    },\n  },\n  extraReducers: builder => builder\n    .addCase(loadMorePings.pending, state => { state.loading = true })\n    .addCase(loadMorePings.fulfilled, (state, action) => {\n      state.loading = false\n      state.pings = sortPings([...state.pings, ...action.payload.pings])\n      state.hasMore = action.payload.remaining > 0\n    })\n    .addCase(loadMorePings.rejected, state => {\n      state.loading = false\n    })\n\n    // Clear state on logout to prevent leaking data that the new user should not be able to see\n    .addMatcher(apiSlice.endpoints.logOut.matchFulfilled, () => {\n      return initialPingsListState\n    })\n\n    // Add sent pings to the list of pings without re-fetching them\n    .addMatcher(apiSlice.endpoints.addPing.matchFulfilled, (state, action) => {\n      state.pings = sortPings([...state.pings, action.payload])\n    }),\n})\n\nexport const selectPings = (state: RootState): ApiPing[] => state.pingsList.pings\nexport const selectHasMorePings = (state: RootState): boolean => state.pingsList.hasMore\nexport const selectIsLoadingPings = (state: RootState): boolean => state.pingsList.loading\n\nexport const {\n  clearPings,\n  pingsReceived,\n} = pingsListSlice.actions\n","import { configureStore } from '@reduxjs/toolkit'\nimport { setupListeners } from '@reduxjs/toolkit/dist/query'\nimport { apiSlice } from './api'\nimport { calendarSlice } from './calendar-slice'\nimport { eventsListSlice } from './events-list-slice'\nimport { pingsListSlice } from './pings-list-slice'\nexport * from './api'\n\nexport const store = configureStore({\n  reducer: {\n    [apiSlice.reducerPath]: apiSlice.reducer,\n    [calendarSlice.name]: calendarSlice.reducer,\n    [eventsListSlice.name]: eventsListSlice.reducer,\n    [pingsListSlice.name]: pingsListSlice.reducer,\n  },\n  middleware: getDefaultMiddleware => getDefaultMiddleware()\n    .concat(apiSlice.middleware),\n})\nsetupListeners(store.dispatch)\n\nexport type RootState = ReturnType<typeof store.getState>\nexport type AppDispatch = typeof store.dispatch\n","import { Button, Container, Nav, Navbar } from 'react-bootstrap'\nimport { Link, NavLink } from 'react-router-dom'\nimport { useGetUserQuery, useLogOutMutation } from '../store'\n\nexport interface NavPage {\n  href: string\n  title: string\n}\n\nexport interface AppNavProps {\n  pages: NavPage[]\n}\n\nexport function AppNav(props: AppNavProps): JSX.Element {\n  const user = useGetUserQuery(void 0, {\n    pollingInterval: 60 * 1000,\n  })\n  const [logout, { isLoading: isLoggingOut }] = useLogOutMutation()\n\n  const isLoading = user.isFetching || isLoggingOut\n\n  return (\n    <Navbar variant=\"dark\" bg=\"primary\" expand=\"md\">\n      <Container fluid>\n        <Navbar.Brand href=\"/\">Brave Collective Pingboard</Navbar.Brand>\n        <Navbar.Toggle aria-controls=\"navbar-nav\" />\n          <Navbar.Collapse id=\"navbar-nav\" className=\"justify-content-end\">\n            <Nav variant=\"pills\" className=\"me-auto\">\n              {props.pages.map(page => (\n                <Nav.Link\n                  as={NavLink}\n                  key={page.title}\n                  to={page.href}\n                >\n                  {page.title}\n                </Nav.Link>\n              ))}\n            </Nav>\n            {isLoading\n              ? <Navbar.Text>Loading</Navbar.Text>\n              : user.data?.isLoggedIn\n                ? <>\n                    <Navbar.Text>{user.data.character.name}</Navbar.Text>\n                    <Button onClick={() => logout()}>Log Out</Button>\n                  </>\n                : <Link className=\"btn btn-primary\" type=\"button\" to=\"/login\">Log In</Link>\n            }\n          </Navbar.Collapse>\n      </Container>\n    </Navbar>\n  )\n}\n","import { Container, Navbar } from 'react-bootstrap'\nimport './app-footer.css'\n\nexport function AppFooter(): JSX.Element {\n  return (\n    <Navbar variant=\"dark\" bg=\"primary\" expand=\"lg\">\n      <Container>\n        <div className=\"footer\">\n          Brave Collective Services. For support write to support@bravecollective.freshdesk.com\n          or ask in the ingame channel &apos;Brave IT Team&apos;.\n        </div>\n      </Container>\n    </Navbar>\n  )\n}\n","import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux'\nimport { AppDispatch, RootState } from '../store'\n\nexport const useAppDispatch = (): AppDispatch => useDispatch<AppDispatch>()\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector\n","import { Dayjs, dayjs } from '../utils/dayjs'\n\nexport interface TimeProps {\n  time: Date | string | Dayjs\n  format?: string\n  asLink?: boolean\n  className?: string\n}\nexport function Time({\n  time,\n  format = 'llll',\n  asLink = false,\n  className,\n}: TimeProps): JSX.Element {\n  const t = dayjs(time)\n\n  if (asLink) {\n    const nakamuraLink = `https://time.nakamura-labs.com/#${t.unix()}`\n    return (\n      <a\n        className={className}\n        href={nakamuraLink}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n        onClick={e => e.stopPropagation()}\n      >\n        {t.format(format)}\n      </a>\n    )\n  }\n\n  return (\n    <span className={className}>{t.format(format)}</span>\n  )\n}\n","export function ConstellationLink(props: { region: string, constellation: string }): JSX.Element {\n  const link = `https://evemaps.dotlan.net/map/${props.region}/${props.constellation}`\n\n  return (\n    <a href={link} target=\"_blank\" rel=\"noreferrer\">\n      {props.constellation}\n    </a>\n  )\n}\n","import dayjs from 'dayjs'\nimport { useEffect, useState } from 'react'\n\nexport interface RelativeTimeProps {\n  time: Date | string\n}\nexport function RelativeTime({\n  time,\n}: RelativeTimeProps): JSX.Element {\n  const [relative, setRelative] = useState(dayjs(time).fromNow())\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setRelative(dayjs(time).fromNow())\n    }, 1000)\n    return () => clearInterval(interval)\n  }, [time])\n\n  return (\n    <span>{relative}</span>\n  )\n}\n","import React from 'react'\n\nconst slackFormatters: { regex: RegExp, onMatch: (...match: string[]) => React.ReactNode }[] = [\n  // newlines\n  { regex: /\\n/g, onMatch: _ => <br /> }, // eslint-disable-line @typescript-eslint/no-unused-vars\n  // links (`[title](url)`)\n  {\n    regex: /\\[([^\\]]+\\]\\([^)]+)\\)>/g,\n    onMatch: match => {\n      const split = match.indexOf('](')\n      const href = match.substring(0, split)\n      const title = match.substring(split + 2)\n      return <a href={href} target=\"_blank\" rel=\"noreferrer\">{title}</a>\n    },\n  },\n  // links (`<href|title>`)\n  {\n    regex: /<([^|]+\\|[^>]+)>/g,\n    onMatch: match => {\n      const split = match.indexOf('|')\n      const href = match.substring(0, split)\n      const title = match.substring(split + 1)\n      return <a href={href} target=\"_blank\" rel=\"noreferrer\">{title}</a>\n    },\n  },\n  // bold text\n  { regex: /\\*([^*]+)\\*/g, onMatch: match => <b>{match}</b> },\n  // italics\n  { regex: /_([^*]+)_/g, onMatch: match => <i>{match}</i> },\n  // strikethrough\n  { regex: /~([^~]+)~/g, onMatch: match => <s>{match}</s> },\n]\n\nexport function SlackMessage({ text }: { text: string }): JSX.Element {\n  const fragments = slackFormatters.reduce(\n    (fragments, { regex, onMatch }) => fragments.flatMap(fragment => {\n      if (typeof fragment !== 'string') {\n        return [fragment]\n      }\n      const placeholder = '\\0'\n      const replacements: React.ReactNode[] = []\n      const formatted = fragment.replace(regex, (...args) => {\n        const match = args.length > 3 ? args.slice(1, args.length - 2) as string[] : []\n        replacements.push(onMatch(...match))\n        return placeholder\n      })\n      return formatted\n        .split(placeholder)\n        .flatMap((f, i) => [f, ...replacements[i] ? [replacements[i]] : []])\n    }),\n    [text] as React.ReactNode[]\n  )\n\n  return (<>\n    {fragments.map((f, i) => <React.Fragment key={i}>{f}</React.Fragment>)}\n  </>)\n}\n","import { Col, Row } from 'react-bootstrap'\nimport { ApiPing } from '@ping-board/common'\nimport { dayjs } from '../utils/dayjs'\nimport { RelativeTime } from './relative-time'\nimport { SlackMessage } from './slack-message'\nimport { Time } from './time'\n\nexport function PingDetails({ ping }: { ping: ApiPing }): JSX.Element {\n  return (\n    <Row className=\"mt-n2\">\n      {ping.scheduledFor && (<>\n        <Col xs={3}>EVE Time</Col>\n        <Col xs={9}>\n          <Time\n            time={dayjs.utc(ping.scheduledFor)}\n            asLink\n            format=\"YYYY-MM-DD HH:mm\"\n          />\n        </Col>\n\n        <Col xs={3}>Local Time</Col>\n        <Col xs={9}>\n          <Time time={ping.scheduledFor} /> (\n            <RelativeTime time={ping.scheduledFor} />\n          )\n        </Col>\n      </>)}\n\n      <Col xs={3}>Channel</Col>\n      <Col xs={9}>{ping.slackChannelName}</Col>\n\n      <Col xs={3}>Sent By</Col>\n      <Col xs={9}>{ping.author}</Col>\n\n      <hr className=\"my-1\" />\n\n      <Col xs={3}>Ping Text</Col>\n      <Col xs={9}>\n        <SlackMessage text={ping.text} />\n      </Col>\n    </Row>\n  )\n}\n","export function RegionLink(props: { region: string, system?: string }): JSX.Element {\n  const link = `https://evemaps.dotlan.net/map/${props.region.replaceAll(' ', '_')}` +\n    (props.system ? `/${props.system.replaceAll(' ', '_')}` : '')\n\n  return (\n    <a href={link} target=\"_blank\" rel=\"noreferrer\">\n      {props.region}\n    </a>\n  )\n}\n","export function SolarSystemLink(props: { system: string }): JSX.Element {\n  const link = `https://evemaps.dotlan.net/system/${props.system.replaceAll(' ', '_')}`\n  return (\n    <a href={link} target=\"_blank\" rel=\"noreferrer\">\n      {props.system}\n    </a>\n  )\n}\n","import { Col, Modal, ModalProps, Row } from 'react-bootstrap'\nimport { ApiEventEntry } from '@ping-board/common'\nimport { ConstellationLink } from './constellation-link'\nimport { PingDetails } from './ping-details'\nimport { RegionLink } from './region-link'\nimport { RelativeTime } from './relative-time'\nimport { SolarSystemLink } from './solar-system-link'\nimport { Time } from './time'\nimport { CalendarEntry } from '../store/calendar-slice'\nimport { dayjs } from '../utils/dayjs'\n\nexport interface CalendarEntryDialogProps {\n  entry?: CalendarEntry | null\n}\nexport function CalendarEntryDialog({\n  entry,\n  ...modalProps\n}: CalendarEntryDialogProps & ModalProps): JSX.Element {\n  return (\n    <Modal {...modalProps}>\n      <Modal.Header closeButton>\n        <Modal.Title>\n          <i className={{\n            event: 'bi-stopwatch',\n            ping: 'bi-broadcast-pin',\n          }[entry?.baseEntry.type ?? 'event']} />{' '}\n          {entry?.title}\n          <h6 className=\"m-0\">\n            {{\n              event: 'Timerboard Event',\n              ping: 'Ping',\n            }[entry?.baseEntry.type ?? 'event']}\n          </h6>\n        </Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        {entry?.baseEntry.type === 'event' && (\n          <CalendarEntryEventBody event={entry.baseEntry.event} />\n        )}\n        {entry?.baseEntry.type === 'ping' && (\n          <PingDetails ping={entry.baseEntry.ping} />\n        )}\n      </Modal.Body>\n    </Modal>\n  )\n}\n\nfunction CalendarEntryEventBody({ event }: { event: ApiEventEntry }): JSX.Element {\n  return (\n    <Row className=\"mt-n2\">\n      <Col xs={3}>EVE Time</Col>\n      <Col xs={9}>\n        <Time\n          time={dayjs.utc(event.time)}\n          asLink\n          format=\"YYYY-MM-DD HH:mm\"\n        />\n      </Col>\n\n      <Col xs={3}>Local Time</Col>\n      <Col xs={9}>\n        <Time time={event.time} /> (\n          <RelativeTime time={event.time} />\n        )\n      </Col>\n\n      <Col xs={3}>Priority</Col>\n      <Col xs={9}>{event.priority}</Col>\n\n      <hr className=\"my-1\" />\n\n      <Col xs={3}>System</Col>\n      <Col xs={9}>\n        <SolarSystemLink system={event.system} />\n      </Col>\n\n      <Col xs={3}>Constellation</Col>\n      <Col xs={9}>\n        <ConstellationLink\n          constellation={event.constellation}\n          region={event.region}\n        />\n      </Col>\n\n      <Col xs={3}>Region</Col>\n      <Col xs={9}>\n        <RegionLink\n          region={event.region}\n          system={event.system}\n        />\n      </Col>\n\n      <hr className=\"my-1\" />\n\n      {event.result && (<>\n        <Col xs={3}>Result</Col>\n        <Col xs={9}>{event.result}</Col>\n      </>)}\n\n      <Col xs={3}>Standing</Col>\n      <Col xs={9}>{event.standing}</Col>\n\n      <Col xs={3}>Type</Col>\n      <Col xs={9}>{event.type}</Col>\n\n      <Col xs={3}>Structure</Col>\n      <Col xs={9}>{event.structure}</Col>\n\n      {event.notes && (<>\n        <Col xs={3}>Notes</Col>\n        <Col xs={9}>{event.notes.split('\\n').map(line => (\n          <>{line}<br /></>\n        ))}</Col>\n      </>)}\n    </Row>\n  )\n}\n","import clsx from 'clsx'\nimport { useState } from 'react'\nimport { Time } from './time'\nimport { CalendarEntry, getDisplayedMonthRange } from '../store/calendar-slice'\nimport { dayjs, useDayjsLocale } from '../utils/dayjs'\nimport { CalendarEntryDialog } from './calendar-entry-dialog'\nimport './calendar.scss'\n\nexport const eventColors = [\n  'blue',\n  'indigo',\n  'purple',\n  'pink',\n  'red',\n  'orange',\n  'yellow',\n  'green',\n  'teal',\n  'cyan',\n  'gray',\n] as const\ninterface CalendarProps {\n  year: number\n  month: number\n  events: CalendarEntry[]\n  className?: string\n}\nexport function Calendar({\n  year,\n  month,\n  events,\n  className,\n}: CalendarProps): JSX.Element {\n  const { from, displayedWeeks } = getDisplayedMonthRange({ year, month })\n\n  const [showEntryDialog, setShowEntryDialog] = useState(false)\n  const [selectedEntry, setSelectedEntry] = useState<CalendarEntry | null>(null)\n  const handleClickEntry = (entry: CalendarEntry) => {\n    setShowEntryDialog(true)\n    setSelectedEntry(entry)\n  }\n  const handleHideEntry = () => { setShowEntryDialog(false) }\n\n  const weeks = [...new Array<void>(displayedWeeks)]\n    .map((_, week) => ({\n      week: from.add(week * 7, 'days').week(),\n      days: [...new Array<void>(7)].map((_, day) => {\n        const date = from.add(week * 7 + day, 'days')\n        const start = date.valueOf()\n        const end = date.add(1, 'days').valueOf()\n        const isToday = date.format('YYYY-MM-DD') === dayjs.utc().format('YYYY-MM-DD')\n        return {\n          date,\n          isToday,\n          events: events.filter(e => {\n            const t = dayjs.utc(e.dateTime).valueOf()\n            return t >= start && t < end\n          }).sort((a, b) => dayjs.utc(a.dateTime).valueOf() - dayjs.utc(b.dateTime).valueOf()),\n        }\n      }),\n    }))\n\n  // Update the component when the locale changes\n  useDayjsLocale()\n\n  return (\n    <div className={clsx('d-flex', 'flex-column', 'bg-dark', className)}>\n      {weeks.map((week, i) => (\n        <div key={i}\n          className={clsx(\n            'flex-fill position-relative d-flex flex-grow-1',\n            i > 0 && 'border-top',\n          )}\n        >\n          {/* Week number */}\n          <div className=\"py-1 mx-1\" style={{ width: 28 }}>\n            <div\n              className=\"h-100 rounded-1 px-1 text-center\"\n              style={{ background: 'var(--bs-gray-700)' }}\n            >\n              {week.days[0].date.week()}\n            </div>\n          </div>\n          {/* Days */}\n          {week.days.map((day, j) => (\n            <div key={day.date.date()}\n              aria-hidden={true}\n              className={clsx(\n                'calendar-day',\n                'flex-grow-1',\n                'overflow-hidden',\n                j > 0 && 'border-start',\n                day.date.month() !== month && 'text-muted'\n              )}\n              style={{ flexBasis: 0 }}\n            >\n              {i === 0 &&\n                // display the weekday in the first row of the calendar\n                <div className=\"px-1 text-center text-white\">\n                  {day.date.format('dddd')}\n                </div>\n              }\n              <div className={clsx('day', day.isToday && 'today')}>\n                <span>{day.date.date()}</span>\n              </div>\n              {day.events.map((e, i) => (\n                <div key={i}\n                  className={clsx(\n                    'calendar-event',\n                    e.color ?? 'cyan',\n                  )}\n                  onClick={() => handleClickEntry(e)}\n                >\n                  <Time time={dayjs.utc(e.dateTime)} asLink format=\"HH:mm\" className=\"me-1\" />\n                  <span>\n                    <i className={{\n                      event: 'bi-stopwatch',\n                      ping: 'bi-broadcast-pin',\n                    }[e.baseEntry.type]} />{' '}\n                    {e.title}\n                  </span>\n                </div>\n              ))}\n            </div>\n          ))}\n        </div>\n      ))}\n\n      <CalendarEntryDialog\n        entry={selectedEntry}\n        show={showEntryDialog}\n        onHide={handleHideEntry}\n        fullscreen=\"sm-down\"\n      />\n    </div>\n  )\n}\n","import dayjs from 'dayjs'\nimport { useEffect, useState } from 'react'\nimport { Button, Container } from 'react-bootstrap'\nimport { Navigate, useMatch } from 'react-router-dom'\nimport { UserRoles } from '@ping-board/common'\nimport { useAppDispatch, useAppSelector } from '../hooks/redux'\nimport { useGetUserQuery } from '../store'\nimport { clearCalendarEntries, loadMonth, selectCalendarEvents } from '../store/calendar-slice'\nimport { Calendar } from '../components/calendar'\n\nexport function CalendarPage(): JSX.Element {\n  const dispatch = useAppDispatch()\n  const me = useGetUserQuery()\n  const canRead = me.data?.isLoggedIn && (\n    me.data.character.roles.includes(UserRoles.EVENTS_READ) ||\n    me.data.character.roles.includes(UserRoles.PING)\n  )\n\n  const events = useAppSelector(selectCalendarEvents)\n\n  const [currentMonth, setCurrentMonth] = useState(dayjs.utc())\n  const month = currentMonth.month()\n  const year = currentMonth.year()\n  useEffect(() => {\n    dispatch(loadMonth({ month, year }))\n  }, [dispatch, month, year])\n\n  const handleTodayClicked = () => setCurrentMonth(dayjs.utc())\n  const handleNextMonthClicked = () =>\n    setCurrentMonth(m => m.add(dayjs.duration({ months: 1 })))\n  const handlePrevMonthClicked = () =>\n    setCurrentMonth(m => m.subtract(dayjs.duration({ months: 1 })))\n  const handleReloadClicked = () => {\n    dispatch(clearCalendarEntries())\n    dispatch(loadMonth({ month, year }))\n  }\n\n  const match = useMatch('')\n  if (!me.isFetching) {\n    if (!me.data?.isLoggedIn) {\n      return <Navigate to={`/login?postLoginRedirect=${match?.pathname}`} />\n    }\n    if (!canRead) {\n      return (\n        <Container fluid>\n          <h6>Sorry, you don&apos;t have permission to view this page.</h6>\n        </Container>\n      )\n    }\n  }\n\n  return (\n    <Container fluid className=\"h-100 d-flex flex-column\">\n      <h3 className=\"mt-n1 pt-3\">Calendar</h3>\n      <div className=\"d-flex mb-2\">\n        <Button size=\"sm\" variant=\"outline-light\" className=\"me-2\" onClick={handleTodayClicked}>\n          Today\n        </Button>\n        <Button size=\"sm\" variant=\"outline-light\" className=\"me-2\" onClick={handlePrevMonthClicked}>\n          <i className=\"bi-chevron-left\" />\n        </Button>\n        <Button size=\"sm\" variant=\"outline-light\" className=\"me-2\" onClick={handleNextMonthClicked}>\n          <i className=\"bi-chevron-right\" />\n        </Button>\n        <h4 className=\"h-100 mb-0 me-2 align-middle\">{currentMonth.format('MMMM YYYY')}</h4>\n        <Button size=\"sm\" variant=\"outline-light\" onClick={handleReloadClicked}>\n          <i className=\"bi-arrow-clockwise\" /> Reload\n        </Button>\n      </div>\n      <Calendar\n        className=\"flex-fill mb-2\"\n        year={currentMonth.year()}\n        month={currentMonth.month()}\n        events={events}\n      />\n    </Container>\n  )\n}\n","import { ChangeEvent, useEffect } from 'react'\nimport { useState } from 'react'\nimport { Col, Form, Row, RowProps } from 'react-bootstrap'\nimport { Dayjs, dayjs } from '../utils/dayjs'\n\nexport interface DateTimeInputProps extends Omit<RowProps, 'onChange'> {\n  allowPast?: boolean\n  value: Date | string | Dayjs\n  onChange: (date: Dayjs) => void\n}\nexport function DateTimeInput({\n  allowPast = true,\n  value: date,\n  onChange,\n  ...rowProps\n}: DateTimeInputProps): JSX.Element {\n  const dateFormat = 'YYYY-MM-DD'\n  const timeFormat = 'HH:mm'\n  const timeBaseDate = '1970-01-01' // Date used for HH:mm calculations\n\n  const [dateInputText, setDateInputText] = useState('')\n  const [timeInputText, setTimeInputText] = useState('')\n\n  useEffect(() => {\n    const propDateTime = dayjs.utc(date)\n\n    const inputDateTime = dayjs.utc(`${dateInputText}T${timeInputText}`)\n    if (!propDateTime.isSame(inputDateTime)) {\n      setDateInputText(propDateTime.format(dateFormat))\n      setTimeInputText(propDateTime.format(timeFormat))\n    }\n  // We only want to run this when the date prop changes, not when the input fields change\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [date])\n\n  const parseDateTime = (date: string, time: string): Dayjs => {\n    const d = dayjs.utc(date)\n    const t = dayjs.duration(\n      dayjs.utc(`${timeBaseDate}T${time}`).diff(dayjs.utc(timeBaseDate))\n    )\n    return d.add(t)\n  }\n\n  const handleDateInputChange = (e: ChangeEvent<HTMLInputElement>) => {\n    const { value } = e.target\n    setDateInputText(value)\n\n    const date = dayjs.utc(value)\n    if (!date.isValid()) {\n      return\n    }\n    const dateTime = parseDateTime(value, timeInputText)\n    if (dateTime.isValid()) {\n      onChange(dateTime)\n    }\n  }\n\n  const handleTimeInputChange = (e: ChangeEvent<HTMLInputElement>) => {\n    const { value } = e.target\n    setTimeInputText(value)\n\n    const time = dayjs.utc(`${timeBaseDate}T${value}`)\n    if (!time.isValid()) {\n      return\n    }\n    const dateTime = parseDateTime(dateInputText, value)\n    console.log({ dateTime, allowPast, isBeforeNow: dateTime.isBefore(dayjs()) })\n    if (dateTime.isValid() && (allowPast || !dateTime.isBefore(dayjs()))) {\n      onChange(dateTime)\n    }\n  }\n\n  /** Update the input field values when they lose focus */\n  const handleBlur = () => {\n    let dateTime = parseDateTime(dateInputText, timeInputText)\n    if (!dateTime.isValid()) {\n      dateTime = dayjs(date)\n    }\n    if (!allowPast && dateTime.isBefore(dayjs())) {\n      dateTime = dayjs()\n      onChange(dateTime)\n    }\n    setDateInputText(dateTime.format(dateFormat))\n    setTimeInputText(dateTime.format(timeFormat))\n  }\n\n  return (\n    <Row {...rowProps}>\n      <Form.Group as={Col} controlId=\"date\" xs={6} className=\"mb-3\">\n        <Form.Label className=\"text-nowrap\">Date</Form.Label>\n        <Form.Control\n          type=\"date\"\n          value={dateInputText}\n          pattern=\"^[0-9]{4}-[0-9]{2}-[0-9]{2}$\"\n          min={allowPast ? undefined : dayjs().toISOString().split('T', 1)[0]}\n          onChange={handleDateInputChange}\n          onBlur={handleBlur}\n        />\n      </Form.Group>\n      <Form.Group as={Col} controlId=\"time\" xs={6} className=\"mb-3\">\n        <Form.Label className=\"text-nowrap\">Time</Form.Label>\n        <Form.Control\n          type=\"text\"\n          maxLength={5}\n          pattern=\"^[0-9]{2}:[0-9]{2}$\"\n          value={timeInputText}\n          onChange={handleTimeInputChange}\n          onBlur={handleBlur}\n        />\n      </Form.Group>\n    </Row>\n  )\n}\n","import { useEffect, useState } from 'react'\nimport { Col, Form, Row, RowProps } from 'react-bootstrap'\nimport { dayjs, Duration, DurationUnitsObjectType } from '../utils/dayjs'\n\ninterface DurationComponent {\n  label: string\n  unit: keyof DurationUnitsObjectType\n  format: string | ((duration: Duration) => string | number)\n}\nconst defaultDurationComponents: DurationComponent[] = [\n  { label: 'Days', unit: 'days', format: dur => dur.asDays() | 0 },\n  { label: 'Hours', unit: 'hours', format: 'HH' },\n  { label: 'Minutes', unit: 'minutes', format: 'mm' },\n]\n\nexport interface RelativeTimeInputProps extends Omit<RowProps, 'onChange'> {\n  allowNegative?: boolean\n  value: Duration\n  onChange: (value: Duration) => void\n  durationComponents?: DurationComponent[]\n}\nexport function RelativeTimeInput({\n  allowNegative = true,\n  value: duration,\n  onChange,\n  durationComponents = defaultDurationComponents,\n  ...rowProps\n}: RelativeTimeInputProps): JSX.Element {\n  const durationFromTexts = (texts: string[]) => {\n    const ms = dayjs.duration(Object.fromEntries(\n      durationComponents.map(({ unit }, i) => {\n        const value = parseInt(texts[i], 10)\n        return [unit, isFinite(value) ? value : 0]\n      })\n    )).asMilliseconds()\n    if (!allowNegative && ms < 0) {\n      return dayjs.duration(0)\n    }\n    return dayjs.duration(ms, 'ms')\n  }\n  const textsFromDuration = (duration: Duration) => durationComponents\n    .map(({ format }) => typeof format === 'function'\n      ? `${format(duration)}`\n      : dayjs.duration(duration.asMilliseconds(), 'milliseconds').format(format)\n    )\n\n  const [inputTexts, setInputTexts] = useState(textsFromDuration(duration))\n\n  useEffect(() => {\n    const inputDuration = textsFromDuration(durationFromTexts(inputTexts))\n    const propDuration = textsFromDuration(duration)\n    if (inputDuration.some((c, i) => c !== propDuration[i])) {\n      setInputTexts(textsFromDuration(duration))\n    }\n  // We only want to run this when the duration prop changes, not when the input fields change\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [duration])\n\n  const handleInputTextChange = (index: number, text: string) => {\n    const newTexts = inputTexts.map((t, i) => i === index ? text : t)\n    setInputTexts(newTexts)\n    onChange(durationFromTexts(newTexts))\n  }\n\n  /** Update the input field values when they lose focus */\n  const handleBlur = () => {\n    setInputTexts(textsFromDuration(duration))\n  }\n\n  return (\n    <Row {...rowProps}>\n      {durationComponents.map(({ label }, i) => (\n        <Form.Group key={label} as={Col} xs={12 / durationComponents.length}>\n          <Form.Label>{label}</Form.Label>\n          <Form.Control\n            type=\"number\"\n            pattern=\"^-?[0-9]*$\"\n            value={inputTexts[i]}\n            onChange={e => handleInputTextChange(i, e.target.value)}\n            onBlur={handleBlur}\n          />\n        </Form.Group>\n      ))}\n    </Row>\n  )\n}\n","import { useEffect, useState } from 'react'\nimport { dayjs, Dayjs, Duration } from '../utils/dayjs'\n\nexport type TimeInputMode = 'absolute' | 'relative'\nexport interface UseAbsoluteRelativeTimeInputReturn {\n  absoluteTime: Dayjs\n  relativeTime: Duration\n\n  handleChangeInputMode: (mode: TimeInputMode) => void\n  inputMode: TimeInputMode\n\n  handleAbsoluteDateChange: (date: Dayjs) => void\n  handleRelativeDateChange: (relative: Duration) => void\n}\n\nexport type AbsoluteOrRelativeTime =\n  | { absolute: Dayjs }\n  | { relative: Duration }\n\nexport interface UseAbsoluteRelativeTimeInputOptions {\n  allowPast?: boolean\n  time: AbsoluteOrRelativeTime\n  onChange: (newValue: AbsoluteOrRelativeTime) => void\n}\n\nexport function useAbsoluteRelativeTimeInput({\n  allowPast = true,\n  time,\n  onChange,\n}: UseAbsoluteRelativeTimeInputOptions): UseAbsoluteRelativeTimeInputReturn {\n  const handleChangeInputMode = (mode: TimeInputMode) => {\n    if (mode === 'absolute' && 'relative' in time) {\n      onChange({ absolute: dayjs().add(time.relative).utc() })\n    } else if (mode === 'relative' && 'absolute' in time) {\n      onChange({ relative: dayjs.duration(time.absolute.diff(dayjs())) })\n    }\n  }\n  const handleAbsoluteDateChange = (absolute: Dayjs) => onChange({\n    absolute: !allowPast && absolute.isBefore(dayjs()) ? dayjs() : absolute,\n  })\n  const handleRelativeDateChange = (relative: Duration) => onChange({\n    relative: !allowPast && relative.asMilliseconds() < 0 ? dayjs.duration(0) : relative,\n  })\n\n  const inputMode: TimeInputMode = 'absolute' in time ? 'absolute' : 'relative'\n\n  const [times, setTimes] = useState(calculateTimes(time))\n  useEffect(() => {\n    const updateTimes = () => setTimes(calculateTimes(time))\n    const interval = setInterval(updateTimes, 1000)\n    updateTimes()\n    return () => clearInterval(interval)\n  }, [time])\n\n  return {\n    handleChangeInputMode,\n    handleAbsoluteDateChange,\n    handleRelativeDateChange,\n    inputMode,\n    ...times,\n  }\n}\n\nexport function toAbsoluteTime(time: AbsoluteOrRelativeTime): Dayjs {\n  return 'absolute' in time ? time.absolute : dayjs().add(time.relative).utc()\n}\nexport function toRelativeTime(time: AbsoluteOrRelativeTime): Duration {\n  return 'relative' in time ? time.relative : dayjs.duration(time.absolute.diff(dayjs()))\n}\n\nfunction calculateTimes(time: AbsoluteOrRelativeTime): {\n  absoluteTime: Dayjs\n  relativeTime: Duration\n} {\n  return {\n    absoluteTime: toAbsoluteTime(time),\n    relativeTime: toRelativeTime(time),\n  }\n}\n","import clsx from 'clsx'\nimport Fuse from 'fuse.js'\nimport {\n  ChangeEvent,\n  KeyboardEvent,\n  MouseEvent,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react'\nimport { Form, FormControlProps, ListGroup } from 'react-bootstrap'\nimport { usePopper } from 'react-popper'\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\ntype ObjectPathImpl<T, K extends keyof T> =\n  K extends string\n  ? T[K] extends Record<string, any>\n    ? | `${K}.${ObjectPathImpl<T[K], Exclude<keyof T[K], keyof Array<any>> & string>}`\n      | `${K}.${Exclude<keyof T[K], keyof Array<any>> & string}`\n    : never\n  : never\ntype ObjectPath<T> = ObjectPathImpl<T, keyof T> | (string & keyof T)\n/* eslint-enable @typescript-eslint/no-explicit-any */\n\ninterface AutocompleteOptionKeyObject<T> {\n  name: ObjectPath<T> | ObjectPath<T>[]\n  weight: number\n}\nexport type AutocompleteOptionKey<T> =\n  | AutocompleteOptionKeyObject<T>\n  | ObjectPath<T>\n  | ObjectPath<T>[]\n\ntype FormControlRestProps = Omit<FormControlProps, 'value' | 'onChange' | 'type'>\nexport interface AutocompleteProps<T> extends FormControlRestProps {\n  options: T[]\n  resultLimit?: number\n  optionName: (option: T) => string\n  loadingText?: React.ReactNode\n  searchKeys: AutocompleteOptionKey<T>[]\n  value: string | null\n  onChange: (newValue: T | null) => void\n  renderOption?: (option: T) => React.ReactNode\n}\nexport function Autocomplete<T>({\n  options,\n  resultLimit,\n  optionName,\n  loadingText,\n  searchKeys,\n  value,\n  onChange,\n  renderOption = optionName,\n  ...controlProps\n}: AutocompleteProps<T>): JSX.Element {\n  const [input, setInput] = useState('')\n  const [results, setResults] = useState<Fuse.FuseResult<T>[]>([])\n  const [selectedResultIndex, setSelectedResultIndex] = useState(0)\n\n  const [active, setActive] = useState(false)\n\n  const fuse = useMemo(() => new Fuse(options, {\n    keys: searchKeys,\n    distance: 10,\n    threshold: 0.3,\n  }), [options, searchKeys])\n\n  const updateSearch = useCallback((search: string) => {\n    const newResults = fuse.search(search)\n    if (typeof resultLimit === 'number') {\n      setResults(newResults.slice(0, resultLimit))\n    } else {\n      setResults(newResults)\n    }\n    return newResults\n  }, [fuse, resultLimit])\n\n  useEffect(() => {\n    if (!value) {\n      setInput('')\n      setResults([])\n      setSelectedResultIndex(0)\n      return\n    }\n    const newResults = updateSearch(value)\n    const index = newResults.findIndex(r => optionName(r.item) === value)\n    if (index >= 0) {\n      setInput(optionName(newResults[index].item))\n      setSelectedResultIndex(index)\n    } else {\n      setInput('')\n      setSelectedResultIndex(0)\n    }\n  }, [value, fuse, optionName, updateSearch])\n\n  const handleInputChanged = (e: ChangeEvent<HTMLInputElement>) => {\n    setInput(e.target.value)\n    updateSearch(e.target.value)\n  }\n  const handleFocus = () => {\n    setActive(true)\n  }\n  const handleSelectResult = (result: T) => {\n    const name = optionName(result)\n    setInput(name)\n    const newResults = updateSearch(name)\n    const newResultIndex = newResults.findIndex(r => optionName(r.item) === name)\n    setSelectedResultIndex(Math.max(newResultIndex, 0))\n    onChange(result)\n\n    setActive(false)\n  }\n  const handleBlur = () => {\n    if (results.length > 0) {\n      if (selectedResultIndex >= 0 && selectedResultIndex < results.length) {\n        const option = results[selectedResultIndex].item\n        handleSelectResult(option)\n      }\n    } else {\n      setInput('')\n      onChange(null)\n    }\n    setActive(false)\n  }\n  const handleKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {\n      const diff = e.key === 'ArrowDown' ? 1 : -1\n      const newIndex = Math.max(0, Math.min(results.length -1, selectedResultIndex + diff))\n      setSelectedResultIndex(newIndex)\n      if (results.length > 0) {\n        setInput(optionName(results[newIndex].item))\n      }\n      e.preventDefault()\n    } else if (e.key === 'Enter') {\n      if (selectedResultIndex >= 0 && selectedResultIndex < results.length) {\n        const selectedResult = results[selectedResultIndex].item\n        handleSelectResult(selectedResult)\n      }\n    } else {\n      setActive(true)\n    }\n  }\n  const optionClickHandler = (option: T) => (e: MouseEvent) => {\n    e.preventDefault()\n    const selectedResultIndex = results.findIndex(r => r.item === option)\n    const index = Math.max(0, Math.min(results.length - 1, selectedResultIndex))\n    setSelectedResultIndex(index)\n    if (results.length > 0) {\n      setInput(optionName(option))\n      handleSelectResult(option)\n    }\n  }\n\n  const referenceElement = useRef<HTMLElement>(null)\n  const popperElement = useRef<HTMLDivElement>(null)\n  const [optionRef, setOptionRef] = useState<HTMLElement | null>(null)\n  const getSetOptionRef = (isActive: boolean) =>\n    !isActive ? () => {} : (ref: HTMLElement | null | undefined) => {\n    if (ref && optionRef !== ref) {\n      setOptionRef(ref)\n      ref.scrollIntoView({ block: 'nearest' })\n    }\n  }\n\n  const popper = usePopper(referenceElement.current, popperElement.current, {\n    placement: 'bottom',\n    modifiers: [{ name: 'flip' }],\n  })\n\n  return (\n    <div className=\"position-relative\">\n      <Form.Control\n        ref={referenceElement}\n        type=\"text\"\n        value={input}\n        onChange={handleInputChanged}\n        onFocus={handleFocus}\n        onBlur={handleBlur}\n        onKeyDown={handleKeyDown}\n        {...controlProps}\n      />\n      <ListGroup ref={popperElement}\n        className={clsx('shadow', 'w-100', !active && 'invisible')}\n        style={{\n          ...popper.styles.popper,\n          maxHeight: '50vh',\n          overflow: 'hidden auto',\n          zIndex: 1000,\n        }}\n        {...popper.attributes.popper}\n      >\n        {loadingText\n          ? <ListGroup.Item>{loadingText}</ListGroup.Item>\n          : results.map((res, i) => (\n            <ListGroup.Item\n              key={optionName(res.item)}\n              action\n              tabIndex={-1}\n              onMouseDown={e => e.preventDefault()}\n              onClick={optionClickHandler(res.item)}\n              ref={getSetOptionRef(i === selectedResultIndex)}\n              active={i === selectedResultIndex}\n            >\n              {renderOption(res.item)}\n            </ListGroup.Item>\n          ))\n        }\n      </ListGroup>\n    </div>\n  )\n}\n","import { useCallback, useMemo } from 'react'\nimport { SolarSystem } from '@ping-board/common'\nimport {\n  Autocomplete,\n  AutocompleteOptionKey,\n  AutocompleteProps,\n} from './autocomplete'\nimport { useGetSolarSystemsQuery } from '../store'\n\ntype AutocompleteRestProps = Omit<\n  AutocompleteProps<SolarSystem>,\n  'options' | 'searchKeys' | 'value' | 'onChange' | 'optionName'\n>\nexport interface SolarSystemInputProps extends AutocompleteRestProps {\n  value: string | null\n  onChange: (newValue: SolarSystem | null) => void\n}\nexport function SolarSystemInput({\n  value,\n  onChange,\n  ...autocompleteProps\n}: SolarSystemInputProps & AutocompleteRestProps): JSX.Element {\n  const query = useGetSolarSystemsQuery()\n  const systems = query.data?.solarSystems ?? []\n\n  const searchKeys = useMemo<AutocompleteOptionKey<SolarSystem>[]>(() => [\n    { name: 'name', weight: 100 },\n    { name: 'constellation', weight: 10 },\n    { name: 'region', weight: 1 },\n  ], [])\n\n  const renderOption = useCallback((option: SolarSystem) => (\n    `${option.name} (${option.constellation}, ${option.region})`\n  ), [])\n  const optionName = useCallback((option: SolarSystem) => option.name, [])\n\n  return (\n    <Autocomplete\n      options={systems}\n      optionName={optionName}\n      loadingText={query.isFetching\n        ? <>loading&hellip;</>\n        : query.isError\n          ? 'error loading systems'\n          : false\n      }\n      resultLimit={50}\n      searchKeys={searchKeys}\n      value={value}\n      onChange={onChange}\n      renderOption={renderOption}\n      {...autocompleteProps}\n    />\n  )\n}\n","import clsx from 'clsx'\nimport { ChangeEvent, useEffect, useState } from 'react'\nimport { Button, Col, Form, Modal, Row } from 'react-bootstrap'\nimport { ApiEventEntry, ApiEventEntryInput } from '@ping-board/common'\nimport { DateTimeInput } from './date-time-input'\nimport { RelativeTimeInput } from './relative-time-input'\nimport {\n  AbsoluteOrRelativeTime,\n  useAbsoluteRelativeTimeInput,\n} from '../hooks/use-absolute-relative-time-input'\nimport { dayjs } from '../utils/dayjs'\nimport { SolarSystemInput } from './solar-system-input'\nimport './edit-event-dialog.scss'\n\ntype EditedEvent = Omit<ApiEventEntryInput, 'time'>\n\nconst priorities = ['Low', 'Medium', 'High', 'Critical']\nconst structureTypes: [value: string, title: string][] = [\n  ['TCU', 'TCU'],\n  ['IHub', 'IHub'],\n  ['POS', 'POS'],\n  ['POCO', 'POCO'],\n  ['Raitaru', 'Raitaru'],\n  ['Azbel', 'Azbel'],\n  ['Sotiyo', 'Sotiyo'],\n  ['Athanor', 'Athanor'],\n  ['Tatara', 'Tatara'],\n  ['Astrahus', 'Astrahus'],\n  ['Fortizar', 'Fortizar'],\n  ['Keepstar', 'Keepstar'],\n  ['Pharolynx', 'Pharolynx Cyno Beacon'],\n  ['Tenebrex', 'Tenebrex Cyno Jammer'],\n  ['Ansiblex', 'Ansiblex Jump Gate'],\n  ['other', 'other'],\n]\nconst eventTypes = ['Anchoring', 'Shield', 'Armor', 'Structure', 'other']\nconst standings = ['friendly', 'enemy', 'neutral', 'other']\nconst result = ['No data', 'Win', 'Loss']\n\nexport interface EditEventDialogProps {\n  show: boolean\n  event?: ApiEventEntry | null\n  onSave?: (event: ApiEventEntryInput) => void\n  onCancel?: () => void\n  onDelete?: () => void\n}\nexport function EditEventDialog({\n  show,\n  event,\n  onSave,\n  onCancel,\n  onDelete,\n}: EditEventDialogProps): JSX.Element {\n  const [editedEvent, setEditedEvent] = useState<EditedEvent>(getDefaultEditedEvent())\n  const [inputTime, setInputTime] = useState<AbsoluteOrRelativeTime>({\n    relative: dayjs.duration(0),\n  })\n\n  useEffect(() => {\n    if (!show) {\n      return\n    }\n    if (event) {\n      setEditedEvent({ ...event })\n      setInputTime({ absolute: dayjs.utc(event.time) })\n    } else {\n      setEditedEvent(getDefaultEditedEvent())\n      setInputTime({ relative: dayjs.duration(0) })\n    }\n  }, [event, show])\n\n  const timeInput = useAbsoluteRelativeTimeInput({ time: inputTime, onChange: setInputTime })\n\n  const canSave = Object.entries(editedEvent ?? {}).every(([k, v]) => k === 'notes' || !!v)\n  const save = () => {\n    if (canSave && onSave) {\n      onSave({\n        ...editedEvent,\n        time: timeInput.absoluteTime.toISOString(),\n      })\n      setEditedEvent(getDefaultEditedEvent())\n    }\n  }\n\n  const isNewEvent = typeof event?.id !== 'number'\n  const lastEdited = !isNewEvent && [\n    `Last edited by ${event?.updatedBy ?? 'unknown'}`,\n    event?.updatedAt\n      ? `at ${dayjs(event.updatedAt).format('llll')} (${dayjs(event.updatedAt).fromNow()})`\n      : 'unknown',\n  ].join(' ')\n  const usesAbsoluteTime = timeInput.inputMode === 'absolute'\n\n  const setEventField = <T extends keyof EditedEvent>(field: T, value: EditedEvent[T]) => {\n    setEditedEvent(e => ({ ...e, [field]: value }))\n  }\n\n  type ValueKeys<T, V> = { [K in keyof T]: T[K] extends V ? T[K] : never }\n  const handleSelectValueChange = <T extends keyof ValueKeys<EditedEvent, string>>(field: T) =>\n    (e: ChangeEvent<HTMLSelectElement>) => setEventField(field, e.target.value as EditedEvent[T])\n\n  const [isDeletePending, setIsDeletePending] = useState(false)\n  const handleStartDelete = () => setIsDeletePending(true)\n  const handleCancelDelete = () => setIsDeletePending(false)\n  const handleConfirmDelete = () => {\n    setIsDeletePending(false)\n    onDelete?.()\n    setEditedEvent(getDefaultEditedEvent())\n  }\n\n  return (\n    <Modal show={show} size=\"lg\" backdrop=\"static\" dialogClassName=\"edit-event-dialog\">\n      <Modal.Header>\n        <Modal.Title>{isNewEvent ? 'Add' : 'Edit'} Event</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <Form>\n          <Row>\n            {lastEdited && <Col xs={12} className=\"mb-3\">{lastEdited}</Col>}\n\n            <Form.Group as={Col} controlId=\"solarSystem\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Solar System</Form.Label>\n              <SolarSystemInput\n                value={editedEvent.system}\n                onChange={s => setEventField('system', s?.name ?? '')}\n                placeholder=\"e.g. Q-5211\"\n              />\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"priority\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Priority</Form.Label>\n              <Form.Select\n                value={editedEvent.priority}\n                onChange={handleSelectValueChange('priority')}\n              >\n                <option value=\"\">(Please Select)</option>\n                {priorities.map(prio => (\n                  <option key={prio} value={prio}>\n                    {prio}\n                  </option>\n                ))}\n              </Form.Select>\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"structure\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Structure</Form.Label>\n              <Form.Select\n                value={editedEvent.structure}\n                onChange={handleSelectValueChange('structure')}\n              >\n                <option value=\"\">(Please Select)</option>\n                {structureTypes.map(([value, title]) => (\n                  <option key={value} value={value}>\n                    {title}\n                  </option>\n                ))}\n              </Form.Select>\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"type\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Type</Form.Label>\n              <Form.Select\n                value={editedEvent.type}\n                onChange={handleSelectValueChange('type')}\n              >\n                <option value=\"\">(Please Select)</option>\n                {eventTypes.map(type => (\n                  <option key={type} value={type}>\n                    {type}\n                  </option>\n                ))}\n              </Form.Select>\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"standing\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Standing</Form.Label>\n              <Form.Select\n                value={editedEvent.standing}\n                onChange={handleSelectValueChange('standing')}\n              >\n                <option value=\"\">(Please Select)</option>\n                {standings.map(type => (\n                  <option key={type} value={type}>\n                    {type}\n                  </option>\n                ))}\n              </Form.Select>\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"result\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Result</Form.Label>\n              <Form.Select\n                value={editedEvent.result}\n                onChange={handleSelectValueChange('result')}\n              >\n                {result.map(type => (\n                  <option key={type} value={type}>\n                    {type}\n                  </option>\n                ))}\n              </Form.Select>\n            </Form.Group>\n\n            <Col xs={12}>\n              <Form.Label>Event Time</Form.Label>\n            </Col>\n\n            <Form.Group as={Col} controlId=\"eveDateTime\" xs={12} lg={6}>\n              <Form.Label>\n                <Form.Check\n                  inline\n                  label=\"Use EVE Date and Time\"\n                  name=\"eveDateTimeMode\"\n                  type=\"radio\"\n                  onChange={() => timeInput.handleChangeInputMode('absolute')}\n                  id=\"absolute\"\n                  checked={usesAbsoluteTime}\n                />\n              </Form.Label>\n              <DateTimeInput\n                value={timeInput.absoluteTime}\n                onChange={timeInput.handleAbsoluteDateChange}\n                className={clsx('time-mode-input', !usesAbsoluteTime && 'inactive-time-mode')}\n              />\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"relativeTime\" xs={12} lg={6}>\n              <Form.Label>\n                <Form.Check\n                  inline\n                  label=\"Use Relative Time\"\n                  name=\"eveDateTimeMode\"\n                  type=\"radio\"\n                  onChange={() => timeInput.handleChangeInputMode('relative')}\n                  id=\"relative\"\n                  checked={!usesAbsoluteTime}\n                />\n              </Form.Label>\n              <RelativeTimeInput\n                value={timeInput.relativeTime}\n                onChange={timeInput.handleRelativeDateChange}\n                className={clsx('time-mode-input', usesAbsoluteTime && 'inactive-time-mode')}\n              />\n            </Form.Group>\n\n            {/*\n              Show a horizontal divider on smaller screens ( md) to make it more obvious that\n              the inputs below are not affected by the absolute/relative time radio buttons\n            */}\n            <Col xs={12} className=\"d-block d-lg-none\">\n              <hr />\n            </Col>\n\n            <Form.Group as={Col} controlId=\"notes\" xs={12} className=\"mb-3\">\n              <Form.Label>Notes</Form.Label>\n              <Form.Control\n                as=\"textarea\"\n                rows={1}\n                value={editedEvent?.notes ?? ''}\n                onChange={e => setEventField('notes', e.target.value)}\n              />\n            </Form.Group>\n          </Row>\n        </Form>\n      </Modal.Body>\n      <Modal.Footer className=\"dialog-footer\">\n        <div className={clsx('dialog-buttons-wrapper', isDeletePending && 'hidden')}>\n          {!isNewEvent && (\n            <>\n              <Button\n                variant=\"danger\"\n                disabled={isDeletePending}\n                onClick={handleStartDelete}\n              >\n                Delete\n              </Button>\n              <div className=\"dialog-buttons-spacer\" />\n            </>\n          )}\n          <Button variant=\"secondary\" onClick={onCancel} disabled={isDeletePending}>\n            Cancel\n          </Button>\n          <Button variant=\"primary\" disabled={!canSave || isDeletePending} onClick={save}>\n            Save\n          </Button>\n        </div>\n        {!isNewEvent && (\n          <div className={clsx(\n            'confirm-delete-buttons-wrapper',\n            !isDeletePending && 'hidden'\n          )}>\n            <Button disabled={!isDeletePending} onClick={handleCancelDelete}>\n              No\n            </Button>\n            <div className=\"dialog-buttons-spacer\">\n              Are you sure you want to delete the event?\n            </div>\n            <Button variant=\"danger\" disabled={!isDeletePending} onClick={handleConfirmDelete}>\n              Yes\n            </Button>\n          </div>\n        )}\n      </Modal.Footer>\n    </Modal>\n  )\n}\n\nfunction getDefaultEditedEvent(): EditedEvent {\n  return {\n    system: '',\n    priority: '',\n    structure: '',\n    type: '',\n    standing: '',\n    result: 'No data',\n    notes: '',\n  }\n}\n","import clsx from 'clsx'\nimport dayjs from 'dayjs'\nimport { Button, Table } from 'react-bootstrap'\nimport { ApiEventEntry } from '@ping-board/common'\nimport { RegionLink } from './region-link'\nimport { RelativeTime } from './relative-time'\nimport { SolarSystemLink } from './solar-system-link'\nimport { Time } from './time'\nimport './events-table.scss'\n\nexport interface EventsTableProps {\n  showResultColumn?: boolean\n  canEdit?: boolean\n  onEdit?: (event: ApiEventEntry) => void\n  events: ApiEventEntry[]\n}\nexport function EventsTable({\n  showResultColumn = false,\n  canEdit = false,\n  onEdit,\n  events,\n}: EventsTableProps): JSX.Element {\n  const getRowClass = (event: ApiEventEntry): string => {\n    const time = Date.parse(event.time)\n    const now = Date.now()\n    if (Math.abs(time - now) < 1000 * 60 * 60) {\n      return 'present'\n    }\n    return time > now ? 'future' : 'past'\n  }\n\n  return (\n    <Table hover size=\"sm\" variant=\"dark\" responsive className=\"events-table\">\n      <thead>\n        <tr className=\"events-header-row\">\n          <th>System</th>\n          <th>Region</th>\n          <th>Priority</th>\n          <th>Structure</th>\n          <th>Type</th>\n          <th>Standing</th>\n          <th>Relative Time</th>\n          <th>Local Time</th>\n          <th>EVE Time</th>\n          {showResultColumn && <th>Result</th>}\n          <th>Notes</th>\n          {canEdit && <th>Action</th>}\n        </tr>\n      </thead>\n      <tbody>\n        {events.length === 0 && (\n          <tr>\n            <td colSpan={10 + (+showResultColumn) + (+canEdit)}>\n              No Events\n            </td>\n          </tr>\n        )}\n        {events.map(event => (\n          <tr key={event.id} className={clsx('event-row', getRowClass(event))}>\n            <th scope=\"row\"><SolarSystemLink system={event.system} /></th>\n            <td><RegionLink system={event.system} region={event.region} /></td>\n            <td>{event.priority}</td>\n            <td>{event.structure}</td>\n            <td>{event.type}</td>\n            <td>{event.standing}</td>\n            <td><RelativeTime time={event.time} /></td>\n            <td><Time time={event.time} /></td>\n            <td><Time time={dayjs(event.time).utc()} format=\"YYYY-MM-DD HH:mm\" asLink /></td>\n            {showResultColumn && (\n              <td>{event.result}</td>\n            )}\n            <td className=\"event-notes\">{event.notes}</td>\n            {canEdit && (\n              <td>\n                <Button size=\"sm\" onClick={() => onEdit?.(event)}>\n                  <i className=\"bi-pencil\" /> Edit\n                </Button>\n              </td>\n            )}\n          </tr>\n        ))}\n      </tbody>\n    </Table>\n  )\n}\n","import { ApiEventEntry, ApiEventEntryInput, UserRoles } from '@ping-board/common'\nimport { useEffect, useState } from 'react'\nimport { Button, Container } from 'react-bootstrap'\nimport { Navigate, useMatch } from 'react-router-dom'\nimport {\n  useAddEventMutation,\n  useDeleteEventMutation,\n  useGetUserQuery,\n  useUpdateEventMutation,\n} from '../store'\nimport { useEventsList } from '../hooks/use-events-list'\nimport { EditEventDialog } from '../components/edit-event-dialog'\nimport { EventsTable } from '../components/events-table'\nimport './timers.scss'\n\nexport function TimersPage(): JSX.Element {\n  const me = useGetUserQuery()\n\n  const canEdit = me.data?.isLoggedIn && me.data.character.roles.includes(UserRoles.EVENTS_EDIT)\n  const canAdd = canEdit || (\n    me.data?.isLoggedIn && me.data.character.roles.includes(UserRoles.EVENTS_ADD)\n  )\n  const canRead = me.data?.isLoggedIn && me.data.character.roles.includes(UserRoles.EVENTS_READ)\n\n  const eventsList = useEventsList({ skip: me.isLoading || !canRead })\n\n  const [addEvent, addEventState] = useAddEventMutation()\n  const [updateEvent, updateEventState] = useUpdateEventMutation()\n  const [deleteEvent, deleteEventState] = useDeleteEventMutation()\n\n  const [saveState, setSaveState] = useState<'add' | 'edit' | 'delete' | null>(null)\n  const isSaving = !!saveState\n  useEffect(() => {\n    let state: (typeof addEventState) | (typeof updateEventState) | (typeof deleteEventState)\n    switch (saveState) {\n      case 'add':    state = addEventState; break\n      case 'edit':   state = updateEventState; break\n      case 'delete': state = deleteEventState; break\n      default: return\n    }\n    if (!state.isLoading) {\n      if (state.isError) {\n        console.log('An Error occurred trying to', saveState, 'an event', state.error)\n      }\n      setSaveState(null)\n    }\n  }, [addEventState, deleteEventState, eventsList, saveState, updateEventState])\n\n  const [eventDialogState, setEventDialogState] = useState({\n    event: null as ApiEventEntry | null,\n    show: false,\n  })\n\n  const editEvent = (event: ApiEventEntry) => setEventDialogState({ event, show: true })\n  const addNewEvent = () => setEventDialogState({ event: null, show: true })\n  const cancelEdit = () => setEventDialogState({ event: null, show: false })\n  const confirmEditEvent = (event: ApiEventEntryInput) => {\n    if (!eventDialogState.event) {\n      setSaveState('add')\n      addEvent(event)\n    } else {\n      setSaveState('edit')\n      updateEvent({ id: eventDialogState.event.id, event })\n    }\n    cancelEdit()\n  }\n  const deleteEditedEvent = () => {\n    const { event } = eventDialogState\n    if (!event) {\n      return\n    }\n    setSaveState('delete')\n    deleteEvent(event.id)\n    cancelEdit()\n  }\n\n  const match = useMatch('')\n  if (!me.isFetching) {\n    if (!me.data?.isLoggedIn) {\n      return <Navigate to={`/login?postLoginRedirect=${match?.pathname}`} />\n    }\n    if (!canRead) {\n      return (\n        <Container fluid>\n          <h6>Sorry, you don&apos;t have permission to view this page.</h6>\n        </Container>\n      )\n    }\n  }\n\n  return (\n    <Container fluid>\n      <div className=\"timers-header\">\n        <h3>Timers</h3>\n        <Button onClick={eventsList.reloadEvents} disabled={isSaving}>\n          <i className=\"bi-arrow-clockwise\" /> Reload\n        </Button>\n        <div style={{ flex: 1 }} />\n        {canAdd &&\n          <Button onClick={addNewEvent} disabled={isSaving}>\n            <i className=\"bi-calendar-plus\" /> New Event\n          </Button>\n        }\n      </div>\n\n      <EventsTable\n        events={eventsList.events}\n        showResultColumn\n        canEdit={canEdit}\n        onEdit={editEvent}\n      />\n\n      <Button\n        className=\"w-100 mb-3\"\n        disabled={!eventsList.hasMoreEvents || eventsList.loading || isSaving}\n        onClick={eventsList.loadMoreEvents}\n      >\n        {eventsList.loading\n          ? 'Loading'\n          : eventsList.hasMoreEvents\n            ? 'Load more'\n            : '(No more events)'\n        }\n      </Button>\n\n      <EditEventDialog\n        show={eventDialogState.show}\n        event={eventDialogState.event}\n        onCancel={cancelEdit}\n        onSave={confirmEditEvent}\n        onDelete={deleteEditedEvent}\n      />\n    </Container>\n  )\n}\n","import { useEffect } from 'react'\nimport { ApiEventEntry } from '@ping-board/common'\nimport { useAppDispatch, useAppSelector } from './redux'\nimport {\n  loadMoreEvents,\n  reloadEvents,\n  selectEvents,\n  selectHasMoreEvents,\n  selectIsLoadingEvents,\n} from '../store/events-list-slice'\n\nexport interface UseEventsListResult {\n  events: ApiEventEntry[]\n  loading: boolean\n  hasMoreEvents: boolean\n  loadMoreEvents: () => void\n  reloadEvents: () => void\n}\nexport interface UseEventsListOptions {\n  skip?: boolean\n}\nexport function useEventsList({\n  skip,\n}: UseEventsListOptions = {}): UseEventsListResult {\n  const dispatch = useAppDispatch()\n  const events = useAppSelector(selectEvents)\n  const loading = useAppSelector(selectIsLoadingEvents)\n  const hasMoreEvents = useAppSelector(selectHasMoreEvents)\n\n  const loadMore = () => dispatch(loadMoreEvents())\n  const reload = () => dispatch(reloadEvents())\n\n  useEffect(() => {\n    if (skip !== true) {\n      dispatch(reloadEvents())\n    }\n  }, [dispatch, skip])\n\n  return {\n    events,\n    loading,\n    hasMoreEvents,\n    loadMoreEvents: loadMore,\n    reloadEvents: reload,\n  }\n}\n","export default __webpack_public_path__ + \"static/media/brave-logo.070fd9e9.svg\";","import logo from './brave-logo.svg'\n\nexport interface BraveLogoProps {\n  width?: string | number\n  height?: string | number\n}\nexport function BraveLogo({\n  width,\n  height,\n}: BraveLogoProps): JSX.Element {\n  return (\n    <img src={logo} alt=\"Logo\" className=\"img-fluid\" width={width} height={height} />\n  )\n}\n","import loginButton from './eve-sso-login-black-large.png'\n\nexport interface LoginButtonProps {\n  postLoginRedirect?: string | null\n}\nexport function LoginButton({\n  postLoginRedirect,\n}: LoginButtonProps): JSX.Element {\n  const loginUrl= '/auth/login' + (\n    postLoginRedirect ? `?${new URLSearchParams({ postLoginRedirect })}` : ''\n  )\n\n  return (\n    <a href={loginUrl}>\n      <img src={loginButton} alt=\"LOG IN with EVE Online\" />\n    </a>\n  )\n}\n","export default \"data:image/png;base64,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\"","import { Col, Container, Row } from 'react-bootstrap'\nimport { Navigate, useLocation } from 'react-router-dom'\nimport { BraveLogo } from '../components/brave-logo'\nimport { LoginButton } from '../components/login-button'\nimport { useGetUserQuery } from '../store'\nimport './login.scss'\n\nexport function LoginPage(): JSX.Element {\n  const me = useGetUserQuery()\n\n  const location = useLocation()\n\n  if (me.data?.isLoggedIn) {\n    return <Navigate to=\"/\" />\n  }\n\n  const urlParams = new URLSearchParams(location.search)\n  const postLoginRedirect = urlParams.get('postLoginRedirect')\n\n  return (\n    <Container className=\"login-container\">\n      <div style={{ flex: '33%' }} />\n      <Row className=\"jumbotron\" style={{ justifyContent: 'center' }}>\n        <Col sm={7}>\n          <h1>Brave Collective PingBoard</h1>\n          <hr />\n          <p>Log in with your EVE Online Account to gain access.</p>\n          <p>\n            <LoginButton postLoginRedirect={postLoginRedirect} />\n          </p>\n          <p>\n            You first need a{' '}\n            <a href=\"https://account.bravecollective.com/\" target=\"_blank\" rel=\"noreferrer\">\n              BRAVE Core Service Account\n            </a>{' '}\n            to log in here.\n          </p>\n        </Col>\n        <Col sm={5}>\n          <BraveLogo />\n        </Col>\n      </Row>\n      <div style={{ flex: '66%' }} />\n    </Container>\n  )\n}\n","import { Outlet } from 'react-router-dom'\n\nexport function PingsPage(): JSX.Element {\n  return <Outlet />\n}\n","import { Navigate } from 'react-router-dom'\n\nexport function PingsIndex(): JSX.Element {\n  return <Navigate to=\"send\" replace />\n}\n","import { Alert, Col, Container, Form, ListGroup, Row } from 'react-bootstrap'\nimport { Link, Outlet, useParams } from 'react-router-dom'\nimport { UserRoles } from '@ping-board/common'\nimport { useGetPingTemplatesQuery, useGetUserQuery } from '../../store'\nimport './send.scss'\n\nexport function SendPingLayout(): JSX.Element {\n  const me = useGetUserQuery()\n\n  const canEdit = me.data?.isLoggedIn &&\n    me.data.character.roles.includes(UserRoles.PING_TEMPLATES_WRITE)\n\n  const params = useParams()\n  const activeTemplateId = (\n    typeof params.templateId === 'string' && Number(params.templateId)\n  ) ?? null\n\n  const templates = useGetPingTemplatesQuery()\n\n  return (\n    <Container className=\"h-100 mh-100 d-flex flex-column send-pings\">\n      <div className=\"pings-header\">\n        <h3>Send Ping</h3>\n        <Link to=\"../sent\" className=\"btn btn-primary\" role=\"button\">\n          Show Sent Pings\n        </Link>\n        <div style={{ flex: 1 }} />\n        {canEdit &&\n          <Link to=\"../templates\" className=\"btn btn-primary\" role=\"button\">\n            <i className=\"bi-wrench\" /> Manage Ping Templates\n          </Link>\n        }\n      </div>\n      <Alert variant=\"warning\" className=\"py-2\">\n        <i className=\"bi-exclamation-triangle\" />{' '}\n        If you send <b>bad pings</b> you <b>will be banned from sending pings</b>. Use the\n        template, if possible. Also, <b>don&apos;t spam newlines and emoji in your pings or\n        you&apos;ll have your ping rights revoked</b>. Make sure you send your pings to the\n        correct group. Some groups are meant for emergencies, don&apos;t randomly ping them.\n        Just use it responsibly.\n      </Alert>\n      <Form as={Row} className=\"pings-container\">\n        <Form.Group as={Col} xs={12} md={4} className=\"mb-3 pb-3 template-column\">\n          <Form.Label>Send Ping to Group:</Form.Label>\n          <ListGroup className=\"templates\">\n            {templates.data?.templates.map(t => (\n              <ListGroup.Item key={t.id}\n                type=\"button\"\n                action\n                active={activeTemplateId === t.id}\n                as={Link}\n                to={t.id.toString()}\n              >\n                {t.name} (#{t.slackChannelName})\n              </ListGroup.Item>\n            ))}\n          </ListGroup>\n        </Form.Group>\n\n        <Col xs={12} md={8} className=\"pb-3 ping-column\">\n          <Outlet />\n        </Col>\n      </Form>\n    </Container>\n  )\n}\n","import { useCallback, useEffect, useState } from 'react'\n\nfunction localStorageHasKey(key: string): boolean {\n  if (typeof window === 'undefined') {\n    return false\n  }\n  const keyIndex = [...new Array<unknown>(window.localStorage.length)]\n    .findIndex((_, i) => window.localStorage.key(i) === key)\n\n  return keyIndex >= 0\n}\n\nfunction getLocalStorageValue<T>(\n  key: string,\n  defaultValue: T,\n  deserialize: (serialized: string) => T\n): T {\n  if (localStorageHasKey(key)) {\n    try {\n      return deserialize(window.localStorage.getItem(key) ?? 'null')\n    } catch (error) {\n      console.error(error)\n    }\n  }\n  return defaultValue\n}\n\nexport interface LocalStorageSerializationOptions<T> {\n  deserialize?: (serialized: string) => T\n  serialize?: (value: T) => string\n}\n\nexport function useLocalStorage<T>(\n  key: string,\n  defaultValue: T,\n  serializationOptions: LocalStorageSerializationOptions<T> = {}\n): [\n  value: T,\n  setValue: (value: T | ((oldValue: T) => T)) => void,\n  clearValue: () => void,\n] {\n  const {\n    deserialize = (JSON.parse as (v: string) => T),\n    serialize = JSON.stringify,\n  } = serializationOptions\n\n  const [storedValue, setStoredValue] = useState(() =>\n    getLocalStorageValue(key, defaultValue, deserialize)\n  )\n  useEffect(() => {\n    setStoredValue(getLocalStorageValue(key, defaultValue, deserialize))\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [key, deserialize])\n\n  const setValue = useCallback((value: T | ((oldValue: T) => T)) => {\n    const newValue = typeof value === 'function'\n      ? (value as (oldValue: T) => T)(getLocalStorageValue(key, defaultValue, deserialize))\n      : value\n\n    if (typeof window.localStorage !== 'undefined') {\n      window.localStorage.setItem(key, serialize(newValue))\n      setStoredValue(newValue)\n    }\n  }, [key, defaultValue, serialize, deserialize])\n\n  const clearValue = useCallback(() => {\n    if (typeof window.localStorage !== 'undefined') {\n      window.localStorage.removeItem(key)\n    }\n    setStoredValue(defaultValue)\n  }, [key, defaultValue])\n\n  return [storedValue, setValue, clearValue]\n}\n","import { MouseEvent, useRef } from 'react'\nimport { Alert, Form, OverlayTrigger, Tooltip } from 'react-bootstrap'\nimport { PingPlaceholder } from '../hooks/use-ping-placeholders'\n\nexport interface PingInputProps {\n  placeholders?: PingPlaceholder[]\n  value: string\n  onChange: (newValue: string) => void\n}\nexport function PingInput({\n  placeholders = [],\n  value,\n  onChange,\n}: PingInputProps): JSX.Element {\n  const inputRef = useRef<HTMLTextAreaElement>(null)\n  const insertPlaceholder = (placeholder: string) => (e: MouseEvent) => {\n    e.preventDefault()\n    if (!inputRef.current || !value) { return }\n    const { selectionStart, selectionEnd } = inputRef.current\n    const newText = [\n      value.substring(0, selectionStart),\n      `{{${placeholder}}}`,\n      value.substring(selectionEnd),\n    ].join('')\n    onChange(newText)\n    setTimeout(() => {\n      // + 4 because of the curly braces (`{{placeholder}}`)\n      const newSelection = selectionStart + placeholder.length + 4\n      inputRef.current?.setSelectionRange(newSelection, newSelection)\n    })\n  }\n\n  return (<>\n    <Form.Label>Ping Text:</Form.Label>\n\n    {placeholders.length > 0 && (\n      <Alert variant=\"info\" className=\"py-1\">\n        <i className=\"bi-info-circle\" />{' '}\n        There are a few placeholders available that will be replaced when sending the ping:\n        <ul className=\"mb-0\">\n          {placeholders.map(({ placeholder, description }) => (\n            <li key={placeholder}>\n              <OverlayTrigger\n                placement=\"bottom\"\n                delay={{ show: 250, hide: 0 }}\n                overlay={\n                  <Tooltip>\n                    Click to insert the placeholder at the cursor position\n                  </Tooltip>\n                }\n              >\n                <code onMouseDown={insertPlaceholder(placeholder)} role=\"button\">\n                  {`{{${placeholder}}}`}\n                </code>\n              </OverlayTrigger>  {description}\n            </li>\n          ))}\n        </ul>\n      </Alert>\n    )}\n\n    <Form.Control ref={inputRef}\n      as=\"textarea\"\n      className=\"ping-text flex-grow-1 overflow-auto\"\n      style={{ height: '300px' }}\n      value={value}\n      onChange={e => onChange(e.target.value)}\n    />\n  </>)\n}\n","import clsx from 'clsx'\nimport { Col, Form, Row } from 'react-bootstrap'\nimport { DateTimeInput } from './date-time-input'\nimport { RelativeTimeInput } from './relative-time-input'\nimport {\n  AbsoluteOrRelativeTime,\n  useAbsoluteRelativeTimeInput,\n} from '../hooks/use-absolute-relative-time-input'\n\nexport interface PingTimeInputProps {\n  allowPast?: boolean\n  time: AbsoluteOrRelativeTime\n  onChange: (newTime: AbsoluteOrRelativeTime) => void\n}\nexport function PingTimeInput({\n  allowPast: allowPast = false,\n  time,\n  onChange,\n}: PingTimeInputProps): JSX.Element {\n  const input = useAbsoluteRelativeTimeInput({ time, onChange, allowPast: allowPast })\n\n  return (\n    <Row className=\"me-0\">\n      <Form.Group as={Col} controlId=\"eveDateTime\" xs={12} lg={6} className=\"pe-0\">\n        <Form.Label>\n          <Form.Check\n            inline\n            label=\"Use EVE Time (UTC)\"\n            name=\"eveDateTimeMode\"\n            type=\"radio\"\n            onChange={() => input.handleChangeInputMode('absolute')}\n            id=\"absolute\"\n            checked={input.inputMode === 'absolute'}\n          />\n        </Form.Label>\n        <DateTimeInput\n          allowPast={allowPast}\n          value={input.absoluteTime}\n          onChange={input.handleAbsoluteDateChange}\n          className={clsx(\n            'time-mode-input',\n            input.inputMode !== 'absolute' && 'inactive-time-mode')}\n        />\n      </Form.Group>\n\n      <Form.Group as={Col} controlId=\"relativeTime\" xs={12} lg={6} className=\"mb-3 me-0\">\n        <Form.Label>\n          <Form.Check\n            inline\n            label=\"Use Relative Time\"\n            name=\"eveDateTimeMode\"\n            type=\"radio\"\n            onChange={() => input.handleChangeInputMode('relative')}\n            id=\"relative\"\n            checked={input.inputMode === 'relative'}\n          />\n        </Form.Label>\n        <RelativeTimeInput\n          value={input.relativeTime}\n          onChange={input.handleRelativeDateChange}\n          className={clsx(\n            'me-n4',\n            'time-mode-input',\n            input.inputMode !== 'relative' && 'inactive-time-mode'\n          )}\n        />\n      </Form.Group>\n    </Row>\n  )\n}\n","import { ApiPingInput } from '@ping-board/common'\nimport dayjs from 'dayjs'\nimport { ChangeEventHandler, useEffect, useMemo, useState } from 'react'\nimport { Button, Col, Form, Modal, Row, Spinner } from 'react-bootstrap'\nimport { Navigate, useParams } from 'react-router-dom'\nimport {\n  AbsoluteOrRelativeTime,\n  toAbsoluteTime,\n  useLocalStorage,\n  usePingPlaceholders,\n} from '../../../hooks'\nimport { useAddPingMutation, useGetPingTemplatesQuery, useGetUserQuery } from '../../../store'\nimport { PingInput } from '../../../components/ping-input'\nimport { PingTimeInput } from '../../../components/ping-time-input'\nimport './:templateId.scss'\n\nexport function SendPing(): JSX.Element {\n  const me = useGetUserQuery()\n  const templates = useGetPingTemplatesQuery()\n  const params = useParams()\n  const template = useMemo(\n    () => templates.data?.templates.find(t => t.id === Number(params.templateId)),\n    [params.templateId, templates.data?.templates]\n  )\n\n  const [editedPing, setEditedPing, clearEditedPing] = useLocalStorage('sendPing/editedPing', {\n    text: '',\n    addToCalendar: false,\n    calendarEntryTitle: '',\n    calendarTime: { relative: dayjs.duration(0).toISOString() } as\n      { relative: string } | { absolute: string },\n    template: null as null | string,\n  })\n  const handlePingTextChange = (text: string) => setEditedPing(p => ({\n    ...p,\n    text,\n    template: template?.template ?? null,\n  }))\n  useEffect(() => {\n    if (editedPing.text.trim() === (editedPing.template ?? '').trim()) {\n      setEditedPing(p => ({ ...p, text: '' }))\n    }\n  // We only want this to run when the selected template changes\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [template])\n\n  const pingTime = parsePingTime(editedPing.calendarTime)\n  const placeholders = usePingPlaceholders(template ?? null, {\n    ...me?.data?.isLoggedIn ? { userName: me.data.character.name } : null,\n    addToCalendar: editedPing.addToCalendar,\n    calendarEntryTitle: editedPing.calendarEntryTitle,\n    calendarTime: pingTime,\n  })\n\n  const toggleAddToCalendar = () => {\n    setEditedPing(p => ({ ...p, addToCalendar: !p.addToCalendar }))\n  }\n  const updateCalendarEntryTitle: ChangeEventHandler<HTMLInputElement> = e => {\n    setEditedPing(p => ({ ...p, calendarEntryTitle: e.target.value }))\n  }\n\n  const updateCalendarTime = (t: AbsoluteOrRelativeTime) => {\n    if ('absolute' in t) {\n      setEditedPing(p => ({ ...p, calendarTime: { absolute: t.absolute.toISOString() } }))\n    } else {\n      setEditedPing(p => ({ ...p, calendarTime: { relative: t.relative.toISOString() } }))\n    }\n  }\n\n  const oldTextSeparator = '\\n\\n--- old text ---\\n\\n'\n  const pingText = (!!editedPing.text && template && editedPing.template !== template.template)\n    ? template.template + oldTextSeparator + (editedPing.text ?? '')\n    : editedPing.text || template?.template || ''\n\n  const [\n    lastSentPing,\n    setLastSentPing,\n  ] = useState<{ text: string, templateId: number } | null>(null)\n\n  const canSend = (\n    template &&\n    (pingText !== lastSentPing?.text || template.id !== lastSentPing.templateId) &&\n    pingText.trim() !== template.template.trim() &&\n    pingText.trim() !== '' &&\n    pingText.indexOf(oldTextSeparator) === -1 &&\n    (!template.allowScheduling || !editedPing.addToCalendar || (\n      (editedPing.calendarEntryTitle.trim() ?? '') !== '' &&\n      (toAbsoluteTime(pingTime).isAfter(dayjs()))\n    ))\n  )\n\n  const [postPing, postPingState] = useAddPingMutation()\n  const handleSendPing = () => {\n    if (template && canSend) {\n      const input: ApiPingInput = {\n        text: pingText,\n        templateId: template.id,\n      }\n      if (template.allowScheduling && editedPing.addToCalendar) {\n        input.scheduledFor = toAbsoluteTime(pingTime).toISOString()\n        input.scheduledTitle = editedPing.calendarEntryTitle\n      }\n      setShowSendingDialog(true)\n      postPing(input).then(result => {\n        if (!('error' in result)) {\n          setLastSentPing({ text: input.text, templateId: template.id })\n          setEditedPing(p => ({ ...p, text: '' }))\n        }\n      })\n    }\n  }\n\n  const [showSendingDialog, setShowSendingDialog] = useState(false)\n  const [sendDialogClosing, setSendDialogClosing] = useState(false)\n  useEffect(() => {\n    if (showSendingDialog && !sendDialogClosing && !postPingState.isLoading) {\n      setSendDialogClosing(true)\n      setTimeout(() => {\n        setShowSendingDialog(false)\n        setSendDialogClosing(false)\n      }, 2000)\n    }\n  }, [postPingState.isLoading, postPingState.isSuccess, sendDialogClosing, showSendingDialog])\n\n  if (!template) {\n    if (templates.isFetching) {\n      return <div>Loading&ellip;</div>\n    } else {\n      return <Navigate to=\"../\" replace />\n    }\n  }\n\n  return (<>\n    <Form.Group className=\"mb-3 pe-0 ping\">\n      {!!template.allowScheduling && (<>\n        <Form.Group as={Col} controlId=\"schedule\" xs={12} className=\"mb-3 pe-0\">\n          <Form.Label>Ping Options</Form.Label>\n          <Form.Check\n            checked={editedPing.addToCalendar}\n            label=\"This is a pre-ping (select for more options)\"\n            onChange={toggleAddToCalendar}\n          />\n        </Form.Group>\n        {editedPing.addToCalendar && (<>\n          <Form.Group as={Col} controlid=\"calendarTitle\" xs={12} className=\"mb-3 pe-0\">\n            <Form.Label>Calendar Entry Title</Form.Label>\n            <Form.Control\n              value={editedPing.calendarEntryTitle}\n              onChange={updateCalendarEntryTitle}\n            />\n          </Form.Group>\n\n          <Row className=\"me-0\">\n            <Col xs={12} className=\"pe-0\">\n              <Form.Label>Calendar Time</Form.Label>\n            </Col>\n            <PingTimeInput time={pingTime} onChange={updateCalendarTime} />\n          </Row>\n        </>)}\n      </>)}\n\n      <PingInput\n        value={pingText}\n        onChange={handlePingTextChange}\n        placeholders={placeholders}\n      />\n    </Form.Group>\n    <Col xs={12} className=\"d-flex pe-0\">\n      <Button variant=\"warning\" onClick={() => clearEditedPing()}>\n        Reset Ping\n      </Button>\n      <div style={{ flexGrow: 1 }} />\n      <Button variant=\"primary\" disabled={!canSend} onClick={handleSendPing}>\n        Send Ping\n      </Button>\n    </Col>\n    <Modal show={showSendingDialog} size=\"sm\" backdrop=\"static\">\n      <Modal.Body className=\"fs-5\">\n        {postPingState.isLoading && <>\n          <Spinner animation=\"border\" role=\"status\" size=\"sm\">\n            <span className=\"visually-hidden\">Sending&hellip;</span>\n          </Spinner>{' '}\n          Sending&hellip;\n        </>}\n        {!postPingState.isLoading && postPingState.isError &&\n          <span className=\"text-danger\">\n            <i className=\"bi-exclamation-circle\" /> Failed to send ping\n          </span>\n        }\n        {!postPingState.isLoading && postPingState.isSuccess &&\n          <span className=\"text-success\">\n            <i className=\"bi-check-circle\" /> Ping sent\n          </span>\n        }\n      </Modal.Body>\n    </Modal>\n  </>)\n}\n\nfunction parsePingTime(time: { absolute: string } | { relative: string }): AbsoluteOrRelativeTime {\n  if ('absolute' in time) {\n    return { absolute: dayjs(time.absolute) }\n  }\n\n  // Dayjs is unable to correctly parse negative durations, so we invert them ourselves if needed\n  const isNegative = time.relative.startsWith('-')\n  const timeMs = dayjs.duration(time.relative).asMilliseconds()\n  const sign = (isNegative === timeMs < 0) ? 1 : -1\n\n  return { relative: dayjs.duration(sign * timeMs) }\n}\n","import { useMemo } from 'react'\nimport { ApiPingTemplate } from '@ping-board/common'\nimport { Time } from '../components/time'\nimport { AbsoluteOrRelativeTime, toAbsoluteTime } from './use-absolute-relative-time-input'\n\nexport interface PingPlaceholder {\n  placeholder: string\n  description: React.ReactNode\n}\nexport function usePingPlaceholders(template: ApiPingTemplate | null, options: {\n  userName?: string,\n  addToCalendar?: boolean,\n  calendarEntryTitle?: string,\n  calendarTime?: AbsoluteOrRelativeTime,\n}): PingPlaceholder[] {\n  return useMemo(() => {\n    if (!template) {\n      return [] as PingPlaceholder[]\n    }\n    const placeholders: PingPlaceholder[] = []\n    if (options.userName) {\n      placeholders.push({\n        placeholder: 'me',\n        description: `the name of the character you are logged in with (${options.userName})`,\n      })\n    }\n    if (template.allowScheduling && options.addToCalendar) {\n      if (typeof options.calendarEntryTitle === 'string') {\n        placeholders.push({\n          placeholder: 'title',\n          description: `the title of the calendar entry${\n            options.calendarEntryTitle && ` (${options.calendarEntryTitle})`\n          }`,\n        })\n      }\n      if (options.calendarTime) {\n        placeholders.push({\n          placeholder: 'time',\n          description: (<>\n            a <a href=\"https://time.nakamura-labs.com/\" target=\"_blank\" rel=\"noreferrer\">\n              Nakamura time link\n            </a> for the scheduled time and date\n            (<Time\n              time={toAbsoluteTime(options.calendarTime)}\n              asLink\n              format={'YYYY-MM-DD HH:mm'}\n            />)\n          </>),\n        })\n      }\n    }\n    return placeholders\n  }, [\n    options.addToCalendar,\n    options.calendarEntryTitle,\n    options.calendarTime,\n    options.userName,\n    template,\n  ])\n}\n","export function NoPingTemplateSelected(): JSX.Element {\n  return (\n    <div>Please select a group to ping!</div>\n  )\n}\n","import { Modal, ModalProps } from 'react-bootstrap'\nimport { ApiPing } from '@ping-board/common'\nimport { PingDetails } from './ping-details'\n\nexport interface PingDetailDialogProps {\n  ping: ApiPing | null\n}\nexport function PingDetailDialog({\n  ping,\n  ...modalProps\n}: PingDetailDialogProps & ModalProps): JSX.Element {\n  return (\n    <Modal {...modalProps}>\n      <Modal.Header closeButton>\n        <Modal.Title>\n          <i className=\"bi-broadcast-pin\" />{' '}\n          {ping?.scheduledTitle || `${ping?.author} to ${ping?.slackChannelName}`}\n          <h6 className=\"m-0\">\n            {ping?.scheduledFor && 'Scheduled/Pre-'}Ping\n          </h6>\n        </Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        {ping && (\n          <PingDetails ping={ping} />\n        )}\n      </Modal.Body>\n    </Modal>\n  )\n}\n","import { useState } from 'react'\nimport { Alert, Button, Col, Container, Row, Table } from 'react-bootstrap'\nimport { Link } from 'react-router-dom'\nimport { ApiPing, UserRoles } from '@ping-board/common'\nimport { Time } from '../../components/time'\nimport { PingDetailDialog } from '../../components/ping-detail-dialog'\nimport { useGetUserQuery } from '../../store'\nimport { usePingsList } from '../../hooks'\nimport './sent.scss'\n\nexport function SentPings(): JSX.Element {\n  const me = useGetUserQuery()\n\n  const canRead = me.data?.isLoggedIn && me.data?.character.roles.includes(UserRoles.PING)\n  const canEdit = me.data?.isLoggedIn &&\n    me.data.character.roles.includes(UserRoles.PING_TEMPLATES_WRITE)\n\n  const pings = usePingsList({ skip: me.isLoading || !canRead })\n\n  const [showPingDialog, setShowPingDialog] = useState(false)\n  const [displayedPing, setDisplayedPing] = useState<ApiPing | null>(null)\n\n  const handlePingClicked = (ping: ApiPing) => {\n    setDisplayedPing(ping)\n    setShowPingDialog(true)\n  }\n  const handleClosePingDialog = () => {\n    setShowPingDialog(false)\n  }\n\n  return (\n    <Container>\n      <div className=\"sent-pings-header\">\n        <h3>Sent Pings</h3>\n        <Button onClick={pings.reload} disabled={pings.loading}>\n          <i className=\"bi-arrow-clockwise\" /> Reload\n        </Button>\n        <div style={{ flex: 1 }} />\n        <Link to=\"..\" className=\"btn btn-primary\" role=\"button\">\n          <i className=\"bi-arrow-left\" /> Back to Pings\n        </Link>\n        {canEdit &&\n          <Link to=\"../view-access\" className=\"btn btn-primary\" role=\"button\">\n            <i className=\"bi-wrench\" /> Manage View Access\n          </Link>\n        }\n      </div>\n      <Row>\n        <Col xs={12}>\n          <Alert variant=\"info\" className=\"py-2\">\n            These Pings were either sent by you, or were sent to channels you have view access to.\n            View access is determined by your Neucore groups, not which Slack channels you are in.\n          </Alert>\n        </Col>\n        <Col xs={12}>\n          <Table hover size=\"sm\" variant=\"dark\" responsive className=\"sent-pings-table\">\n            <thead>\n              <tr>\n                <th>Author</th>\n                <th>Sent at</th>\n                <th>Sent to</th>\n                <th>Text</th>\n              </tr>\n            </thead>\n            <tbody>\n              {pings.pings.length < 1 &&\n                <tr>\n                  <td colSpan={4}>No Pings to show</td>\n                </tr>\n              }\n              {pings.pings.map(p => (\n                <tr key={p.id} onClick={() => handlePingClicked(p)}>\n                  <td>{p.author}</td>\n                  <td><Time time={p.sentAt} format=\"YYYY-MM-DD HH:mm\" /></td>\n                  <td>{p.slackChannelName}</td>\n                  <td className=\"text-cell\">\n                    <div title={p.text}>\n                      {p.text}\n                    </div>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </Table>\n\n          <Button\n            className=\"w-100 mb-3\"\n            disabled={!pings.hasMore || pings.loading}\n            onClick={pings.loadMore}\n          >\n            {pings.loading\n              ? 'Loading'\n              : pings.hasMore\n                ? 'Load more'\n                : '(No more pings)'\n            }\n          </Button>\n        </Col>\n      </Row>\n\n      <PingDetailDialog\n        show={showPingDialog}\n        ping={displayedPing}\n        onHide={handleClosePingDialog}\n        fullscreen=\"sm-down\"\n      />\n    </Container>\n  )\n}\n","import { useEffect } from 'react'\nimport { ApiPing } from '@ping-board/common'\nimport { useAppDispatch, useAppSelector } from './redux'\nimport {\n  loadMorePings,\n  reloadPings,\n  selectHasMorePings,\n  selectIsLoadingPings,\n  selectPings,\n} from '../store/pings-list-slice'\n\nexport interface UsePingsListResult {\n  pings: ApiPing[]\n  loading: boolean\n  hasMore: boolean\n  loadMore: () => void\n  reload: () => void\n}\nexport interface UsePingsListOptions {\n  skip?: boolean\n}\nexport function usePingsList({\n  skip,\n}: UsePingsListOptions = {}): UsePingsListResult {\n  const dispatch = useAppDispatch()\n  const pings = useAppSelector(selectPings)\n  const loading = useAppSelector(selectIsLoadingPings)\n  const hasMore = useAppSelector(selectHasMorePings)\n\n  const loadMore = () => dispatch(loadMorePings())\n  const reload = () => dispatch(reloadPings())\n\n  useEffect(() => {\n    if (skip !== true) {\n      dispatch(reloadPings())\n    }\n  }, [dispatch, skip])\n\n  return {\n    pings,\n    loading,\n    hasMore,\n    loadMore,\n    reload,\n  }\n}\n","import clsx from 'clsx'\nimport { ChangeEvent, useEffect, useState } from 'react'\nimport {\n  Alert,\n  Button,\n  Col,\n  Form,\n  Modal,\n  Row,\n  Table,\n} from 'react-bootstrap'\nimport { ApiPingTemplate, ApiPingTemplateInput } from '@ping-board/common'\nimport {\n  useGetAvailableNeucoreGroupsQuery,\n  useGetPingChannelsQuery,\n} from '../store'\nimport { dayjs } from '../utils/dayjs'\nimport './edit-ping-template-dialog.scss'\n\nexport interface EditPingTemplateDialogProps {\n  show: boolean\n  template?: ApiPingTemplate | null\n  onSave?: (template: ApiPingTemplateInput) => void\n  onCancel?: () => void\n  onDelete?: () => void\n}\nexport function EditPingTemplateDialog({\n  show,\n  template,\n  onSave,\n  onCancel,\n  onDelete,\n}: EditPingTemplateDialogProps): JSX.Element {\n  const [editedTemplate, setEditedTemplate] = useState<ApiPingTemplateInput>(\n    getDefaultEditedTemplate()\n  )\n  useEffect(() => setEditedTemplate(\n    template ? { ...template } : getDefaultEditedTemplate()\n  ), [template])\n  const canSave = (\n    editedTemplate.name.length > 0 &&\n    editedTemplate.slackChannelId.length > 0\n  )\n  const save = () => {\n    if (canSave && onSave) {\n      const template = editedTemplate\n      onSave(template)\n      setEditedTemplate(getDefaultEditedTemplate())\n    }\n  }\n\n  const channels = useGetPingChannelsQuery()\n  const neucoreGroups = useGetAvailableNeucoreGroupsQuery()\n  const remainingNeucoreGroups = (neucoreGroups.data?.neucoreGroups ?? [])\n    .filter(g => !editedTemplate.allowedNeucoreGroups.includes(g.name))\n\n  const isNewTemplate = typeof template?.id !== 'number'\n  const lastEdited = !isNewTemplate && [\n    `Last edited by ${template?.updatedBy ?? 'unknown'}`,\n    template?.updatedAt\n      ? `at ${dayjs(template.updatedAt).format('llll')} (${dayjs(template.updatedAt).fromNow()})`\n      : 'unknown',\n  ].join(' ')\n\n  const setTemplateField = <T extends keyof ApiPingTemplateInput>(\n    field: T, value: ApiPingTemplateInput[T]\n  ) => {\n    setEditedTemplate(t => ({ ...t, [field]: value }))\n  }\n\n  const handleSlackChannelChange = (e: ChangeEvent<HTMLSelectElement>) =>\n    setEditedTemplate(t => ({ ...t, slackChannelId: e.target.value }))\n\n  const handleAllowSchedulingChange = () =>\n    setTemplateField('allowScheduling', !editedTemplate.allowScheduling)\n\n  const handleNeucoreGroupSelected = (e: ChangeEvent<HTMLSelectElement>) =>\n    setEditedTemplate(t => ({\n      ...t,\n      allowedNeucoreGroups: [...t.allowedNeucoreGroups, e.target.value ],\n    }))\n  const handleRemoveNeucoreGroup = (groupName: string) =>\n    setEditedTemplate(t => ({\n      ...t,\n      allowedNeucoreGroups: t.allowedNeucoreGroups.filter(g => g !== groupName),\n    }))\n\n  const [isDeletePending, setIsDeletePending] = useState(false)\n  const handleStartDelete = () => setIsDeletePending(true)\n  const handleCancelDelete = () => setIsDeletePending(false)\n  const handleConfirmDelete = () => {\n    setIsDeletePending(false)\n    onDelete?.()\n    setEditedTemplate(getDefaultEditedTemplate())\n  }\n\n  return (\n    <Modal show={show} size=\"lg\" backdrop=\"static\">\n      <Modal.Header>\n        <Modal.Title>{isNewTemplate ? 'Add' : 'Edit'} Ping Template</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <Form>\n          <Row>\n            {lastEdited && <Col xs={12} className=\"mb-3\">{lastEdited}</Col>}\n\n            <Form.Group as={Col} controlId=\"name\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Template Name</Form.Label>\n              <Form.Control\n                type=\"text\"\n                value={editedTemplate.name}\n                onChange={e => setTemplateField('name', e.target.value)}\n              />\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"slackChannel\" xs={12} sm={6} className=\"mb-3\">\n              <Form.Label>Targeted Slack Channel</Form.Label>\n              <Form.Select\n                value={editedTemplate.slackChannelId}\n                onChange={handleSlackChannelChange}\n              >\n                {channels.isLoading &&\n                  <option value=\"\">Loading&hellip;</option>\n                }\n                {!channels.isLoading && ((channels.data?.channels.length ?? 0) < 1\n                  ? <option value=\"\">No valid target channels!</option>\n                  : <option value=\"\">(Please Select)</option>\n                )}\n                {!channels.isLoading && channels.data?.channels.map(c => (\n                  <option key={c.id} value={c.id}>{c.name}</option>\n                ))}\n              </Form.Select>\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"allowScheduling\" xs={12} className=\"mb-3\">\n              <Form.Check\n                checked={!!editedTemplate.allowScheduling}\n                onChange={handleAllowSchedulingChange}\n                label={<>\n                  Allow Showing the Ping in the Calendar\n                  <span className=\"d-block\" style={{fontSize: '0.9rem' }}>\n                    Only users with permissions to view pings sent to the target channel will be\n                    able to see them in the calendar.\n                  </span>\n                </>}\n              />\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"addNeucoreGroup\" xs={12} className=\"mb-3\">\n              <Form.Label>Neucore Groups Allowed to Ping</Form.Label>\n              <Table variant=\"dark\">\n                <thead>\n                  <tr>\n                    <th style={{ width: '100%' }}>Group</th>\n                    <th>Action</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {editedTemplate.allowedNeucoreGroups.length === 0 &&\n                    <tr>\n                      <td colSpan={2}>\n                        <Alert variant=\"warning\" className=\"mb-0 p-1\">\n                          <i className=\"bi-exclamation-triangle\" />{' '}\n                          All users allowed to ping can use this template\n                        </Alert>\n                      </td>\n                    </tr>\n                  }\n                  {editedTemplate.allowedNeucoreGroups.map(g => (\n                    <tr key={g}>\n                      <td className=\"align-middle\">{g}</td>\n                      <td>\n                        <Button\n                          size=\"sm\"\n                          onClick={() => handleRemoveNeucoreGroup(g)}\n                          className=\"text-nowrap\"\n                        >\n                          <i className=\"bi-trash-fill\" /> Remove\n                        </Button>\n                      </td>\n                    </tr>\n                  ))}\n                  {neucoreGroups.isLoading &&\n                    <tr><td colSpan={2}>Loading&hellip;</td></tr>\n                  }\n                  {!neucoreGroups.isLoading &&\n                    remainingNeucoreGroups.length < 1 &&\n                    editedTemplate.allowedNeucoreGroups.length < 1 &&\n                    <tr>\n                      <td colSpan={2}>\n                        <Alert variant=\"Error\">\n                          No Neucore groups configured!\n                        </Alert>\n                      </td>\n                    </tr>\n                  }\n                  {remainingNeucoreGroups.length > 0 && (\n                    <tr>\n                      <td colSpan={2}>\n                        <Form.Select value=\"\" onChange={handleNeucoreGroupSelected}>\n                          <option value=\"\">(Select a group to add)</option>\n                          {!neucoreGroups.isLoading && remainingNeucoreGroups.map(g => (\n                            <option key={g.id} value={g.name}>{g.name}</option>\n                          ))}\n                        </Form.Select>\n                      </td>\n                    </tr>\n                  )}\n                </tbody>\n              </Table>\n            </Form.Group>\n\n            <Form.Group as={Col} controlId=\"template\" xs={12} className=\"mb-3\">\n              <Form.Label>Template Text</Form.Label>\n              <Form.Control\n                as=\"textarea\"\n                rows={10}\n                value={editedTemplate.template}\n                onChange={e => setTemplateField('template', e.target.value)}\n              />\n            </Form.Group>\n          </Row>\n        </Form>\n      </Modal.Body>\n      <Modal.Footer className=\"edit-ping-template-dialog-footer\">\n        <div className={clsx(\n          'edit-ping-template-dialog-buttons-wrapper',\n          isDeletePending && 'hidden',\n        )}>\n          {!isNewTemplate && (\n            <>\n              <Button\n                variant=\"danger\"\n                disabled={isDeletePending}\n                onClick={handleStartDelete}\n              >\n                Delete\n              </Button>\n              <div className=\"edit-ping-template-dialog-buttons-spacer\" />\n            </>\n          )}\n          <Button variant=\"secondary\" onClick={onCancel} disabled={isDeletePending}>\n            Cancel\n          </Button>\n          <Button variant=\"primary\" disabled={!canSave || isDeletePending} onClick={save}>\n            Save\n          </Button>\n        </div>\n        {!isNewTemplate && (\n          <div className={clsx(\n            'edit-ping-template-confirm-delete-buttons-wrapper',\n            !isDeletePending && 'hidden'\n          )}>\n            <Button disabled={!isDeletePending} onClick={handleCancelDelete}>\n              No\n            </Button>\n            <div className=\"edit-ping-template-dialog-buttons-spacer\">\n              Are you sure you want to delete this ping template?\n            </div>\n            <Button variant=\"danger\" disabled={!isDeletePending} onClick={handleConfirmDelete}>\n              Yes\n            </Button>\n          </div>\n        )}\n      </Modal.Footer>\n    </Modal>\n  )\n}\n\nfunction getDefaultEditedTemplate(): ApiPingTemplateInput {\n  return {\n    name: '',\n    slackChannelId: '',\n    template: '',\n    allowedNeucoreGroups: [],\n    allowScheduling: false,\n  }\n}\n","import React, { useState } from 'react'\nimport { Button, Container, Table } from 'react-bootstrap'\nimport { Link } from 'react-router-dom'\nimport { ApiPingTemplate, ApiPingTemplateInput } from '@ping-board/common'\nimport {\n  useAddPingTemplateMutation,\n  useDeletePingTemplateMutation,\n  useGetPingTemplatesQuery,\n  useUpdatePingTemplateMutation,\n} from '../../store'\nimport { EditPingTemplateDialog } from '../../components/edit-ping-template-dialog'\nimport './templates.scss'\n\nexport function ManagePingTemplates(): JSX.Element {\n  const pingTemplates = useGetPingTemplatesQuery()\n  const [addTemplate] = useAddPingTemplateMutation()\n  const [updateTemplate] = useUpdatePingTemplateMutation()\n  const [deleteTemplate] = useDeletePingTemplateMutation()\n\n  const [templateDialogState, setTemplateDialogState] = useState({\n    template: null as ApiPingTemplate | null,\n    show: false,\n  })\n  const editTemplate = (template: ApiPingTemplate) =>\n    setTemplateDialogState({ template, show: true })\n  const addNewTemplate = () => setTemplateDialogState({ template: null, show: true })\n  const cancelEdit = () => setTemplateDialogState({ template: null, show: false })\n\n  const confirmEditTemplate = (template: ApiPingTemplateInput) => {\n    if (!templateDialogState.template) {\n      addTemplate(template)\n    } else {\n      updateTemplate({ id: templateDialogState.template.id, template })\n    }\n    cancelEdit()\n  }\n  const deleteEditedTemplate = () => {\n    const { template } = templateDialogState\n    if (!template) {\n      return\n    }\n    deleteTemplate(template.id)\n    cancelEdit()\n  }\n\n  return (\n    <Container>\n      <div className=\"templates-header\">\n        <h3>Manage Ping Templates</h3>\n        <div style={{ flex: 1 }} />\n        <Link to=\"..\" className=\"btn btn-primary\" role=\"button\">\n          <i className=\"bi-arrow-left\" /> Back to Pings\n        </Link>\n        <Button onClick={addNewTemplate}>\n          <i className=\"bi-plus-lg\" /> Add Ping Template\n        </Button>\n      </div>\n      <Table hover size=\"sm\" variant=\"dark\" responsive>\n        <thead>\n          <tr>\n            <th>Name</th>\n            <th>Targeted Channel</th>\n            <th>Groups Allowed to Ping</th>\n            <th>Calendar Support</th>\n            <th>Template</th>\n            <th>Action</th>\n          </tr>\n        </thead>\n        <tbody>\n          {pingTemplates.isFetching &&\n            <tr>\n              <td colSpan={5}>Loading&elipsis;</td>\n            </tr>\n          }\n          {!pingTemplates.isFetching && (pingTemplates.data?.templates.length ?? 0) < 1 &&\n            <tr>\n              <td colSpan={5}>No ping templates defined</td>\n            </tr>\n          }\n          {pingTemplates.data?.templates.map(t => (\n            <tr key={t.id}>\n              <th scope=\"row\">{t.name}</th>\n              <td>{t.slackChannelName}</td>\n              <td>\n                {t.allowedNeucoreGroups.length < 1\n                  ? <i>(Everyone)</i>\n                  : t.allowedNeucoreGroups.join(', ')\n                }\n              </td>\n              <td>{t.allowScheduling ? 'Yes' : 'No'}</td>\n              <td>\n                {t.template.split('\\n').map((line, i) => (\n                  <React.Fragment key={i}>{line}<br /></React.Fragment>\n                ))}\n              </td>\n              <td>\n                <Button size=\"sm\" onClick={() => editTemplate(t)}>\n                  <i className=\"bi-pencil\" /> Edit\n                </Button>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </Table>\n\n      <EditPingTemplateDialog\n        show={templateDialogState.show}\n        template={templateDialogState.template}\n        onCancel={cancelEdit}\n        onSave={confirmEditTemplate}\n        onDelete={deleteEditedTemplate}\n      />\n    </Container>\n  )\n}\n","import { ChangeEvent, useMemo, useState } from 'react'\nimport { Alert, Button, Col, Container, Form, ListGroup, Row, Table } from 'react-bootstrap'\nimport { Link } from 'react-router-dom'\nimport {\n  useGetAvailableNeucoreGroupsQuery,\n  useGetPingChannelsQuery,\n  useGetPingViewPermissionsQuery,\n  useUpdatePingViewPermissionsByNeucoreGroupMutation,\n} from '../../store'\nimport './view-access.scss'\n\nexport function ManagePingViewAccess(): JSX.Element {\n  const viewPermissionsQuery = useGetPingViewPermissionsQuery()\n  const viewPermissions = useMemo(() => (viewPermissionsQuery.data?.viewPermissions ?? []).reduce(\n    (byGroup, { neucoreGroup, ...rest }) => byGroup.set(\n      neucoreGroup,\n      [...byGroup.get(neucoreGroup) ?? [], rest].sort(\n        (a, b) => a.slackChannelName.localeCompare(b.slackChannelName)\n      )\n    ),\n    new Map<string, { slackChannelId: string, slackChannelName: string }[]>()\n  ), [viewPermissionsQuery.data?.viewPermissions])\n\n  const [selectedGroup, setSelectedGroup] = useState<string | null>(null)\n  const selectableGroups = [\n    ...viewPermissions.keys(),\n    ...selectedGroup && !viewPermissions.has(selectedGroup) ? [selectedGroup] : [],\n  ].sort()\n  const handleGroupChange = (e: ChangeEvent<HTMLSelectElement>) => {\n    setSelectedGroup(e.target.value || null)\n  }\n\n  const allGroups = useGetAvailableNeucoreGroupsQuery()\n  const remainingGroups = (allGroups.data?.neucoreGroups ?? [])\n    .filter(g => !viewPermissions.has(g.name) && g.name !== selectedGroup)\n    .map(g => g.name)\n\n  const channels = useGetPingChannelsQuery()\n  const remainingChannels = (channels.data?.channels ?? [])\n    .filter(c => (selectedGroup && viewPermissions.get(selectedGroup) || [])\n      .every(cc => cc.slackChannelName !== c.name)\n    )\n\n  const [\n    setGroupChannels,\n    setGroupChannelsState,\n  ] = useUpdatePingViewPermissionsByNeucoreGroupMutation()\n  const handleChannelSelected = (e: ChangeEvent<HTMLSelectElement>) => {\n    if (!selectedGroup) {\n      return\n    }\n    setGroupChannels({\n      neucoreGroup: selectedGroup,\n      allowedSlackChannelIds: [\n        ...(viewPermissions.get(selectedGroup) ?? []).map(g => g.slackChannelId),\n        e.target.value,\n      ],\n    })\n  }\n  const handleRemoveChannel = (channelId: string) => {\n    if (!selectedGroup) {\n      return\n    }\n    setGroupChannels({\n      neucoreGroup: selectedGroup,\n      allowedSlackChannelIds: (viewPermissions.get(selectedGroup) ?? [])\n        .map(g => g.slackChannelId)\n        .filter(g => g !== channelId),\n    })\n  }\n\n  const isLoading =\n    viewPermissionsQuery.isFetching ||\n    allGroups.isFetching ||\n    channels.isFetching ||\n    setGroupChannelsState.isLoading\n\n  return (\n    <Container>\n      <div className=\"view-access-header\">\n        <h3>Manage Ping View Access</h3>\n        <div style={{ flex: 1 }} />\n        <Link to=\"../sent\" className=\"btn btn-primary\" role=\"button\">\n          <i className=\"bi-arrow-left\" /> Back to Sent Pings\n        </Link>\n      </div>\n      <Row>\n        <Form.Group as={Col} controlId=\"neucoreGroup\" xs={12} md={4} className=\"mb-3\">\n          <Form.Label>Neucore Group</Form.Label>\n          {selectableGroups.length < 1 && (isLoading\n            ? <Alert variant=\"info\" className=\"mb-2 py-2\">\n                Loading&hellip;\n              </Alert>\n            : <Alert variant=\"warning\" className=\"mb-2 py-2\">\n                No view permissions defined.\n              </Alert>\n          )}\n          {selectableGroups.length > 0 &&\n            <ListGroup className=\"mb-2\">\n              {selectableGroups.map(g => (\n                <ListGroup.Item key={g}\n                  type=\"button\"\n                  action\n                  active={g === selectedGroup}\n                  onClick={() => setSelectedGroup(g)}\n                  disabled={isLoading}\n                >\n                  {g}\n                </ListGroup.Item>\n              ))}\n            </ListGroup>\n          }\n          <Form.Select\n            value={selectedGroup ?? ''}\n            onChange={handleGroupChange}\n            disabled={isLoading || remainingGroups.length < 1}\n          >\n            {isLoading &&\n              <option value=\"\">Loading&hellip;</option>\n            }\n            {!isLoading && (remainingGroups.length > 0\n              ? <option value=\"\">(Select a group to add)</option>\n              : <option value=\"\">No more groups to add</option>\n            )}\n            {!isLoading && remainingGroups.map(g => (\n              <option key={g} value={g}>{g}</option>\n            ))}\n          </Form.Select>\n        </Form.Group>\n\n        <Form.Group as={Col} controlId=\"slackGroups\" xs={12} md={8}>\n          <Form.Label>Can see pings sent to</Form.Label>\n          <Table variant=\"dark\">\n            <thead>\n              <tr>\n                <th className=\"w-100\">Slack Channel</th>\n                <th>Action</th>\n              </tr>\n            </thead>\n            <tbody>\n              {!selectedGroup && (\n                <tr>\n                  <td colSpan={2}>(Please select a group to manage first)</td>\n                </tr>\n              )}\n              {selectedGroup && <>\n                {!viewPermissions.get(selectedGroup)?.length && (\n                  <tr>\n                    <td colSpan={2}>\n                      <Alert variant=\"info\" className=\"mb-0 py-2\">\n                        Members of this group cannot view any{' '}\n                        pings other than those they sent themselves.\n                      </Alert>\n                    </td>\n                  </tr>\n                )}\n                {viewPermissions.get(selectedGroup)?.map(p => (\n                  <tr key={p.slackChannelId}>\n                    <td className=\"align-middle\">{p.slackChannelName}</td>\n                    <td>\n                      <Button\n                        size=\"sm\"\n                        className=\"text-nowrap\"\n                        onClick={() => handleRemoveChannel(p.slackChannelId)}\n                        disabled={isLoading}\n                      >\n                        <i className=\"bi-trash-fill\" /> Remove\n                      </Button>\n                    </td>\n                  </tr>\n                ))}\n                {remainingChannels.length > 0 && (\n                  <tr>\n                    <td colSpan={2}>\n                      <Form.Select\n                        value=\"\"\n                        onChange={handleChannelSelected}\n                        disabled={isLoading}\n                      >\n                        <option value=\"\">(Select a channel to add)</option>\n                        {!isLoading && remainingChannels.map(c => (\n                          <option key={c.id} value={c.id}>{c.name}</option>\n                        ))}\n                      </Form.Select>\n                    </td>\n                  </tr>\n                )}\n              </>}\n            </tbody>\n          </Table>\n        </Form.Group>\n      </Row>\n    </Container>\n  )\n}\n","import React from 'react'\nimport { BrowserRouter, Navigate, Outlet, Route, Routes, useLocation } from 'react-router-dom'\nimport { UserRoles } from '@ping-board/common'\nimport { useGetUserQuery } from './store'\nimport { AppNav } from './components/app-nav'\nimport { AppFooter } from './components/app-footer'\n\nimport { CalendarPage } from './pages/calendar'\nimport { TimersPage } from './pages/timers'\nimport { LoginPage } from './pages/login'\nimport { PingsPage } from './pages/pings'\nimport { PingsIndex } from './pages/_pings/index'\nimport { SendPingLayout } from './pages/_pings/send'\nimport { SendPing } from './pages/_pings/_send/:templateId'\nimport { NoPingTemplateSelected } from './pages/_pings/_send/index'\nimport { SentPings } from './pages/_pings/sent'\nimport { ManagePingTemplates } from './pages/_pings/templates'\nimport { ManagePingViewAccess } from './pages/_pings/view-access'\n\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport './app.css'\nimport './custom.scss'\n\nfunction LoginAndReturn(): JSX.Element {\n  const currentPath = useLocation().pathname\n  return <Navigate to={`/login?postLoginRedirect=${currentPath}`} />\n}\n\nexport default function App(): JSX.Element {\n  const user = useGetUserQuery()\n  const roles = user.data?.isLoggedIn && user.data.character.roles || []\n\n  function ifHasRoles(\n    requiredRoles: UserRoles[],\n    element: JSX.Element,\n    fallback: JSX.Element | string = <React.Fragment />\n  ): JSX.Element {\n    if (user.isLoading) { return <React.Fragment /> }\n    const hasRoles = requiredRoles.every(r => roles.includes(r))\n    if (hasRoles) {\n      return element\n    }\n    if (typeof fallback === 'string') {\n      return <LoginAndReturn />\n    }\n    return fallback\n  }\n\n  return (\n    <BrowserRouter>\n      <Routes>\n        <Route path=\"/\" element={<Layout />}>\n          <Route path=\"\" element={<Navigate to=\"calendar\" replace />} />\n          <Route path=\"calendar\" element={ifHasRoles(\n            [UserRoles.EVENTS_READ, UserRoles.PING],\n            <CalendarPage />,\n            '/calendar'\n          )} />\n          <Route path=\"timers\" element={ifHasRoles(\n            [UserRoles.EVENTS_READ],\n            <TimersPage />,\n            '/timers'\n          )} />\n          <Route path=\"pings\" element={ifHasRoles(\n            [UserRoles.PING],\n            <PingsPage />,\n            '/pings'\n          )}>\n            <Route path=\"\" element={<PingsIndex />} />\n            <Route path=\"send\" element={<SendPingLayout />}>\n              <Route path=\"\" element={<NoPingTemplateSelected />} />\n              <Route path=\":templateId\" element={<SendPing />} />\n            </Route>\n            <Route path=\"sent\" element={<SentPings />} />\n            {ifHasRoles([UserRoles.PING_TEMPLATES_WRITE], (<>\n              <Route path=\"templates\" element={<ManagePingTemplates />} />\n              <Route path=\"view-access\" element={<ManagePingViewAccess />} />\n            </>))}\n          </Route>\n          <Route path=\"login\" element={<LoginPage />} />\n        </Route>\n      </Routes>\n    </BrowserRouter>\n  )\n}\n\nfunction Layout(): JSX.Element {\n  return (\n    <div className=\"app-wrapper\">\n      <header>\n        <AppNav pages={[\n          { title: 'Calendar', href: '/calendar' },\n          { title: 'Timers', href: '/timers' },\n          { title: 'Pings', href: '/pings' },\n        ]} />\n      </header>\n      <main className=\"main\">\n        <Outlet />\n      </main>\n      <footer>\n        <AppFooter />\n      </footer>\n    </div>\n  )\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Provider } from 'react-redux'\nimport { store } from './store'\nimport App from './app'\nimport './index.css'\nimport 'bootstrap-icons/font/bootstrap-icons.css'\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./api\"), exports);\n__exportStar(require(\"./neucore-groups\"), exports);\n__exportStar(require(\"./user-roles\"), exports);\n//# sourceMappingURL=index.js.map"],"sourceRoot":""}